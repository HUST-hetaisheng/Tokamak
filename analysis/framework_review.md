# “实时概率预测 + 时间点标签化”框架学术审查（聚变破裂预测）

## 0. 审查结论（先给结论）
**结论：可以作为博士课题主线，但必须从“工程可用”升级为“可证伪、可迁移、可部署”的科学问题。**

若仅停留在“某数据集上AUC高/提前量长”，学术增量有限；若系统解决以下三点，则具备博士主线价值：
1. **严格反泄漏的时序评估协议**（shot级、时间级双重隔离）；
2. **标签机制与物理先兆一致性的可解释建模**（不是仅靠末期临界段识别）；
3. **跨装置/跨放电阶段泛化与实时闭环验证**（offline→shadow→trigger三级验证）。

---

## 1. 对“实时概率预测 + 时间点标签化”框架的学术合理性审查

> 目标框架：在每个时刻输出 disruption probability，并依据时间点标签（如距破裂T ms内为正类）训练分类器/序列模型。

### 1.1 框架本身是合理的，但天然高风险点在“标签和切分”
该框架与DIII-D/JET/EAST大量工作一致：本质是**时序二分类/风险估计**。问题不在思想，而在实验协议。最常见失真来自：
- 用到“未来信息”导致虚高性能；
- 标签窗口定义不当，导致模型只学到“临终特征”；
- 训练/测试切分与标签策略冲突（同一shot相邻片段泄漏）。

### 1.2 数据泄漏审查清单（核心）

#### A. 时间泄漏（最严重）
- **错误模式**：以`t`时刻样本为输入，但特征计算窗口含`[t, t+Δ]`（平滑/频谱/归一化时常见）。
- **后果**：在线不可实现，离线指标虚高。
- **要求**：全部特征满足**causal**（仅使用`<=t`），并记录每个特征的最大回看窗口。

#### B. Shot泄漏
- **错误模式**：同一放电（shot）不同时刻样本被随机分到训练和测试。
- **后果**：模型记住shot背景，泛化被夸大。
- **要求**：按shot分组切分（Group split），禁止时刻级随机分层替代。

#### C. 设备/批次泄漏
- **错误模式**：按时间随机划分导致同一运行期/同墙材料状态同时进入训练测试。
- **后果**：工况共线性掩盖真实迁移难度。
- **要求**：按campaign/年份/装置状态做blocked split（例如JET C-wall vs ILW）。

#### D. 归一化泄漏
- **错误模式**：用全数据（含测试集）算均值方差、PCA、特征选择阈值。
- **要求**：所有预处理参数仅在训练集拟合，再应用到验证/测试。

### 1.3 标签偏差（label bias）审查

#### 典型标签法
- 距破裂`T_warn`内标正类，其他标负类；或多时间窗分层标签。

#### 主要偏差
1. **窗口任意性偏差**：`T_warn`取值主导任务难度，导致方法不可比。
2. **后验定义偏差**：以破裂时刻反推标签，易引入“接近终点必正”的伪规律。
3. **早期先兆稀释**：非破裂shot中长平台段过多，类别极不平衡，模型倾向输出低风险。
4. **软硬边界偏差**：真实风险连续变化，硬阈值标签制造大量边界噪声。

#### 建议
- 采用**多层标签**：`[0-30ms, 30-100ms, 100-300ms, >300ms]`或生存分析风险函数；
- 同时报告**event级**与**timepoint级**指标；
- 用**标签敏感性分析**（多`T_warn`）验证结论稳健性。

### 1.4 训练/测试划分与冲突处理是否科学

#### 常见冲突
- 你想“每个时间点都训练”，但评估需要“每个shot独立”；
- 你想“平衡正负样本”，却破坏真实时序先验与告警率。

#### 科学协议（建议作为论文主协议）
1. **三级切分**：
   - Train: 早期campaign
   - Val: 中期campaign
   - Test: 后期campaign（时间外推）
2. **Group约束**：同一shot仅在一个集合。
3. **时间因果约束**：特征仅用过去窗口。
4. **告警后处理固定化**：滞回、最小持续时长、refractory period在验证集定参，测试集冻结。
5. **冲突处理原则**：一切“可能提升测试性能但线上不可实现”的处理都判为不科学。

---

## 2. 与主流托卡马克破裂预测实践的对比（JET / DIII-D / EAST / ITER相关）

> 说明：以下基于可检索公开资料的共同结论与代表性结果，不同论文口径略有差异。

## 2.1 主流实践共性
- **实时性导向**：目标不是纯分类准确率，而是“足够提前 + 可接受误报/漏报”；
- **事件级评价**：success rate, false alarm rate, missed alarm rate, warning time并重；
- **部署约束显式化**：在PCS/RTDN中测试，关注推理时延和鲁棒性；
- **跨装置泛化是关键难题**：JET↔DIII-D、DIII-D→EAST/HL等迁移困难。

## 2.2 与本课题框架的一致性
1. 你提出的“**实时概率输出**”与DIII-D DPRF中的disruptivity概率思想一致；
2. “**时间点标签化**”与多数监督学习方法一致（固定预警窗）；
3. 若加入告警逻辑（阈值+滞回），可直接对接现有RT触发框架。

## 2.3 与主流前沿的差异（也是你可做贡献的空间）
1. **从二分类到风险轨迹**：主流正从单点判断转向连续风险估计/可解释特征贡献；
2. **跨机泛化**：仅单机高分已不够，需证明domain shift下性能稳定；
3. **可解释与可控**：ITER语境下强调可审计触发条件，不接受黑箱单阈值；
4. **评估协议标准化**：同一数据泄漏防线与指标口径，仍是社区痛点。

---

## 3. 风险清单（>=10）与缓解策略

| # | 风险 | 层面 | 影响 | 缓解策略 |
|---|---|---|---|---|
| 1 | 特征含未来信息（非因果窗口） | 数据/建模 | 离线高、在线崩 | 建立特征因果审计表；单元测试验证`max_timestamp<=t` |
| 2 | 同shot泄漏到训练与测试 | 数据/评估 | 泛化虚高 | GroupKFold按shot；测试集shot白名单冻结 |
| 3 | campaign混杂导致“同分布假象” | 数据/评估 | 时间外推失败 | blocked split（按campaign/墙状态/年份） |
| 4 | 标签窗单一导致结论依赖超参数 | 建模/评估 | 论文不稳健 | 多`T_warn`敏感性曲线+置信区间 |
| 5 | 严重类不平衡（时刻级） | 建模 | 模型偏保守漏报多 | focal loss/代价敏感学习；event-level采样 |
| 6 | 指标只报AUC，不报告警可用性 | 评估 | 工程不可用 | 同时报SR/FAR/MAR/平均提前量/95%分位提前量 |
| 7 | 阈值在测试集调优 | 评估 | 过拟合 | 阈值与后处理仅在验证集确定 |
| 8 | 预处理参数全局拟合（标准化泄漏） | 数据 | 性能偏乐观 | pipeline化，train fit / val-test transform |
| 9 | 实时延迟未计入总提前量 | 部署 | 实际触发过晚 | 端到端时延预算（采样+特征+推理+通信）并扣减有效提前量 |
| 10 | 传感器缺失/漂移无鲁棒设计 | 部署 | 在线不稳定 | 缺失掩码训练、冗余通道、漂移检测与重标定 |
| 11 | 模型只识别“末期崩溃”，早期无能 | 建模 | 缓解动作来不及 | 分层标签/生存模型；针对长提前量子任务训练 |
| 12 | 跨装置迁移失败 | 建模/部署 | 学术外推不足 | domain adaptation、装置条件编码、少样本微调协议 |
| 13 | 告警抖动频繁触发（alarm chattering） | 部署 | 控制系统负担 | 滞回+最小保持时间+refractory period |
| 14 | 可解释性不足难获控制接受 | 部署/学术 | 难进PCS策略链 | 输出特征贡献/不确定度；构建“可审计告警报告” |

---

## 4. 建议的博士课题主线重构（可直接写开题）

### 主问题
在严格无泄漏时序协议下，构建**可校准、可解释、可迁移**的实时破裂风险预测与触发体系。

### 三个子课题（建议）
1. **方法学子课题：反泄漏评估标准**
   - 贡献：提出并开源“shot-group + campaign-block + causal-feature”统一协议。
2. **模型子课题：概率轨迹与不确定度**
   - 贡献：从硬标签二分类提升到风险轨迹/生存视角，增强长提前量能力。
3. **系统子课题：在线闭环验证**
   - 贡献：shadow mode→limited trigger→full trigger，量化实际收益与副作用。

### 阶段里程碑
- M1（3-6个月）：完成数据与协议审计，复现实验基线；
- M2（6-12个月）：完成风险模型与标签敏感性研究，提交方法论文；
- M3（12-18个月）：完成跨campaign/跨装置验证；
- M4（18-24个月）：完成实时系统验证与部署论文。

---

## 5. 最终判断：是否可作为博士课题主线？

**可以，但要加“硬约束”：**
- 没有严格反泄漏协议：不建议作为主线；
- 仅单机离线AUC改进：不够博士深度；
- 若能同时完成“方法规范 + 可解释概率建模 + 在线验证”：**完全可作为高质量博士主线**。

---

## 6. 参考公开资料（可检索）
1. Kates-Harbeck J., Tang W., Svyatkovskiy A. (2019). *Predicting disruptive instabilities in controlled fusion plasmas through deep learning*. Nature 568:526–531. DOI: 10.1038/s41586-019-1116-4.（DIII-D/JET跨机泛化代表作）
   - 可检索页面：Harvard DASH镜像（含摘要）
2. Rea C. et al. (2019). *A real-time machine learning-based disruption predictor in DIII-D*. Nuclear Fusion 59 096016. DOI: 10.1088/1741-4326/ab28bf.（DPRF、实时概率输出）
3. Vega J. et al. (2014). *Results of the JET real-time disruption predictor in the ITER-like wall campaigns*. Fusion Engineering and Design 88(6–8):1228–1231. DOI: 10.1016/j.fusengdes.2013.12.020.（JET APODIS/ILW表现）
4. López A. et al. (2012, EFDA报告). *Implementation of the Disruption Predictor APODIS in JET’s Real-Time Network using the MARTe Framework*.（JET实时部署实践）
5. Dong Y. et al. (2021). *Disruption prediction on EAST tokamak using a deep learning algorithm*. Plasma Physics and Controlled Fusion. DOI: 10.1088/1361-6587/ac228b.（EAST深度学习实践）
6. de Vries P. et al.（ITER相关）*Requirements for Triggering the ITER Disruption Mitigation System*（公开报告/会议材料可检索，强调误报-漏报-提前量权衡）。

> 注：部分期刊页面有访问限制，但题名、DOI、摘要与会议公开材料可检索；正式论文写作时建议统一以DOI和可公开预印本/会议文档双重引用。