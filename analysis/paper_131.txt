分类号                                     学号   D202080576
学校代码 1 0 4 8 7                          密级




         博士学位论文
                  （学术型√        专业型□）



 基于托卡马克物理特征的机器学习跨
                 装置破裂预测研究

                 学位申请人：沈呈硕

                 学 科 专 业：电气工程

                 指 导 教 师：丁永华       教授
                           郑   玮   副研究员
                 答 辩 日 期：2024 年 08 月 16 日
            答辩委员会


     姓名    职称         单位

主席   盛正卯   教授        浙江大学

     丁锐    研究员   中国科学院等离子体物理研究所

     钱金平   研究员   中国科学院等离子体物理研究所
委员
     张明    教授       华中科技大学

     江中和   教授       华中科技大学
A Dissertation Submitted in Partial Fulfilment of The Requirements
             for The Degree of Doctor of Engineering




  Cross-Tokamak Disruption Prediction Using Machine
            Learning Based on Physics Features




          Ph.D. Candidate : SHEN Chengshuo
          Major             : Electrical Engineering
          Supervisor        : Prof. DING Yonghua
                             Assoc. Prof. ZHENG Wei




         Huazhong University of Science and Technology
                   Wuhan 430074, P. R. China
                          August, 2024
                     独创性声明


  本人声明所呈交的学位论文是我个人在导师指导下进行的研究工作及取得的研
究成果。尽我所知，除文中已经标明引用的内容外，本论文不包含任何其他个人或集
体已经发表或撰写过的研究成果。对本工作的研究做出贡献的个人和集体，均已在文
中以明确方式标明。本人完全意识到本声明的法律结果由本人承担。



                             学位论文作者签名：

                             日期：    年   月   日




                 学位论文版权使用授权书


  本学位论文作者完全了解学校有关保留、使用学位论文的规定，即：学校有权保
留并向国家有关部门或机构送交论文的复印件和电子版，允许论文被查阅和借阅。本
人授权华中科技大学可以将本学位论文的全部或部分内容编入有关数据库进行检索，
可以采用影印、缩印或扫描等复制手段保存和汇编本学位论文。
         保   密□，在     年解密后适用本授权书。
  本论文属于 不保密√。

  （请在以上方框内打“√”）



  学位论文作者签名：                  指导教师签名：

  日期：   年    月   日           日期：    年   月   日
     华 中 科 技 大 学 博 士 学 位 论 文


                       摘       要

  破裂是托卡马克装置中等离子体失去稳定性、瞬间释放大量能量的现象，会对托
卡马克装置造成巨大损坏，破裂预测是 ITER 及未来聚变堆进行破裂避免与缓解的前
提条件。而以 ITER 为代表的大型托卡马克聚变堆对破裂几乎是零容忍，现有主要依
赖纯机器学习的数据驱动破裂预测方法难以适用。针对破裂物理认识和未来聚变堆
产生的数据都有限的问题，本文提出了基于托卡马克物理特征的机器学习跨装置破
裂预测方案，以期建立高性能的破裂预测模型。主要从设计物理特征提取并建立 J-
TEXT 破裂预测模型，结合优化物理指导与领域自适应实现跨装置破裂预测以及破裂
预测模型可解释性三个方面开展研究。
  本论文设计了基于物理指导特征提取算法(Physics-Guided Feature Extraction,
PGFE)，提取了磁流体不稳定性、辐射、密度和等离子体控制有关的破裂特征。该算
法可以将诊断数据处理成具有破裂物理知识的特征作为机器学习破裂预测模型的输
入，为机器学习模型增加了物理指导，减小了机器学习算法学习破裂物理的难度，也
可减少因诊断导致的不同装置间的数据差异对模型性能的影响。由于 PGFE 作为特
征提取器对模型规模和数据需求较低，因此本文选择了同时兼具一定的可解释性与
精度的决策树类模型作为分类器，并建立了基于 PGFE 的 J-TEXT 破裂预测模型。该
模型实现了高性能的 J-TEXT 破裂预测效果，并可以减少对数据量的需求，仅需 10%
的训练数据，达到最好模型 95.2%的综合性能。
  基于上述 J-TEXT 高性能破裂预测模型，进一步基于优化物理指导与领域自适应
算法 CORrelation Alignment(CORAL)开展了跨装置破裂预测的研究。对领域自适应
算法做适应于破裂预测任务的改进后，在 PGFE 的基础上可以仅用 10 炮 EAST 破裂
炮与 100 炮 EAST 非破裂炮实现 J-TEXT 到 EAST 装置的跨装置破裂预测模型。相
比于目前研究中使用的混合数据的方式性能提升了 17%。通过优化 PGFE 与提高数
据标注质量，在领域自适应模型的基础上，仅需 10 炮 EAST 破裂炮，能提升 6.4%的
性能。通过优化物理指导中的估计标准化参数，还实现了 J-TEXT 到 EAST 装置零炮
迁移的跨装置破裂预测，无需 EAST 训练数据，达到基线模型综合性能的 91.6%。

                           I
     华 中 科 技 大 学 博 士 学 位 论 文

  基于 PGFE 提供的更强的可解释性特点，本文利用 SHapley Additive exPlanations
(SHAP)可解释性算法作为解释器，建立了 PGFE 所提取的物理特征对破裂贡献的关
系，面向 J-TEXT 单一装置与跨装置破裂预测模型均做了可解释性研究。通过各特征
对破裂的贡献度，证明了该模型基本学习到了通用的破裂物理知识，且具有发现物理
规律的能力。开发了该模型辅助 J-TEXT 物理实验进行实验现象分析的新应用，分析
得到了 RMP 影响辐射分布提升密度极限的新破裂物理规律。对跨装置破裂预测分别
做了数据分布、全局可解释性研究和针对单炮的破裂诱因分析的可解释性研究，证明
了跨装置模型可以同时学习 J-TEXT 与 EAST 共有破裂知识，验证了本文跨装置破裂
预测模型的可靠性。
  本文提出的基于托卡马克物理特征的机器学习跨装置破裂预测的方案可以有效
的实现具有物理约束的机器学习跨装置破裂预测模型，可以有效减少因装置与装置
间的数据差异导致的模型性能下降，并提升模型的可解释性。通过该方案，可以实现
用更少数据获得高性能的跨装置破裂预测模型，为跨装置破裂预测研究提供了新的
研究思路与实验验证。


关键词：托卡马克，破裂预测，J-TEXT，EAST，迁移学习




                           II
           华 中 科 技 大 学 博 士 学 位 论 文

                                         Abstract

     Tokamak is one of the most promising paths for controlled fusion power generation.
Disruption is a phenomenon in tokamak where the plasma loses confinement and releases
all its energy instantaneously, causing significant safety damage and economic loss to the
device. However, future large tokamaks, such as ITER, could not generate enough data for
training. Therefore, the key challenge is how to use limited understanding of disruption
physics and the limited data generated by future tokamaks to establish high-performance
disruption prediction models. This paper proposes a cross-tokamak disruption prediction
method based on physics features and machine learning. The research focuses on three main
aspects: extracting and designing physics features to establish the J-TEXT disruption
prediction model, combining human inputs and domain adaptation for cross-tokamak
disruption prediction, and conducting interpretability studies of the disruption prediction
model.
     In this paper, we design a Physics-Guided Feature Extraction (PGFE) algorithm to
extract MHD instabilities, radiation, density and plasma control related disruptive features.
This algorithm processes diagnostic data into features with disruption physics knowledge
as input for machine learning disruption prediction models. The algorithm adds physics
guidance to machine learning models, reducing the difficulty of learning disruption physics
for machine learning algorithms, and data differences between different tokamaks caused
by diagnostics. As this paper is to follow up the interpretability study, it needs the model to
be interpretable but needs to build the model still with sufficiently high performance. PGFE
as a feature extractor has a low demand on model size and data. In this paper, we choose the
decision tree-based algorithm that considerd interpretability and accuracy at the same time,
and built the J-TEXT disruption prediction model based on PGFE and decision tree-based
algorithm. The model achieves high-performance J-TEXT disruption prediction and can
reduce the demand for data, requiring only 10% of the training data to achieve 95.2% of the
comprehensive performance of the best model.
     This paper further conducts cross-tokamak disruption prediction research based on
human inputs and domain adaptation algorithms. Using J-TEXT as the source domain



                                              III
          华 中 科 技 大 学 博 士 学 位 论 文

tokamak and EAST as the target domain tokamak, after adapting the CORrelation
Alignment (CORAL) domain adaptation algorithm to the disruption prediction task, a cross-
tokamak disruption prediction model from J-TEXT to EAST can be achieved using only 10
disruptive and 100 non-disruptive EAST discharges. This improves the performance by
17% compared to the current mixing data method. Based on PGFE-upgraded (PGFE-U) and
Floating Labeling Strategy (FLS), only 10 EAST disruptive discharges are required to
improve performance by 6.4% on top of the domain adaptive model. Moreover, estimation
of the feature distribution (EFD) even relized zero-shot transfer model requires no EAST
training data, reaching 91.6% of the baseline model's combined performance.
     Benefiting from the stronger interpretability features provided by PGFE, this paper
conducts detailed interpretability studies on both single-tokamak model on J-TEXT and
cross-tokamak disruption prediction model. Through the contribution of each feature to the
disruption, it is demonstrated that the model has basically learnt the general disruption
physics and has the ability to discover the physics laws. A new application of the model to
assist the J-TEXT physics experiment for the analysis of experimental phenomena is also
developed, and a new disruption physics law that RMP affects the radiation distribution to
enhance the density limit is analysed. For cross- tokamak disruption prediction, data
distribution, global interpretability studies, and interpretability studies for single-shot
disruption causes are conducted. They validate the reliability of the cross-tokamak
disruption prediction model in this paper.
     The cross-tokamak disruption prediction method in this paper, can effectively achieve
cross-tokamak disruption prediction models with certain physics constraints, effectively
reduce the impact of the model due to the data differences between tokamaks, and enhance
model interpretability. Through this method, high-performance cross-tokamak disruption
prediction models can be achieved with less data, providing new research ideas and
experimental verification for cross-tokamak disruption prediction research.


Key words: tokamak; disruption prediction; J-TEXT; EAST; transfer learning




                                             IV
             华 中 科 技 大 学 博 士 学 位 论 文

                                                     目 录

摘 要............................................................................................................... I
ABSTRACT .................................................................................................. III
1     绪论 ............................................................................................................1
1.1       可控核聚变与托卡马克.......................................................................1
1.2       等离子体破裂的危害...........................................................................3
1.3       等离子体破裂的物理机制...................................................................4
1.4       破裂预测与跨装置破裂预测研究的必要性 ......................................7
1.5       本文的主要研究内容...........................................................................8
2     破裂预测研究综述 ................................................................................. 11
2.1       破裂预测的基本原理......................................................................... 11
2.2       面向单一装置破裂预测研究.............................................................13
2.3       跨装置破裂预测研究.........................................................................18
2.4       跨装置破裂预测面临的挑战.............................................................22
2.5       本文的主要思路.................................................................................26
3     基于物理特征的机器学习 J-TEXT 破裂预测研究 .............................30
3.1       J-TEXT 装置介绍...............................................................................30
3.2       通用破裂数据库子类的设计与实现 ................................................34
3.3       基于物理指导的特征提取算法.........................................................38
3.4       面向 J-TEXT 单一装置破裂预测模型的实现 .................................45
3.5       本章小结 .............................................................................................56
4     物理指导的领域自适应跨装置破裂预测研究 .....................................58
4.1       EAST 托卡马克装置及其与 J-TEXT 装置差异介绍 ......................58
4.2       物理指导的领域自适应的跨装置破裂预测结构与训练 ................60


                                                         V
             华 中 科 技 大 学 博 士 学 位 论 文

4.3       物理指导的领域自适应跨装置破裂预测模型的性能及对比 ........66
4.4       优化物理指导的领域自适应跨装置破裂预测 ................................74
4.5       优化物理指导实现零炮迁移跨装置破裂预测模型 ........................82
4.6       本章小结 .............................................................................................86
5     破裂预测的可解释性研究 .....................................................................88
5.1       J-TEXT 破裂预测模型的全局可解释性研究 ..................................88
5.2       J-TEXT 破裂预测模型在物理实验中的应用 ..................................93
5.3       跨装置破裂预测的可解释性研究...................................................103
5.4       本章小结 ........................................................................................... 112
6     总结与展望............................................................................................ 113
6.1       本工作主要内容及结论................................................................... 113
6.2       本工作的主要创新点....................................................................... 114
6.3       展望 ................................................................................................... 116
致 谢........................................................................................................... 117
参考文献....................................................................................................... 118
附录 1 答辩委员会决议 ...........................................................................126
附录 2 攻读博士学位期间取得的研究成果 ...........................................127
附录 3 公开发表的学术成果与博士学位论文的关系 ...........................129
附录 4 攻读学位期间参加的科研项目 ...................................................130
附录 5 中英文缩写对照表 .......................................................................131




                                                        VI
       华 中 科 技 大 学 博 士 学 位 论 文


                           1   绪论

   可控核聚变是一种清洁且易采集的能源，被视作人类能源问题的终极方案。托卡
马克磁约束核聚变装置利用磁场约束上亿度的高温等离子体，是聚变能商用的首选
技术路线。国际热核聚变实验堆（International Thermonuclear Experimental Reactor,
ITER）计划[1, 2]，由中国、欧盟、印度、日本、韩国、俄罗斯和美国七方共同合作，
以验证未来托卡马克聚变堆的工程与物理可行性。破裂是托卡马克装置中等离子体
失去约束、瞬间释放大量能量的现象，由于 ITER 等未来聚变堆储能极高，等离子体
破裂会导致装置严重损毁。等离子体破裂，也是 ITER 计划需要面对和解决的一项重
大问题之一[3, 4]，而破裂预测是 ITER 及未来聚变堆进行破裂避免与缓解的前提条件。

1.1 可控核聚变与托卡马克

   能源供应短缺与需求增长的矛盾日益突出。随着全球人口的不断增长和经济的
持续发展，对能源的需求急剧增加。化石燃料的大量燃烧导致大量温室气体排放，加
剧了全球气候变暖的趋势，对生态环境和人类健康构成了严重威胁。人类社会的发展
正在对能源提出更高的要求。人工智能（Artificial Intelligence, AI）近年来迎来了飞
速的发展，算力是 AI 发展的基石，而更多的算力需求也意味着更大的能源消耗。此
外，伴随着人类科技实力的不断发展，探索太空也成为了人类开拓旅途中的下一站，
如 SpaceX 这样的民用火箭公司也在飞速的发展。人类正在朝着智能化、数字化以及
探索星辰大海的旅途中前行，也在经历着科学与技术的百年未有之大变局。然而这些
人类的新兴需求都伴随着对能源更高的需求，传统能源的转换效率、可再生能力都难
以满足这些新兴需求。每次的工业革命在带来生产力的飞速提升时，往往也伴随着能
源革命。与传统的化石能源相比，核聚变能是一种清洁且易采集的能源。核聚变每公
斤燃料可以产生比核裂变（用于核电厂）多大约四倍的能量，比燃烧石油或煤炭多近
四百万倍的能量。核聚变的原材料氘仅海水中就含有 45 万亿吨，通过聚变反应产生
的能量足够人类使用上百亿年。从上世纪中叶开始，世界各国的科学家开始研究核聚
变能的可行性，经过不懈的努力与探索，设计制造了多种可能实现受控聚变的装置。

                               1
            华 中 科 技 大 学 博 士 学 位 论 文

托卡马克（Tokamak）从上世纪 50 年代开始经过全世界的共同研究，取得了显著进
展，可以获得更高的 nTτE，被认为是最有希望实现商用聚变能的装置[5-7]。




                               图 1-1   托卡马克装置线圈及磁场示意图*

     托卡马克最初由位于苏联莫斯科的库尔恰托夫研究所的阿齐莫维齐等人在 20 世
纪 50 年代发明。托卡马克的名字 Tokamak 来源于环形(toroidal)、真空室(kamera)、
磁(magnet)、线圈(kotushka)，这是托卡马克的原理与主要特征。托卡马克是一种利用
螺旋磁场来约束等离子体的环形装置，其主要由真空室和产生各种约束、控制磁场的
磁体线圈组成。托卡马克内部等离子体电流产生的极向磁场与纵场线圈产生的环向
磁场一起构成螺旋磁场结构，将等离子体约束在真空室中[8]，通过等离子体本身的欧
姆加热或外部辅助加热的手段，例如中性束注入(Neutral Beam Injection, NBI)或回旋
共振加热(Ion or Electron Cyclotron Resonance Heating, ICRH or ECRH)使燃料达到聚


*
https://www.euro-fusion.org/



                                            2
         华 中 科 技 大 学 博 士 学 位 论 文

变温度，其结构示意图如图 1-1 所示，蓝色线圈为纵场线圈，内外极向场线圈分别
起产生等离子体电流和控制等离子体位置的作用。由中国、欧盟、印度、日本、韩国、
俄罗斯和美国七方共同合作的具有深远影响的国际热核聚变实验堆 ITER 目前正在
法国建设中[2]，有希望产生 10 倍于输入功率的聚变功率，为未来聚变能商用提供论
据和实验平台。然而托卡马克依然有许多需要面对和解决重大挑战，等离子体破裂便
是其中之一。

1.2 等离子体破裂的危害

       在托卡马克实验装置运行过程中，等离子体破裂是不可避免的突发性危害事件
[9]
      。对于高参数装置如 ITER 以及未来聚变堆，等离子体破裂危害极大，可能导致装
置严重损毁，是必须解决的难题之一。在托卡马克等离子体放电过程中，若磁流体动
力学（magnetohydrodynamic, MHD）不稳定性等宏观不稳定性事件发展到无法控制的
阶段，就会引发等离子体约束性能下降、能量快速损失以及电流迅速熄灭的现象，这
被称为等离子体破裂。
       等离子体在破裂时，其储存的能量（热能和磁能）在极短的时间内通过晕电流、
热量和逃逸电子等形式沉积到装置第一壁材料和其他部件，ITER 等未来聚变堆中的
等离子体参数与储能极高，这些能量的沉积会对装置造成损伤。破裂对托卡马克装置
造成的主要三种危害便是热沉积、晕电流和逃逸电子。在等离子体破裂的热淬灭阶
段，部分等离子体热能会被释放，这些热能会通过对流或辐射等方式沉积到装置第一
壁表面或部件上。沉积的持续时间因装置的大小而不同，像 JET 这种大型托卡马克
中则可以达到几毫秒，在 ITER 及未来聚变堆中，若所有的等离子体热能都沉积到偏
滤器上，靶板稳态热负荷峰值将达 30 MW/m2，这将超过材料的承受极限[10, 11]。在高
𝛽破裂和燃烧等离子体 VDE 破裂中，热淬灭时的等离子体热能可能达到高性能状态
下的等离子体热能的 90%以上[12]。大多数破裂时热淬灭阶段释放的热能并不是高性
能状态下等离子体热能的全部，不过装置部件长时间的热侵蚀也会对其造成损伤。
       当到了电流淬灭阶段，垂直拉长形状的等离子体，由于等离子体电流的衰减和等
离子体的位移，会在等离子体的刮削层附近感应出较弱的螺旋电流（即晕电流）。晕


                        3
     华 中 科 技 大 学 博 士 学 位 论 文

电流在电流淬灭阶段初期可以起到补偿磁通量变化的作用。等离子体电流的衰减和
移动会在邻近的装置导体中感应出局部的涡旋电流，这些局部的涡流与装置极向场
和环向场的相互作用会对装置结构产生局部的电磁力。在刮削层未接触到装置部件
时，装置部件受到的电磁力主要来源于涡流；但当等离子体位移到一定位置，刮削层
与装置部件接触时，晕电流会与装置连成通路，会与环向场相互作用造成强大的电磁
力。而当刮削层接触到装置部件后，装置部件受到的电磁力的主要来源则从涡流转变
为晕电流，该电磁力远大于涡流带来的电磁力。电流淬灭阶段，感应出的电流引起的
电磁力将达∼ 108𝑁。目前已有研究表明，可以通过加快电流猝灭的方式来减小晕电
流带来的电磁应力[13-16]。较为常用的缓解方式是向等离子体注入大量杂质气体或弹
丸。通过增大等离子体刮削层电阻的方式，大幅度地减小晕电流。
  逃逸电流在高参数等离子体放电中（如 ITER 等离子体电流可高达 15 MA）对装
置可能造成的危害最大。在电流猝灭阶段的后期，电阻降低会导致电压上升。当环向
电场超过某个临界值时，环向电场对电子的加速力超过了电子的碰撞摩擦力，使得电
子被加速[17]。这一过程会导致速度较高的带电粒子碰撞频率较低，使得电子在环向
电场中更容易达到高速状态并进入逃逸区。高能电子在加速过程中，与其他热电子碰
撞，产生新的逃逸电子，从而引发逃逸电子的雪崩效应[18, 19]。这些高能逃逸电子能
够在材料中沉积大量能量，导致材料的融化和烧蚀。碳材料的沉积深度估计约为 2.5
毫米，钨材料的沉积深度估计约为 0.2 毫米。逃逸电子引发的逃逸放电有时可以维持
相当长的时间，其电流幅值甚至可以达到原等离子体电流的一半。为防止大量逃逸电
子的产生和逃逸电流的形成，通常采用充入工作气体的方法。因为逃逸的临界电场与
密度成正比，提高电子密度可以有效降低逃逸风险。同样，可以采用弹丸注入来提高
密度并产生 MHD 活动，从而破坏逃逸电子的雪崩过程。图 1-2 为 JET 装置上由于
破裂产生的逃逸电流造成的真空室壁损害[16]，相比于电磁力造成的损坏，未耗散的
逃逸电流对装置的危害更大。

1.3 等离子体破裂的物理机制

  等离子体破裂经历四个主要阶段：初始阶段、先兆阶段、热猝灭阶段和电流猝灭


                     4
     华 中 科 技 大 学 博 士 学 位 论 文

阶段[20]，这些阶段构成了破裂事件链。初始阶段，等离子体由于某些因素发展到一
些局部或微观不稳定状态；先兆阶段，等离子体内部的局部或微观不稳定性状态，逐
渐扩展至等离子体整体并诱发宏观 MHD 不稳定性事件，激发磁岛发生磁重联，破坏
原本稳定的层层嵌套的磁面结构；热猝灭阶段，磁岛逐渐增长后，芯部与边界磁岛重
合，建立径向快速的输运通道，等离子体的热能迅速释放，中心温度迅速下降；电流
猝灭阶段，等离子体的磁能迅速释放，等离子体电流急剧下降到零，直接终止放电。
然而，不同的初始阶段、先兆阶段和淬灭阶段的发展速率都存在差异，甚至会导致破
裂的突然发生，而无任何控制系统可观测的前兆。托卡马克等离子体发生破裂的原因
及物理机理也一直是学界研究的重点课题。




          图 1-2 JET 装置上逃逸电流造成的真空室壁损害[16]

  一般认为，等离子体破裂是 MHD 不稳定性事件演化的结果，但是出现了 MHD
不稳定性事件也并非一定会诱发破裂。虽然难以从物理机理上得知破裂发生的原因，
但依然可以通过统计的方式去探究哪些因素可能导致破裂。世界最大托卡马克欧洲
联合环 JET 研究团队对于 2007 年之前的破裂进行了统计研究与分析，对 2000 年到



                        5
       华 中 科 技 大 学 博 士 学 位 论 文

2010 年期间的破裂进行了细致的破裂诱因分析[21-23]。研究发现，导致破裂的原因十
分复杂，人为导致的技术问题可能引发物理问题；而各种物理问题也会相互作用，最
终导致破裂。JET 研究团队将破裂按照人为导致的破裂和物理导致的自然破裂分别
进行了分析，尝试去理清自然破裂的事件发生链。图 1-3 (a)显示了人为破裂的事件
链示意图；图 1-3 (b)则展示了自然破裂的事件链示意图。箭头的宽度表示事件发生
的频率。
   人为破裂主要由托卡马克实时控制等系统出现故障引起。如等离子体位形控制
失败，密度反馈失效，加热系统开关故障等。大多数人为破裂是由人为的垂直不稳定
性事件（vertical displacement event, VDE）或过量杂质气体注入引起的辐射崩塌所致。
人为破裂的事件链清晰简单，与破裂物理机制导致的自然破裂高度复杂形成鲜明对
比。自然破裂的物理机制复杂多样，事件链中的任何一个事件都可能成为破裂的起
点。事件的非线性特性及其相互作用大大增加了破裂物理研究的难度。自然破裂主要
由等离子体本身平衡扰动自发演化导致的全局 MHD 不稳定性发展到不可控引起。
如三大极限导致的破裂，磁岛锁模破裂等。图 1-3 (b)中可以发现物理因素导致的自
然破裂，几乎最终都指向了锁模，进而发生破裂。然而有些破裂原因发展速度极快，
锁模可能刚刚发生，或磁岛仍在减速阶段破裂便已经发生。
   三大极限破裂为通过国际众多托卡马克装置的实验数据，得到的三个与破裂有
关的定标关系，包括：1) 密度极限：要求 Greenwald 密度极限𝑛𝐺𝑊 (1020 m−3) =
𝐼(MA)/𝜋𝑎2 ( m2) ⩽ 1，接近或超过该极限会导致边缘辐射分布不对称，电流通道收缩
等现象，从而诱发 MHD 不稳定性导致破裂；2) 电流极限（低 q 极限）：要求等离子
体边界安全因子 q95 ⩾ 2，边界安全因子若小于 2，则会导致等离子体磁面中的 q = 2
面与装置壁过于接近，从而引发内扭曲模等 MHD 不稳定性，诱发破裂。在等离子体
半径与托卡马克装置半径，以及环向磁场一定的情况下，等离子体边界安全因子主要
由等离子体电流决定。因此该极限要求等离子体电流不能超过一定值；3) 比压极限：
要求归一化比压𝛽N = ⟨𝛽%⟩ /(𝐼(MA)/𝑎( m)𝐵(T)) ⩽ 3.5，若接近超过该极限会激发理想
MHD 不稳定性，从而诱发破裂。三大运行极限仅为破裂的经验规律，并不代表破裂
的物理机理，即等离子体放电达到或超过这些极限时更容易发生破裂，但并不是必然


                           6
      华 中 科 技 大 学 博 士 学 位 论 文

会发生。破裂在此极限到达之前，之后均有可能发生。例如，已经有许多研究发现芯
部的密度是可以超越密度极限的，目前的研究表明可能与边界密度、输运以及湍流相
关，间接引发 MHD 不稳定性。即使在三大安全运行极限范围内，等离子体放电仍可
能由于杂质、新经典撕裂模、以及加热中断等原因导致破裂。




                图 1-3 JET 装置破裂事件链示意图[23]


1.4 破裂预测与跨装置破裂预测研究的必要性

   等离子体破裂是目前托卡马克装置运行无法完全避免的一种现象，且瞬间释放
大量能量到装置上。对于 ITER 及未来大型托卡马克装置乃至聚变堆，其等离子体储
能巨大，对装置造成的损伤将更大，因此 ITER 必须保证破裂能被可靠缓解或是避免。
随着装置参数的提升，未来的高参数装置乃至聚变堆将难以承受破裂带来的损害。如
果将现有的中小型托卡马克比作电动三轮车，破裂则是电动三轮车的翻车，大型高参
数托卡马克如 ITER 发生破裂，则是高速行驶的卡车发生翻车，而未来聚变堆的破裂
则可以看作是高铁的脱轨。可靠有效的破裂预测系统，是破裂缓解的前提[20]。在 ITER
的设计中破裂预测系统是等离子体控制系统的一个重要子系统，它的目标是在破裂
发生前，触发破裂缓解系统（Disruption Mitigation System, DMS）或者在更早的时候
应用一些破裂避免的手段去避免等离子体发生破裂。破裂预测系统的准确性、误报
率、预警提前时间对于 ITER 及未来大型托卡马克装置破裂的缓解至关重要。下一代
托卡马克如 ITER 要求破裂发生的概率小于 1% [24]。
   理想的情况下，等离子体理论模型可以给出判断出现破裂征兆的解析算法。但是


                           7
      华 中 科 技 大 学 博 士 学 位 论 文

上述提到的等离子体破裂过程极其复杂，现有的理论模型、模拟手段，还远远无法达
到以上要求。目前已知的各种托卡马克运行的极限仅为定标关系，超过或低于该极限
均可能诱发或不诱发破裂，基本无法用于破裂预测[22]。大部分破裂前都会发生锁模，
因此检测锁模或设定锁模幅值可以预测出大部分破裂。但是这样预测的提前时间短、
且准确率低，难以满足 DMS 系统对于提前时间和准确率的要求。破裂的物理机制的
复杂性导致使用第一原理模型来预测等离子体不稳定性和破裂的困难[25]。
   因此，目前破裂预测研究的主要方法为数据驱动的破裂预测。数据驱动的破裂预
测，在单一装置上得益于各托卡马克装置多年的放电数据，结合机器学习与人工智能
算法，可以同时实现高准确率与低误报率和足够 DMS 系统响应的提前时间。即使数
据驱动的破裂预测缺乏可解释性，难以保证算法始终如一的稳定可靠，但由于出色的
预测性能，国际上主流的破裂预测方案为数据驱动的破裂预测。然而，未来托卡马克
的高性能运行使得未减轻的破裂成本相当高昂，因此难以获得足够多的数据来训练
这些模型。未来托卡马克与现有托卡马克如 ITER[26]、示范发电站项目 DEMO[27]和
SPARC[28]，在设备尺寸和运行模式之间存在很大差距，直接将现有托卡马克上训练
的预测器用于未来托卡马克的可靠性也较低。因此，破裂预测研究的重点也在逐渐从
提高破裂预测模型的准确性，转向提高面向未来聚变堆的跨装置预测能力。

1.5 本文的主要研究内容

   为了保护未来聚变堆安全稳定运行，需要跨装置破裂预测使用更少的目标装置
数据，获取更高的预测性能，同时需要保证模型有足够的可靠性。数据驱动的方法依
赖从大量数据中挖掘规律并且可解释性较差，难以满足该需求。然而，虽然破裂物理
机制复杂难以得到高效的破裂预测结果，但是物理驱动的破裂预测具有较强的可解
释性，且更易于跨装置破裂预测的实现。因此，本文将物理驱动与数据驱动相结合，
分三步开展了基于托卡马克物理特征的机器学习跨装置破裂预测研究。首先，基于现
有 不 稳定 性及 破裂 的物 理 知识 设计 了用 于托 卡 马克 破裂 预测 的特 征 提取 算 法
（Physics-Guided Feature Extraction, PGFE），将该特征与机器学习算法结合，实现了
面向 J-TEXT 单一装置的破裂预测模型作为跨装置破裂预测的源域模型。在实现上述


                             8
      华 中 科 技 大 学 博 士 学 位 论 文

基础后，以 J-TEXT 为源装置，EAST 为目标域装置，基于物理指导与领域自适应算
法，实现了仅使用少量或无需 EAST 装置数据的跨装置破裂预测模型。最后，基于上
述破裂预测模型使用了物理特征与结合机器学习可解释性算法，开展了模型的可解
释性研究，证明了本论文方法的可靠性，并探索出破裂预测模型的新应用泛式，发现
了 J-TEXT 上破裂物理新规律。本论文具体分为以下章节：
  第 1 章，简要的介绍了可控核聚变及等离子体破裂的基本概念，阐述了等离子
体破裂可能产生的危害与未来聚变堆对破裂预测及跨装置破裂预测的重要需求。
  第 2 章，首先简单阐述了破裂预测与跨装置破裂预测的基本原理与步骤，接着
对破裂预测的研究现状分面向单一装置破裂预测以及跨装置破裂预测做了系统性的
综述研究，并总结了跨装置破裂预测研究目前面临的困境，并给出了本工作的解决思
路。
  第 3 章，介绍本论文所使用的破裂预测数据库的框架设计与实现，后续的所有
工作均使用了该数据库框架对数据进行增删查改的处理。接着详细介绍了本论文开
发的用于破裂预测的物理指导特征提取算法，PGFE。基于该算法与机器学习算法，
实现了 J-TEXT 托卡马克高性能的破裂预测模型，并减少了对数据量的需求。
  第 4 章，介绍了基于物理指导与领域自适应算法的 J-TEXT 到 EAST 跨装置破裂
预测模型。首先将 PGFE 与领域自适应算法 CORrelation ALignment (CORAL)结合，
开展跨装置破裂预测的研究。针对破裂预测任务改进后的 CORAL 算法，可以用较少
的 EAST 数据实现较好的 EAST 跨装置破裂预测的性能。接着进一步优化物理指导，
通过优化 PGFE 与提高数据标注质量，降低了 EAST 装置数据的使用，并提升了跨
装置破裂预测模的性能。在此基础上，通过估计标准化参数大幅提高了零炮迁移至
EAST 的跨装置破裂预测性能。
  第 5 章，详细研究了破裂预测模型的可解释性。首先对 J-TEXT 破裂预测模型做
了全局与局部的可解释性研究。通过全局具有物理意义特征贡献度的分析，验证了模
型可以学习到破裂知识，并探索新物理规律的能力。通过局部贡献度，以及贡献度演
化分析，开发了破裂预测模型可解释性在物理实验中的应用，发现了 J-TEXT 新破裂
物理规律。通过对不同装置模型特征分布、贡献度对比、及敏感性分析，得到跨装置


                          9
     华 中 科 技 大 学 博 士 学 位 论 文

破裂预测可以学习到 J-TEXT 与 EAST 共有的破裂知识。
  第 6 章，对本文进行了总结并展望了未来需要进一步开展的深入可解释性与加
强破裂预测模型泛化性的研究。




                      10
    华 中 科 技 大 学 博 士 学 位 论 文

             2   破裂预测研究综述

  近年来国际破裂预测研究逐步受到关注，也涌现了许多跨装置破裂预测的研究。
目前已有中文硕博论文对面向单一装置的破裂预测研究做了系统性介绍[29]，本文将
对面向单一装置与跨装置破裂预测综合调研，做一个系统性的破裂预测研究介绍。本
章将先介绍破裂预测与跨装置破裂预测的基本原理，接着对近期破裂预测以及跨装
置破裂预测的研究发展做系统性介绍，总结出目前跨装置破裂预测所面临的挑战并
提出本文的研究思路。

2.1 破裂预测的基本原理

  在等离子体运行过程中，破裂预测起到了最终保护装置的作用。图 2-1 展示了
等离子体放电运行中，破裂避免与破裂缓解的示意图。等离子体在稳态运行过程中，
可能会出现一些不稳定性事件，初期这些事件并未到达需要破裂缓解的程度，可以使
用破裂避免的方式，对这些不稳定性加以控制，从而避免破裂的发生，并让等离子体
重新回归安全稳定运行的状态。但是如果这些不稳定性发展到难以避免的程度，就需
要破裂预测给 DMS 系统信号，触发破裂缓解，保护装置。本论文主要关注的是如何
给出可用于破裂缓解系统的破裂预测触发信号。
  破裂预测需要在破裂发生之前能识别出破裂前兆，所以破裂预测本质上是识别
破裂前兆，只要识别出前兆的提前时间长于破裂缓解系统的响应时间，即可实现破裂
预测。但是破裂预测也有可能将本来处于稳态运行的等离子体状态，错误的识别为破
裂前兆状态从而给出预警，过高的误报率会影响正常的放电运行。破裂预测的目标便
是尽可能去提高预测出破裂的准确率，并尽可能降低预测出破裂的误报率。
  识别破裂前兆的方式一般是设置信号或特征的阈值，早期主要对锁模信号设置
阈值[30, 31]作为判断破裂的标准。但是这种预测准确率不高，许多破裂类型锁模的发
展非常快，使用锁模信号很可能无法及时触发破裂缓解系统。因此，通过单一信号阈
值预测破裂的方式基本已经不再采用。目前国际上更多的是考虑多种信号或破裂相
关的物理特征出现的异常或不稳定状态来判断等离子体是否进入破裂前兆的状态。



                    11
       华 中 科 技 大 学 博 士 学 位 论 文

一般基于物理驱动的方式是尝试寻找经验规律得到的物理特征来判断等离子体是否
进入破裂前兆状态；而数据驱动的破裂预测，则是根据机器学习模型给出的“破裂概
率”来判断等离子体是否进入破裂前兆状态。破裂预测模型一般是给出每一个时刻，
或者每一段时间的破裂概率。在一炮中最先被判定为“破裂”的样本即为该炮的破裂
时刻，这个时间距离实际破裂的时间则被称为“预警时间”或“提前时间”。通常，
通过对测试集（即模型训练时未使用的数据）预测的性能来评判模型的预测性能。




               图 2-1 等离子体运行中，破裂避免及缓解示意图

   破裂预测是一种二元分类任务，该类任务常使用混淆矩阵进行模型性能评估。其
中对于实际为破裂炮，同时模型预测为了破裂炮的情况，记为 True positive (TP)；实
际为非破裂炮，同时预测为了非破裂炮的情况，记为 True negative (TN)；实际为破裂
炮，预测成了非破裂炮的情况，记为 False negative (FN)；实际为非破裂炮，预测成
了破裂炮的情况，记为 False positive (FP)。该 4 种量所组成的矩阵即为混淆矩阵。对
于破裂预测任务来说，仅是预测出破裂还远远不够，还需要预测时间足够满足 DMS
的响应时间。因此，根据不同装置所需的提前时间 τ，破裂预测任务一般认为提前时
间 ≥   τ 的预测才为 TP。其中对于破裂预测任务，最直观的两个性能指标分别为 True
positive rate (TPR)成功率与 False positive rate (FPR)误报率，具体计算方式如下：




                               12
          华 中 科 技 大 学 博 士 学 位 论 文

                                  TP
                        TPR =
                                TP + FN                       (2-1)
                                  FP
                        FPR =
                                FP + TN                       (2-2)
根据不同破裂预测模型，可以调整模型阈值或判定策略改变模型的 TPR 与 FPR 的组
合。将多种组合下，以 FPR 为横轴，TPR 为纵轴可作出 ROC 曲线(The receiver operating
characteristic curve)，该曲线与横轴的面积为 Area under the ROC curve (AUC)。该参
数是反应模型性能的重要参数，因为该参数代表了各种模型阈值下模型的平均水平。

2.2 面向单一装置破裂预测研究

       上一节提到最初破裂预测的研究中，由于发现大部分的破裂最终都会走向锁模
[22]
       ，因此选用锁模阈值作为破裂预测的指标。该方法的优点是其对等离子体运行参
数较不敏感，例如 H 模和 L 模、限制器和偏滤器位形其阈值基本相同[20]。而且由于
物理原理上较为透明，所以具有一定的外推至其他装置的能力。但是其缺点是预测性
能不高，尤其是其预警提前时间非常短，难以用于 ITER 等大装置破裂预测。而且
ITER 等大型装置由于高 q95，内感低，产生的 Br 小，其锁模信号接近于噪声水平，
因此仅仅用锁模信号来预测 ITER 破裂是不可行的[22]。得益于各大托卡马克装置多
年来积累的运行数据，数据驱动的破裂预测逐渐成为破裂预测研究的主流方案。物理
驱动的破裂预测则主要以找寻破裂有关的物理特征，而非单一的锁模信号进行研究。
接下来将分别介绍物理驱动破裂预测与数据驱动的破裂预测近年来的研究进展。

2.2.1 物理驱动

       在锁模阈值预测破裂预测的基础上，JET 团队近年来开发了多种物理驱动的特
征用于预测破裂。由于锁模往往发生于即将破裂之前，因此通过锁模预测破裂经常出
现提前时间较短的问题。锁模是由于宏观 MHD 不稳定性产生磁岛，磁岛减速不断长
大从而导致破裂，而等离子体参数剖面的变化往往早于宏观 MHD 不稳定性的出现，
因此 JET 团队开展了一系列通过等离子体参数剖面变化找出关键物理特征，从而预
测破裂的方案 [32-35] 。这些特征包括通过可见光相机识别 MARFE（Multifaceted



                                  13
         华 中 科 技 大 学 博 士 学 位 论 文

Asymmetric Radiation From the Edge）[32]；计算剖面的峰化因子[32]；通过双高斯函数
拟合温度剖面，识别温度剖面的异常[34]；以及对辐射测量阵列采用宏像素切割的方
式，并由局部功率平衡，找到一个最适合解释辐射异常演化的新边界，即辐射功率除
以等离子体内能[35]。剖面关键现象通过对这些剖面特征的识别，可以早于锁模发生
预测出破裂。
    物理驱动的破裂预测还可以致力于帮助放电操作人员识别破裂或不稳定性事件
链以避免破裂[23, 36-37]。哥伦比亚大学团队开发了一套“破裂事件特征化和预测(The
Disruption Event Characterization and Forecasting Code, DECAF)算法[38, 39]”，包含用于
托卡马克中不稳定性识别的基于第一性原理和物理驱动的模块。DECAF 是一种基于
物理的破裂预测算法及框架，极大地减少了对“训练数据”的需求，并具有极强的可
解释性。DECAF 希望不仅能预测破裂前的事件发生，还能增进对这一系列事件的理
解。DECAF 由不同的物理驱动算法的模块构成，每一个模块记为 EVENT。但凡是
满足以下 5 个条件的便可以被纳入 DECAF：1）对单一现象的预测；2）可以提供一
个连续变化的触发信号；3）可以提供缓解或避免的提前时间；4）可以应用于新装置；
5）可以被实时化。
    物理驱动的破裂具有可解释性强的特点、可信度高、鲁棒性好，在不同装置中有
一定的可迁移性，可以提供定性的分析与研究。但是，大部分物理驱动的破裂预测指
标，破裂预测性能仍旧欠佳，且依旧难以对所有类型的破裂准确预测。如剖面指标预
测破裂，即使可以得到针对于该类型破裂极高的准确率，但是在实际应用中，由于各
种扰动导致的剖面变化，可能不一定会引发宏观 MHD 不稳定性，从而导致该指标误
报警。DECAF 算法能预测的破裂类型就十分受限于所提供的 EVENT 模块的物理过
程是否包含足够多的破裂物理。

2.2.2 数据驱动

    而数据驱动的破裂预测则通过更好的性能，且能预测出不同种类的破裂从而得
到大部分破裂预测研究者的青睐，近年来开发的破裂预测模型大多基于数据驱动的
方法。目前，国际多个托卡马克实验装置上的等离子体破裂预测都开展了基于机器学
习的研究，例如 DIII-D [40-42]，JET [43-46]，Alcator C-Mod [41, 47]，JT-60U [48, 49]，ASDEX-

                                       14
          华 中 科 技 大 学 博 士 学 位 论 文

Upgrade [50, 51]，HL-2A [29, 52-55], EAST [56, 57], TEXT [58, 59]和 J-TEXT [52, 60-67]等。得益于
现有装置多年来运行积累的放电数据，机器学习模型可以使用大量的实验数据进行
训练。一般模型的性能评估通过将新的实验数据作为已训练完成的模型输入，进行离
线测试进行。当模型满足各个装置对于破裂预测要求后，可以将模型进行实时化，部
署在各装置上对等离子体放电进行实时预测。因此，如何得到高性能的破裂预测模型
十分重要。
       上世纪 90 年代初，德州大学奥斯汀分校的 TEXT 装置，也就是 J-TEXT 装置的
前身，开展了最早的破裂预警研究[58]。该破裂预警研究，使用的是多层感知器，也就
是全连接神经网络，对磁测量信号进行学习。该多层感知器使用的训练集为一次破裂
炮和一次非破裂炮，测试为另一炮，可提前 1 ms 预警。在此基础上，该模型还使用
软 x 射线信号作为模型的输入，提高了模型的性能，实现了提前 3 ms 的预警[59]。
       JET 装置作为目前世界上最大的托卡马克装置，开展了许多机器学习破裂预测
模型的研究，在等离子体破裂预测研究中做出了巨大贡献。上一节提到的物理驱动的
破裂预测中，也是 JET 团队率先使用锁模阈值作为破裂的预警信号。在数据驱动的
研究中，JET 研究团队先使用了人工神经网络进行破裂预测研究，可以实现提前约
100 ms 的破裂预测[45]。在此基础上，还基于人工神经网络实现了一个实时在线预警
的预测模型，并在测试中达到了 87.23%的成功率[43]。JET 研究团队还基于支持向量
机开发了一套称为先进破裂预测器（Advanced Predictor of DISruptions， APODIS）
[68]
       的破裂预警系统。目前，APODIS 是世界上最完善的实时等离子体破裂预警系统之
一。APODIS 使用 2000 年至 2007 年碳壁条件下的实验诊断数据进行训练。在测试
时，分别使用了不同壁条件下的实验数据，得到了成功率大于 92%，误报率约为 6.4%，
平均可以提前 180 ms 进行预警的模型。APODIS 系统实现了基于多线程应用程序实
时执行器（Multithreaded Application RealTimeexecutor， MARTe）框架的实时预警[69]。
该系统使用了 7 个实时诊断参数作为输入，是一个双层的支持向量机结构。第一层
由三个具有径向基函数核的支持向量机（Support vector machines, SVM）分类器组成，
分别对相邻的三个 32 ms 时间片段进行分类；第二层由是基于线性核的 SVM 分类
器，综合第一层的结果给出最终结果。经过碳壁条件下的训练和金属壁条件下的测


                                           15
        华 中 科 技 大 学 博 士 学 位 论 文

试，实时的 APODIS 系统的成功率约为 98.36%，误报率只有 0.92% [70]。图 2-2 展示
了实时的 APODIS 相比于锁模信号触发预警的性能提升。




              图 2-2 APODIS 相比于锁模信号触发预警的性能提升[70]

   在 DIII-D 托卡马克装置上，同样是利用人工神经网络，DIII-D 主要关注与高参
数的破裂，因此预测了高𝛽𝑁破裂边界。模型使用具有 NBI 加热的破裂炮进行训练，
用模型的输出𝛽𝑁的值和实际𝛽𝑁的值的比值作为探测𝛽极限的参数指标。该模型可以从
33 个磁测量信号中预测出𝛽𝑁的值[40]从而对高于一定阈值的𝛽𝑁作为破裂的预警。该在
离线测试中，该模型对测试的 28 炮破裂炮提前几十毫秒预警，实现了成功率约 90%；
但对非破裂炮，也有较高的约 20%的误报率。DIII-D 装置与 Alcator C-Mod 托卡马克
实验装置基于随机森林算法也开发了一套破裂预警模型，叫做随机森林破裂预测器
（Disruption Predictor using Random Forests, DPRF） [41]。DPRF 模型使用 9 道诊断信
号作为模型的输入，直接输出此时等离子体破裂的概率。DPRF 依靠随机森林计算快，
实时化简单的特点，实现了对等离子体实时放电进行预测[42]。DPRF 可以实现对所有
破裂 100%的预测成功率，但是在实时测试中伴随高成功率的同时也带来了较高的误
报率。Alcator C-Mod 托卡马克实验装置的 DPRF 进一步使用 10 个可实时获取的诊
断信号作为输入，对 DPRF 在经过适当的优化后，模型的性能得到提升[47]。随机森
林不同于人工神经网络和支持向量机，它可以对模型的输出做出解释，是一个可解释
性模型。当 DPRF 判断即将破裂时，可以给出各个输入信号此时所占的比重，对模型
结果进行解释。图 2-3 展示了 DPRF 破裂预测模型预测破裂的同时具有一定的可解
释性。

                                  16
     华 中 科 技 大 学 博 士 学 位 论 文




       图 2-3 DPRF 破裂预测模型预测破裂的同时具有一定的可解释性[42]

  ASDEX-Upgrade (AUG)托卡马克实验装置是德国第二大的托卡马克装置，同样
也开发了一套基于人工神经网络的实时等离子体破裂预警系统。该系统与其他装置
的破裂预警系统不同，它的训练目标为距离破裂还有多长时间，实时预测多长时间后
会发生破裂。在离线的测试实验中，该预警系统的成功率约为 85%，而在实时在线
测试实验中，成功率约为 79% [51]。此外，AUG 与 JET 团队还开发了自适应训练的人
工神经网络[50]。自适应训练的策略更加符合托卡马克放电运行的实际需求，其主要
思想是随着放电进行让模型一直学习，从而不断适应新的放电环境。当未预测出破裂
炮时，即漏报时，该模型根据已经积累的数据重新训练。用自适应训练的方法，可以
减小约 10%的未预警破裂炮和 2.6%的失败率，成功率可以达到 80%以上，提高了人
工神经网络模型的性能。
  HL-2A 托卡马克装置上开发了一种 1.5 维的深度神经网络的破裂预测器，在 HL-
2A 上实现了成功率 96.1%，预警时间 30 ms 以上的破裂预测效果[53]。该神经网络还
可以通过在网络中的特殊节点处，加入可解释算法，实现 HL-2A 破裂预测算法的可
解释性分析，可以实现 5 种破裂原因的识别[54]。同时该算法也实现了在 HL-2A 上的


                        17
      华 中 科 技 大 学 博 士 学 位 论 文

实时破裂预测[29]。
   EAST 托卡马克装置分别通过卷积神经网络(Convolutional Neural Networks, CNN)
以及长短期记忆网络(Long Short-Term Memory, LSTM)实现了 EAST 上基于深度学习
的破裂预测，并对 CNN 以及 LSTM 的破裂预测效果进行对比，发展了 CNN+LSTM
的混合神经网络破裂预测器[56, 57]。
                    混合神经网络的破裂预测模型的 AUC 值为 0.95，
可以准确对 90.9%的破裂炮进行预警，对非破裂炮只有 2.4%的误报率。
   J-TEXT 托卡马克自 2013 年开始研究破裂预测，先后使用神经网络实现了锁模
破裂与密度极限破裂的预测[62, 66-67]。基于上述工作，J-TEXT 于 2018 年开发了密度
极限破裂预测的混合神经网络，并成功实现了密度极限的破裂避免[61, 64]。J-TEXT 还
开发了异常检测的破裂预测，以克服未来聚变堆难以获得破裂数据的难题[63, 65]。图
2-4 为 J-TEXT 装置上实现密度极限破裂避免的破裂预测模型，通过预测出破裂，减
少注气从而避免了密度极限破裂的发生。




           图 2-4 J-TEXT 实现密度极限破裂避免的破裂预测模型[64]


2.3 跨装置破裂预测研究

   面向单一装置的破裂预测固然可以通过数据驱动的方式得到高性能的破裂预测
模型用于本装置的破裂预测，但是对于新装置，放电初期缺乏足够多的数据用于训练
破裂预测模型，并且未来高参数托卡马克装置乃至商用聚变堆难以承受哪怕一次高
参数破裂，因此基于现有装置的破裂知识实现跨装置破裂预测更具有实用性与前瞻
性。

                            18
       华 中 科 技 大 学 博 士 学 位 论 文

2.3.1 物理驱动

   物理驱动的破裂预测可解释性强、可信度高、鲁棒性好，在不同装置中有一定的
可迁移性。但是，大部分物理驱动的破裂预测指标，仍旧需要在新装置上通过一定量
的数据、统计分析去找到破裂阈值。
   DECAF 算法目前仅当有一定研究的物理驱动的破裂前兆特征的阈值时可以直
接通过定标关系得到，而不用使用数据统计再去确定阈值（例如已经确定的定标率，
Greenwald 密度极限，理想磁流体不稳定性中的 kink stability beta limit 等）。DECAF
团队通过将物理模型加入神经网络损失函数，并且基于一定物理指导的方式在美国
普林斯顿大学的 National Spherical Torus eXperiment (NSTX)球形托卡马克上实现了
理想 MHD 不稳定性的预测，并成功迁移到了英国 Mega Ampere Spherical Tokamak
(MAST)球形托卡马克上[71]。JET 与 AUG 团队还通过对极向磁场等等离子体参数归
一化的研究，开展了基于锁模阈值的跨装置破裂预测的研究[72-74]。
   但是物理驱动的破裂预测由于现有对破裂物理的理解有限，仍旧难以摆脱其在
面向单一托卡马克装置时的性能较差，且预测的破裂类型受到限制的问题。因此，在
跨装置破裂预测的研究中，国际上主要的跨装置破裂预测的路线仍旧是数据驱动的
跨装置破裂预测。

2.3.2 数据驱动

   数据驱动的也就是基于机器学习破裂预测方法，其优点是在有效训练之后，其准
确率很高，基本都能做到 90%以上，误报率小于 10%，预警时间长，性能基本满足
未来破裂预测的需求。但其缺点是这种方法一般需要大量的破裂实验数据进行训练，
而 ITER 及未来大型装置无法在不损坏装置的前提下提供足够数量、类型的破裂实验
数据；同时此类方法无法提取其预测物理机理，也无法外推到其他装置，甚至当运行
区间发生变化时，之前训练的预测模型性能会大幅下降[20, 23]。
   在跨装置破裂预测研究方面，数据驱动的破裂预测通过从零开始建立破裂预测
器的自适应学习是最早也是被认为是解决新部署托卡马克破裂预测挑战的方法之一，
并取得了令人鼓舞的结果[21, 75-76]。在最新的 AUG 装置迁移到 JET 装置的工作中[76]，



                             19
       华 中 科 技 大 学 博 士 学 位 论 文

可以从零开始逐步实现 JET 装置成功率 98%，误报率 1.9%的针对破裂缓解的预测性
能，同时实现成功率 94.2%，误报率 7.7%的针对破裂预防的预测性能。
   2019 年普林斯顿国家实验室在 JET 装置与 DIII-D 装置上开发了一种基于混合深
度神经网络的破裂预测器(Fusion Recurrent Neural Network, FRNN) [77]，实现了在 DIII-
D 装置上训练，并仅使用极少量数据在 JET 实现了 AUC 为 0.911 的破裂预测性能。
图 2-5 是该工作的模型架构，顶部图像显示了 JET 托卡马克的内部视图，左侧为非
破裂等离子体，右侧为破裂等离子体。诊断装置(a)提供感应数据流(b)，每 1 毫秒将
其馈送到基于循环神经网络(Recurrent Neural Network, RNN)的深度学习算法(c)，从
而在每个时间步长(d)产生相应的“破裂概率”输出。如果输出越过预设的阈值（虚
线水平线），则会发出破裂预警（红色星号）。该预警触发减缓行动，例如将气体注入
(e)到托卡马克，以减少即将发生的破裂的有害影响。(f) FRNN 的详细示意图。表 2-1
展示了该工作的总体结果，其中 JET (CW)代表 JET 当时的壁条件为碳壁，JET (ILW)
代表 JET 当时的壁条件为 ITER-like Wall 壁条件；δ 代表少量数据，该工作中为 5 炮
破裂炮与 16 炮非破裂炮；FRNN 0D 代表仅使用 0D 信号作为输入的 FRNN 模型；
FRNN 1D 代表了使用剖面信号作为输入的 FRNN 模型。该工作中发现单一装置 DIII-
D 上 FRNN 效果甚至不如传统模型，但是当碳壁的 JET 训练，ITER-like Wall 壁条件
测试时，传统模型性能便远不如泛化性能更好的 FRNN 了。直接跨装置的测试中，
由于 DIII-D 与 JET 装置之间的差距比 JET 装置不同壁条件的差距更大，因此性能也
较差。但是，当在训练集中加入少量 JET 数据时，使用 DIII-D 装置大量数据与少量
JET 装置数据训练的 FRNN 1D 在 JET 上测试达到了 AUC=0.911 的模型性能。
   麻省理工学院的朱劲翔博士也在 DIII-D，Alcator C-Mod 与 EAST 三台装置上开
展了跨装置破裂预测的研究[78, 79]。该工作的模型混合深度学习结构，并分别在 C-Mod,
DIII-D 以及 EAST 单一装置上实现了 AUC 为 0.801，0.947 以及 0.973 的性能，实现
了单一装置上最好的性能。在跨装置的研究中，使用 20 炮 EAST 破裂炮以及上千炮
EAST 非破裂炮与上千炮 DIII-D 和 C-Mod 的数据，实现了 AUC = 0.959 的跨装置破
裂预测性能。他还创新性的提出了跨区间自适应的破裂预测策略[79]。通过大量未来
装置低参数数据以及现有装置高参数数据预测未来装置高参数数据。


                                20
     华 中 科 技 大 学 博 士 学 位 论 文

           表 2-1 FRNN 模型在各种情况下的模型性能以及所用数据


                    单一装置                 直接跨装置             “一瞥”跨装置

   训练集          DIII-D   JET(CW) JET(CW)         DIII-D     DIII-D + δ

   测试集          DIII-D   JET(ILW)      DIII-D   JET(ILW)   JET(ILW) -δ

 最优传统模型         0.937     0.893        0.636     0.616        0.851
   (AUC)

FRNN 0D (AUC)   0.890     0.952        0.761     0.817        0.879

FRNN 1D (AUC)   0.922       -            -       0.836        0.911




                    图 2-5 FRNN 模型网络结构[77]




                                  21
         华 中 科 技 大 学 博 士 学 位 论 文

   中国科学院等离子体物理研究所团队在 EAST 托卡马克装置上开展了跨运行区
间的破裂预测研究[80]。由于 EAST 装置的壁条件变化较大，导致原本在 EAST 装置
上的单一装置破裂预测模型性能下降（AUC = 0.97 ~ AUC = 0.79）。通过卷积自注意
力算法与 MMD 领域自适应算法，可以将 AUC 从 0.79 提升至 0.93。虽然该工作不
属于跨装置破裂预测的工作，但是其使用的方法可以借鉴至跨装置破裂预测的工作
中。
   J-TEXT 团队还开展了基于深度学习冻结与微调技术的 J-TEXT 到 EAST 的跨装
置破裂预测研究[81]。利用专用设计的深度特征提取器从 J-TEXT 数据中提取破裂特
征，再冻结该特征提取器，使用 EAST 数据仅对下游全连接分类器做微调，实现了跨
装置破裂预测。

2.4 跨装置破裂预测面临的挑战

   面向单一装置的破裂预测算法在近年来得到了飞速的发展，国际各大托卡马克
装置上均利用多年放电积累的数据实现了性能较好的数据驱动的破裂预测器。表 2-2
展示了当前国际各大托卡马克装置单一装置破裂预测的最佳模型及性能，可以看到
单一装置破裂预测的研究非常充分，且性能都基本可以达到 AUC 为 0.95 左右。而跨
装置破裂预测的研究中，跨装置模型的性能均有所降低。
   跨装置破裂预测是一个典型的迁移学习的问题[82]。迁移学习可以将数据集分为
源域与目标域，其中源域代表数据量大且数据质量高的数据集，一般用来训练源域模
型，目标域则是我们希望模型使用的数据集。假设 h 在目标域上的误差可以通过公
式 1-1 表示。其中 εt (h)和 εs (h)分别表示假设 h 在目标域和源域上的误差，dHΔH (Ds,
Dt) 是源域 Ds 与目标域 Dt 之间差异的度量，通常使用适合假设空间 H 的发散度量或
距离来计算，EDs 和 EDt 分别是源域分布和目标域分布的期望值，ld (fs, ft)是一个损失
函数，用于衡量源域和目标域的两个假设（或函数）fs 和 ft 之间的差异[83]。

   t (h)   s (h) + d H H ( Ds , Dt ) + min{ED [ld ( f s , ft )], ED [ld ( f s , f t )]}
                                                      s                   t
                                                                                              (2-1)

等式本身是目标域中假设误差的上限。它指出，该误差以三个项的总和为界：
            1) 源域中假设的误差。


                                                 22
        华 中 科 技 大 学 博 士 学 位 论 文

          2) 代表源域和目标域之间分歧的项。
          3) 两个期望值的最小值：源域中源假设与理想假设之间的期望损失，以
           及目标领域中目标假设与理想假设之间的期望损失。
上述三点便是在目标域上得到性能较好的迁移学习模型的三个可优化方向。在跨装
置破裂预测的研究中，则需要在以下三点上深入研究以实现更好的跨装置破裂预测
性能：
          1) 源托卡马克单一装置破裂预测模型性能足够好。
          2) 源托卡马克与目标托卡马克数据差异足够小。
          3) 源托卡马克与目标托卡马克所学习的任务期望足够小。
  对于大部分破裂预测的工作来说，第一点已经可以做到足够好了，但是第二点与
第三点仍然难以解决，其中对模型以及数据都提出了较高的要求。对模型来说，需要
理解模型是否学习到了真正的破裂相关知识，而非装置特有的放电知识。这样可以使
得源托卡马克与目标托卡马克所学习的均为等离子体破裂知识，使得任务期望足够
小。对数据来说，由于托卡马克装置建设，设计参数以及诊断之间的巨大差异，源托
卡马克与目标托卡马克数据差异很难达到很小的目标。上述研究现状中也仅仅是较
为相似的装置间跨装置破裂预测效果较好。如何利用对破裂物理有限的认识和未来
聚变堆产生的有限的数据，建立高性能的破裂预测模型，是托卡马克装置成为聚变堆
必须解决的关键难题。

            表 2-2 各托卡马克装置单一装置破裂预测性能及模型


  装置         最佳 AUC       最佳模型            其他模型

 EAST         0.973          HDL       LightGBM, MSHDP

 HL-2A        0.979    1.5D-CNN+LSTM      LightGBM

 C-MOD        0.801          HDL            DPRF

 DIII-D       0.945          HDL            DPRF

  JET         0.952          FRNN          AOPDIS


                        23
          华 中 科 技 大 学 博 士 学 位 论 文

                   表 2-3 跨装置破裂预测性能及模型


  测试      单装置最佳    跨装置最佳      最佳
                                            训练数据集
  装置       AUC       AUC      模型

                                    少量 EAST 破裂+大量 EAST 非破
 EAST      0.973     0.959    HDL
                                     裂+大量 DIII-D 与 C-Mod 数据

 HL-2A     0.979       /        /               /

                                    少量 C-Mod 破裂+大量 C-Mod 非
 C-MOD     0.801     0.728    HDL
                                     破裂+大量 EAST 与 DIII-D 数据

                                    少量 DIII-D 破裂+大量 DIII-D 非
 DIII-D    0.945     0.873    HDL
                                     破裂+大量 EAST 与 C-Mod 数据

  JET      0.952     0.911   FRNN    7 炮 JET 数据+大量 DIII-D 数据



2.4.1 现有模型较少考虑托卡马克物理特征

   由上面的研究综述可以看到，目前跨装置破裂预测研究的重心依然是在构建深
度神经网络的阶段。研究者们希望通过现有的托卡马克运行数据，直接或混合新装置
数据，通过纯数据驱动的方式，训练出能用于目标域装置的破裂预测模型。深度学习
的优势是可以使用大量数据在限制更小的参数域上，搜索出最好的参数模型，模型的
性能往往与数据量和模型的参数量呈直接的正相关。但是破裂预测研究不同于机器
视觉（Computer Vision，CV）以及自然语言处理（Natural Language Processing，NLP）
的研究。目前国际上虽有众多托卡马克装置，但一个装置的放电并非所有炮都是有效
炮，也并非所有诊断都一直处于可用且数据可以获取状态。托卡马克装置间的共有数
据库也尚未完全建立。破裂炮作为放电中并非常见的运行状态，数据会更少。破裂预
测研究总体可用的高质量数据相比于 CV、NLP 甚至医学研究等领域是十分稀少的。
CV 以及 NLP 在 transformer 结构[84]问世后，一举迈入了“大模型”时代，通过大量
数据和大量计算资源，可以训练出端到端无论是识别、预测、还是生成任务的性能高，


                              24
      华 中 科 技 大 学 博 士 学 位 论 文

且泛化性好的模型[85-92]。与 CV 和 NLP 有着数 10 年的研究积累，数据规模、数据质
量、公开数据集的研究进展密切相关。因此，破裂预测的研究还未进入到通过大量数
据纯数据驱动以实现通用的、能学习到等离子体及破裂知识的阶段。
  CV 和 NLP 在模型设计以及算法开发中，会引入许多人类知识。例如 CNN [93]的
设计，就基于图像的局部感受野，假设图像中的局部像素具有强烈的相关性，意味着
相邻像素之间的关系更密切。卷积操作通过在局部区域内提取特征，利用了这一假
设；共享权重，假设图像的某些特征在整个图像中都可能出现。因此，使用相同的卷
积核即共享权重，在图像的不同部分进行卷积操作，有助于减少参数数量，提高模型
的泛化能力以及空间不变性，假设特征的位置对识别结果的影响较小。即，无论特征
出现在图像的哪个位置，卷积神经网络都能识别出来。这三种图像相关的人类知识是
设计出 CNN 的关键。
  跨装置破裂预测属于 AI 面向科学（AI for Science）的研究领域，该领域普遍难
以拥有 CV 以及 NLP 如此海量的数据基础。并且相较于 CV 与 NLP，AI for Science
领域解决的多为物理问题，其中包含许多物理过程。图像与文字中的人类先验知识，
对应于科学和物理问题中的物理知识。因此在数据量不足以支撑大模型训练，且跨装
置破裂预测本质上是将物理问题作为研究对象的条件下，在跨装置破裂预测的研究
中引入物理驱动，将对模型的性能和泛化性提供重要的作用。国际目前的主流研究均
为端对端的深度学习模型，没有将等离子体物理及磁约束聚变本身的领域知识用于
跨装置破裂预测中。虽然物理驱动的破裂预测存在模型预测的性能较差等的问题，但
是物理驱动的破裂预测并不依赖于海量的数据训练即可找到破裂通用规律，并且具
有较强的可迁移性。

2.4.2 混合数据训练难以消除装置间数据差异对模型的影响

  表 2-3 跨装置破裂预测性能及模型中可以看到，即使是类似的模型，在不同装
置间进行跨装置破裂预测时，跨装置破裂预测的效果也不尽相同，这一方面是由于不
同装置的破裂数据分布不同，另一方面也由于不同装置间的区间不同。例如 DIII-D
装置，JET 装置与 EAST 装置均为 D 型极向截面的托卡马克，且 DIII-D 装置与 EAST
装置的控制系统更加接近，因此这三个装置间的跨装置破裂预测难度也较低，效果也

                         25
     华 中 科 技 大 学 博 士 学 位 论 文

较好。而 C-Mod 装置为强磁场托卡马克装置，与 DIII-D 和 EAST 装置数据差距较
大，因此跨装置破裂预测性能也较差。而未来托卡马克装置如 ITER、DEMO、SPARC
等，即使与目前世界上最大的托卡马克装置 JET 相比，差距也非常大，因此单纯依
靠将数据混合构建深度神经网络实现跨装置破裂预测的方式存在一定的局限性，在
设计破裂预测模型时需要考虑如何通过物理和数据的方式减少装置之间的数据差异
对模型的影响。

2.4.3 现有模型可解释性欠佳

  大多数数据驱动模型不一定能反映出等离子体运行及破裂现象背后的动态，其
物理准确性和结果的可解释性需要深入研究。近年来，可解释的破裂预测研究已经取
得了初步进展。在数据驱动方法研究中，通过应用符号回归方法实现的可解释性模型
已经在 JET 上使用支持向量机（SVM）实现[94-96]。在 HL-2A 上发展了一种基于反事
实的可解释方法来解释 1.5D 卷积神经网络（CNN）模型[54]。类激活映射方法也被用
来解释深度学习模型的预测[97]。在 DIII-D 上引入了基于危险事件的事件预测方法[98]。
基于峰化因子的破裂前兆的物理指标在 JET 上得到了发展和应用[33, 99-100]。它们也被
应用于解释 DIII-D 和 JET 上的破裂预测模型[101]。然而，这些研究还不能说明人工智
能模型学习到了独立于装置之外的破裂知识。上述工作大多使用本装置的原始信号
或针对本装置的处理信号，但是难以扩展至更多装置。仅 DIII-D 与 JET 团队提取了
较为通用的信号，但可解释性的研究仅局限于某一两炮，难以获得全局可解释性的结
果与分析。因此还需要进一步开展破裂预测的可解释性工作。

2.5 本文的主要思路

  本文通过在机器学习破裂预测算法中引入物理偏置来解决跨装置破裂预测的难
题。针对托卡马克中等离子体已有的破裂物理知识，可以对诊断信号做特征提取，减
少对数据需求的压力，同时增加模型学习托卡马克物理的能力。该特征需要能提升源
装置性能、减少装置间诊断测量数据差异对模型的影响、提高模型的可解释性。因此
本文的主要思路便是开展基于托卡马克物理特征的机器学习跨装置破裂预测的研究。



                       26
          华 中 科 技 大 学 博 士 学 位 论 文

2.5.1 在机器学习中加入托卡马克物理知识指导模型学习破裂规律

        虽然破裂预测问题尚没有明确的物理解析模型，破裂的物理机理仍处在研究中。
但是多年来托卡马克等离子体在破裂研究中依然有许多进展，本工作希望将已有的
破裂物理知识与人工智能机器学习算法相结合，基于托卡马克物理特征的机器学习
跨装置破裂预测的研究。希望开发一套托卡马克通用的，能包含破裂物理知识的破裂
特征提取算法，并辅以一些专家知识作为归纳偏置。特征工程是传统机器学习领域将
领域知识用于机器学习，以减少数据需求，提升模型性能的有效方式。本论文希望通
过将专家对于破裂的理解在使用人工智能算法前先进行特定的特征提取，以减小人
工智能算法学习破裂知识的难度，并提高可解释性。同时该算法还应当可以一定程度
上减小装置间数据差异对模型的影响。深度学习强大的特征提取能力使其通常在使
用足够多的原始信号时优于传统的机器学习。然而，当没有足够的数据时，可以向网
络引入归纳偏差，以更好地将已知的破裂知识嵌入模型中。归纳偏差将限制机器学习
算法的搜索域，因此在没有足够数据时可以获得更好的结果。利用已知的破裂知识进
行特征工程以减少特征空间维度限制了训练算法的搜索域，因此可以被视为添加归
纳偏置。在少量数据环境中，将领域知识添加到机器学习中以获得良好的性能被认为
是必要的[102]，并且是有意义的物理解释的基础。本文希望这一套特征提取算法可以
将原始诊断信号变成与诊断无关且具有物理信息的特征。将不同托卡马克的原始诊
断信号处理成统一的格式，从某种程度上也对齐了托卡马克之间的某些特征信息。并
且特征工程算法不依赖于训练特征提取器，在对目标域装置进行特征提取时，不再需
要目标域装置数据来训练特征。

2.5.2 将物理指导与领域自适应算法应用于跨装置破裂预测

        目前跨装置破裂预测的研究方法中，主要通过混合数据来训练模型以预测目标
域装置的破裂。然而，数据混合只是迁移学习中的一种基本方法。迁移学习中存在先
进的方法，可促进跨装置破裂预测的性能提升。领域自适应（Domain Adaptation，DA）
[103]
        适用于解决源域和目标域具有相同特征和类别但特征分布不同的问题。DA 已广
泛应用于机器学习研究的许多领域，如计算机视觉[104]、自然语言处理[105]和脑机接口



                        27
             华 中 科 技 大 学 博 士 学 位 论 文

[106]
        。然而，在磁约束聚变领域，特别是在破裂预测方面，则少有工作对其提及。利
用称为最大均值距离（Maximum Mean Discrepancy， MMD）的 DA 算法在 EAST 上
的破裂预测大大提高了模型在不同壁条件下的性能[80]。跨装置破裂预测也是 DA 的
典型应用场景，假设破裂的机制在所有托卡马克中相同。DA 算法可以帮助探索一种
新的面向未来托卡马克的跨装置破裂预测方法。当托卡马克之间存在显著的大小、操
作模式甚至配置上的差异时，将现有的托卡马克破裂预测器转移到未来的托卡马克
时会遇到问题。尽管我们希望能开发一套特征提取算法用于减少托卡马克之间的某
些数据分布差异，但托卡马克之间的差异可能导致不同的决策边界。因此，即使在对
跨托卡马克破裂预测应用该特征提取算法时，仍然有必要利用领域自适应算法增强
跨托卡马克预测的有效性。然而，领域自适应算法可以处理源域数据与目标域数据分
布差异的问题，但是无法处理源域数据与目标域数据是否表达了相同或类似物理量
的问题。这需要聚变等离子体领域的物理指导用于数据的处理与数据质量的提高。

2.5.3 开发可解释性更强的模型并深入研究模型的可解释性

        可解释的破裂预测研究处于初级阶段。相比之下，解释性研究在机器学习研究中
取得了更为先进的进展。原型部件网络（ProtoPNet）通过找到原型部件来解剖图像，
构建了一个深度可解释的网络架构[107]。指导解释性模型设计的视角是，我们应该停
止在事后“解释”黑盒模型所做的决定，而是构建具有建设性解释性的模型[108]。这种
观点也可能适用于破裂预测，并激发我们设计一个本质上可解释的破裂预测器。在数
学中，机器学习引导的直觉帮助研究人员通过归因技术证明定理[109]。SHAP 可解释
性算法（SHapley Additive exPlanations, SHAP）是一种统一的基于归因的可解释方法
[110-112]
            ，已成功应用于解释手术期间低氧血症的预测[113]。机器学习研究中的视角和技
术可以给予我们更多对可解释的破裂预测研究的启示。本文，我们希望设计一个目标
是准确性，跨装置能力和可解释性兼具的破裂预测模型。在我们以前的工作中，SHAP
被应用于基于 LightGBM 的 J-TEXT 和 HL-2A 的破裂预测器[52, 60]。可解释性研究提
供了一种选择诊断和放电数据以开发跨装置预测模型的策略。然而，由于输入信号、
原始诊断信号的限制，模型的可解释性尚不够深入。来自 DIII-D 和 JET 团队的工作
发现，基于物理的破裂标记在数据驱动算法中是实现跨不同托卡马克预测和解释破

                             28
    华 中 科 技 大 学 博 士 学 位 论 文

裂情景的一个有前景的途径。可解释的破裂预测器也可以基于物理的破裂指标进行
设计。结合上述提到的，本文将开发的破裂特征提取算法与 SHAP，希望实现更深入
的破裂预测的可解释性研究。




                   29
           华 中 科 技 大 学 博 士 学 位 论 文

       3    基于物理特征的机器学习 J-TEXT 破裂预测研究

    跨装置破裂预测的基础是获得一个性能好，且具有迁移能力的源装置模型。本章
介绍了基于物理特征的机器学习 J-TEXT 破裂预测模型用于本论文破裂预测模型的
基本架构开发并作为跨装置破裂预测模型的源装置模型。本章首先介绍了 J-TEXT 装
置以及对破裂数据库框架(J-TEXT Disruption DataBase, JDDB)两个与跨装置破裂预测
有关子类的重写与升级，为后续跨装置破裂预测研究提供基础；之后根据可能导致的
破 裂 物 理 机制 ， 发 展了 基 于 物 理指 导 的 特征 提 取 算 法（ Physics-Guided Feature
Extraction, PGFE)；基于该算法训练了 J-TEXT 机器学习破裂预测模型，并对其做性
能评估与分析。

3.1 J-TEXT 装置介绍

    J-TEXT (Joint Texas Experimental Tokamak) 托卡马克是由 美国德州大学的原
TEXT-U(Texas Experimental Tokamak-Upgrade) 托卡马克装置改装而成，于 2006 年完
成主机重装、改造工作，并于 2007 年获得第一等离子体，成为国内高校唯一的中型
托卡马克装置，装置外观如图 3-1 所示，其大半径 R = 1.05 m，小半径 a = 0.25 m。
J-TEXT 上安装了完整的诊断系统，拥有超过 300 个不同诊断的通道，包括完备的
Mirnov 阵列、SXR 阵列、AXUV 阵列、三波远红外偏振干涉仪等。J-TEXT 托卡马
克主要运行在限制器位型下，等离子体截面为圆形截面，壁条件以碳壁为主。典型放
电参数为 IP 约 120 ~2 00 kA、Bt 约 1.4~ 2 T、脉冲长度约为 800 ms、等离子体密度 ne
约为(1 ~ 7) × 1019       m-3，以及大约 1 keV 的电子温度 Te。J-TEXT 托卡马克运行以
来，产生了大量破裂炮的样本，破裂类型以锁模破裂以及密度极限破裂为主。J-TEXT
上有众多用于测量与破裂及等离子体不稳定性相关的诊断，本节主要介绍 J-TEXT 磁
诊断系统 [114]、软 X 射线(soft x-ray, SXR)阵列 [115] 、绝对极紫外辐射(Absolute
eXtreme Ultra Violet, AXUV)阵列[116]和三波远红外偏振干涉仪(far-infrared three-wave
polarimeter-interferometer, FIR) [117]。




                                          30
      华 中 科 技 大 学 博 士 学 位 论 文




                  图 3-1   J-TEXT 托卡马克装置图

   J-TEXT 的磁诊断系统十分丰富，如图 3-2 所示。该图将 J-TEXT 的环向与极向
展开分别为 x 轴与 y 轴。其中 Mirnov 探针主要用于测量等离子体的磁扰动信号，是
微分信号，锁模探针主要用于测量等离子体中的锁模磁岛的幅值大小，是积分信号。
J-TEXT 拥有两套极向 Mirnov 阵列，一套环向 Mirnov 阵列以及低场侧鞍形线圈阵列
和高场侧 Br 探针两套锁模探针阵列。其中极向阵列 1（Poloidal probe array 1）由 12
个磁探针组成，均匀分布在等离子体极向截面的半个圆周上，相邻两个磁探针极向角
度为 15°，每个磁探针包含两个测量线圈，可分别测量极向和径向磁扰动；极向阵列
2（Poloidal probe array 2）由 34 个磁探针组成，均匀分布在等离子体极向截面的整个
圆周上（高场侧中平面上下各 30°范围内为 J-TEXT 高场侧偏滤器靶板，由高场侧 BZ
磁探针代替），相邻两个磁探针极向角度为 7.5°，每个磁探针包含两个测量线圈，可
分别测量极向和径向磁扰动；环向磁探针阵列（Toroidal probe array）由 24 个磁探针
组成，布置在低场侧斜上下真空室内壁，在环向上均匀分布，相邻两个磁探针环向角
度为 45°，每个磁探针包含两个测量线圈，可分别测量环向和径向磁扰动。通过比较
极向和环向磁探针阵列的相位关系可以得到磁扰动的极向和环向模数。当撕裂模磁
岛与螺旋场或者误差场作用发生锁模或接近锁模时，磁探针阵列由于 NS 值（匝数与
探针面积乘积）很小，因此难以测量锁模磁岛的信息。而低场侧鞍形线圈阵列和高场
侧 Br 探针两套锁模探针阵列 NS 值设计较大，可以测量锁模磁岛的信息。J-TEXT 上
的磁诊断系统可以从空间尺度与时间尺度全方位测量 MHD 不稳定性导致的电磁信
号。

                             31
        华 中 科 技 大 学 博 士 学 位 论 文




                      图 3-2 J-TEXT 磁诊断系统分布图[114]

    J-TEXT 装置中以 SXA 至 SXE 的五组 SXR 阵列组成了目前的 SXR 诊断系统，
如图 3-3 (a)所示。SXA, SXB, SXC 为三组成像阵列，空间分辨率为 1.5 cm，能覆盖
到-23 < r < 23 cm 的等离子体区域；SXD 和 SXE 为两组局域观测阵列，空间分辨率
达到 0.5 cm，能够分别测量得到 r < 15 cm 及> 10 cm 处的磁流体不稳定现象。除能
够观测 MHD 现象外，SXR 诊断系统能够获得等离子体内部温度、密度、杂质等相
关现象信息。J-TEXT 装置中以 AXUV_CA, AXUV_CB, AXUV_CE, AXUV_CF 阵列
组成了目前的 AXUV 诊断系统，如图 3-3(b)所示。AXUV 阵列位于 port3，共有四个
阵列（探测器 AXUV16ELG），即 AXUV_CA（R = 1.05 m, φ = 68°, Z = 0.61 m），
AXUV_CF（R = 1.05m, φ = 68°, Z = -0.61 m），AXUV_CB（R = 1.654 m, φ = 68°, Z =
0.085 m），AXUV_CE（R = 1.654 m, φ = 68°, Z = -0.085 m），且每个阵列都有 16 道观
测弦。其中 AXUV_CA 主要扫描高场侧区域，AXUV_CF 扫描低场侧区域，AXUV_CB
和 AXUV_CE 则分别扫描上下两个区域。AXUV 阵列空间分辨约为 2 cm，同样能够
获得等离子体的温度、密度、杂质等相关现象信息。与 SXR 诊断不同的是，由于等
离子体边界区域温度较低，辐射信号强，AUXV 诊断对等离子体靠近边界区域的辐
射测量更加准确。


                                    32
华 中 科 技 大 学 博 士 学 位 论 文




 图 3-3 J-TEXT 上(a) SXR [115]与(b) AXUV [116]阵列分布示意图




  图 3-4 J-TEXT 上 FIR 三波远红外干涉仪结构示意图[117]


                        33
     华 中 科 技 大 学 博 士 学 位 论 文

  J-TEXT 上的 FIR 系统的作用是测量等离子体中的电子弦平均密度与法拉第旋转
角，如图 3-4 所示。其中测量电子弦平均密度的原理是电磁波通过磁化等离子体传
播时，电磁波的相位会发生变化，而相位变化的大小反映了电子密度的大小。两者的
关系由公式：ne = ϕλnc/πL 决定，其中 ne 为电子弦平均密度，ϕ 为电磁波相位的变化
量，λ 为电磁波的波长，nc 为电磁波的截止密度，L 为测量弦长。J-TEXT 的 FIR 系
统在 2013 年实现了 14 道同时测量，2014 年增加了 3 道实现了 17 道同时测量。17
道探测器的测量位置分别是−24: 3: 24 c𝑚，空间分辨率为 3 c𝑚，高场侧和低场侧对
称分布，覆盖了大部分的等离子体区域。

3.2 通用破裂数据库子类的设计与实现

  破裂预测与跨装置破裂预测研究需要经常对放电数据做增删查改的处理，并且
需要从多个托卡马克 MDSPlus 数据库中转储数据，因此一套通用的破裂数据库框架
可以极大地提升工作效率。其中数据文件接口与数据转储功能是最常用的两个功能。
本节对 J-TEXT 通用破裂数据库框架下的“FileRepo”和“MDSDumper”做了重写与
升级，并介绍其设计与实现。

3.2.1 通用破裂数据库简介

  跨装置破裂预测的研究需要多个托卡马克数据的支持，因此需要一个完整的框
架拥有以下功能：1）从各个托卡马克 MDSPlus 服务器中下载数据；2）统一的文件
库存放数据及标签；3）能与文件库文件交互，实现增删查改的功能。该框架的基本
元素是“炮”，并不局限于原始数据，处理后的数据乃至模型的输入，只要“炮”的
概念能使用，便可使用该框架。JDDB 是 J-TEXT 自主团队开发的用于破裂预测及跨
装置破裂预测的数据库管理、数据处理分析及模型评估框架[63]。本工作设计并实现
了两个 JDDB 子模块，文件接口子类与数据转储子类实现了上述功能。
  JDDB 和一个典型破裂预测模型训练的流程如图 3-5 所示。JDDB 由标签数据库
子类“MetaDB”、文件接口子类“FileRepo”、数据转储子类“MDSDumper”、数据处
理接口子类“Processor”和模型评估子类“Performance”五个模块组成。标签数据库
子类提供了破裂标签信息相关的接口，可以实现与 MongoDB 数据库的交互，可以生


                        34
      华 中 科 技 大 学 博 士 学 位 论 文

成、查询、修改、下载与一炮相关的标签信息实现自动化打标签、数据清洗与筛选等
功能。文件接口子类可以将不同托卡马克装置的数据存储为并行文件系统上具有统
一数据结构的 HDF5 文件。每个 HDF5 文件为一炮，包含了“数据”与“标签”两个
  ，分别存储每一炮的时间序列数据与标签。文件接口子类可以实现对 HDF5 文
“组”
件的增删查改功能。数据转储子类可以将各个托卡马克存储在 MDSPlus 上的数据转
储为 HDF5 格式，该模块可以实现增量转储。数据处理接口子类用于处理时间序列
数据。可以在集群上并行调度和运行，从而加快破裂预测数据预处理的过程。JDDB
中数据处理接口子类提供了人工智能破裂预测中常用的，数据对齐、重采样以及归一
化等分析程序。模型评估子类提供了对训练完成模型的测试和评估接口，可以对每一
炮的预测得到预测结果与提前时间，自动生成 csv 文件存储，并且根据每一炮的结果
自动生成整个测试集的预测性能，绘制 ROC 曲线。
  JDDB 允许用户在除了针对性的模型训练阶段，其余所有阶段都可以使用，且处
理对象均为一炮为单位的 HDF5 文件。HDF5 结构稳定，无论如何处理，都将时间序
列数据存储在“数据组”中，将标签数据存储在“标签组”中。JDDB 常用步骤为，
先通过标签数据库子类筛选出需要使用的炮号段与诊断，使用数据转储子类将数据从
MDSPlus 服务器中下载到本地，并存储为 HDF5 格式，再经过数据处理接口子类对数
据进行用户想要的处理。数据处理接口子类非常灵活，提供接口允许用户接入任何自
定义的数据处理程序。模型训练完成后，可以使用模型评估子类自动输出模型每一炮
与全部的预测性能。

3.2.2 破裂数据文件接口子类 FileRepo 的设计与实现

  首先要 明确文 件的结 构，我 们定义 每一炮 为一个 HDF5 文件 ， 并命名为
“shot_no.hdf5”（例如 1052637.hdf5）。如图 3-6 所示。每个文件中设有两个“组”，
分别为“数据”和“标签”。每个“数据组”中可以存储不同的“数据集”，一般为原
始信号、处理后的信号或提取的特征。每个“数据集”拥有两个“属性”分别为该“数
据集”的“起始时间”与“采样率”。通过这两个“属性”便可以计算出该“数据集”
的时间轴，节省存储空间。每个“标签组”中可以存储不同的“标签”，一般为该炮
     “标签”中必须存在的两个“标签”为“是否破裂”和“下降时间”。其
的标签信息。

                          35
       华 中 科 技 大 学 博 士 学 位 论 文

                  “下降时间”记录了该炮的结束时间（若
中“是否破裂”记录了该炮是否为破裂炮，
                              “标签组”中还
该炮为非破裂炮即为电流下降时刻，若该炮为破裂炮即为破裂时刻）。
可以存储对应“数据组”中某个信号是可用（“TRUE”）还是不可用（“FALSE”）。图
3-6 中展示了“\ip”这一“数据集”的数据、该炮的“下降时间”时刻、该炮是否破
裂以及该炮“\ip”的曲线示意图。




                图 3-5   JDDB 及破裂预测模型训练工作流程

                                     “写”、
   用于处理该文件接口的子类命名为“FileRepo”，其中包含了“读”、  “删”
三大功能以及与标签数据库子类上传与下载“标签”的交互功能。在初始化文件接口
子类时，为了使存储的文件结构更具多样性，使用了动态路径的方式定义。该动态路
径 的 标 识 为 “ $shot_x$ ” 其 中 x 代 表 每 10x 炮 为 一 个 文 件 夹 存 储 。 例 如
“\data\$shot_2$\$shot_1$”表示在“data”这一文件夹下，先每 100 炮存储成一个文
                        “读”的功能中，可以读取 1.根目
件夹，再在该文件夹内每 10 炮存储成一个文件夹。
录下所有炮号（即上述例子中“\data”目录下）；2.每一炮“数据组”与“标签组”中
的所有“数据集”以及“标签”；3.每个“数据集”内所有信号的数据以及对应的“属
性”；4.每个“标签”中的数值。“写”和“删”的功能与读的功能一一对应。


                              36
     华 中 科 技 大 学 博 士 学 位 论 文




               图 3-6 文件接口中的文件构成实例

3.2.3 破裂数据转储子类 MDSDumper 的设计与实现

  目前大部分托卡马克数据均使用 MDSPlus 框架进行数据服务，MDSPlus 是一组
可以对复杂科学数据进行采集、存储和管理的软件工具[118-120]。它目前至少被 4 大洲
超过 30 多个实验装置使用，是在磁约束聚变中使用最为广泛的数据管理系统 [118]。
构建破裂预测数据库时，需要将 MDSPlus 中的部分数据转储到文件接口子类中，实
现该转储功能的子类命名为“MDSDumper”。
  数据转储子类可以实现将 MDSPlus 中的数据转储至文件接口子类的功能。使用
该子类首先需要定义一个文件接口子类，定义该子类时需要提供各装置的 MDSPlus
地址以及数据所在的“tree”名称，定义该子类中后可以自动连接到各装置的 MDSPlus
服务器。转储数据时，需要提供炮号（或炮号列表）以及诊断名称（或诊断名称列表）。
转储时还可以选择是否覆盖本地数据，若不覆盖本地数据，则不会重新转储已经转储
完成的数据，以节省转储时间。转储有自动重连功能，可以防止网络波动造成的服务


                       37
       华 中 科 技 大 学 博 士 学 位 论 文

器网络短暂异常。转储时会自动将原本存储在 MDSPlus 服务器中的数据与时间数组
变为单一的数据数组存储，对应时间通过采样率以及开始时间两个参数存储，以节省
存储空间。转储时还会自动将各诊断是否可用记录在“标签组”中，方便后续数据清
洗工作。

3.3 基于物理指导的特征提取算法

   本节从可能导致破裂的四大主要诱因出发，根据可能导致破裂的物理原因，利用
物理实验中常用的数据处理手段以及统计学方式，提取出与破裂直接相关的物理特
征，用于后续机器学习模型的输入。根据 3.1 节介绍的磁诊断、辐射阵列诊断、密度
阵列诊断与一些基本的等离子体控制与状态诊断，提取了四类主要破裂相关的特征。
分别为，MHD 不稳定性相关特征、辐射相关特征、密度相关特征以及等离子体控制
相关特征。表 3-1 为本节拟提取的特征类型及其涵盖的时间与空间信息。这种基于
物理指导的特征提取算法在本论文中被称为 Physics-Guided Feature Extraction (PGFE)。

               表 3-1 本节拟提取的特征类型及其涵盖的信息


            特征类型                         涵盖信息

       MHD 不稳定性相关特征                    时间与空间信息

          辐射相关特征                         空间信息

          密度相关特征                         空间信息

       等离子体控制相关特征                   基本参数信息、时间信息

   PGFE 作为一种归纳偏置，可以让模型更关注于与破裂相关的物理特征从而更好
的提升源装置模型的性能。深度学习强大的特征提取能力使其在使用足够多的原始
信号时通常会超过传统的机器学习。然而，当没有足够的数据时，可以将归纳偏置引
入网络，以更好地在模型中嵌入现有的破裂理解。归纳偏置将限制机器学习算法的搜
索域，所以当没有足够的数据时，它可以得到一个更好的结果。使用现有的破裂理解
进行特征提取来减少特征空间的维度，限制了训练算法的搜索域，因此它可以被认为


                             38
       华 中 科 技 大 学 博 士 学 位 论 文

是增加了归纳偏置。PGFE 还是实现跨装置破裂预测的基础，托卡马克装置间的诊断，
位型各不相同等因素，导致跨装置破裂预测的工程难度较大。PGFE 通过提取与诊断
无关的带有破裂物理相关的特征，可以解决装置与装置间因诊断导致的测量数据不
同的问题。PGFE 甚至可以减少预测器的数据要求。由于跨装置破裂预测的性能均不
如针对自身装置的破裂预测，因此实现跨装置破裂预测，将破裂炮进行破裂缓解后，
便可拥有一定量的破裂数据。PGFE 可以在此情况下，更早地实现高性能的本装置破
裂预测效果。该特征提取算法将在本文的所以章节中均被使用。
   本节将先介绍 MHD 不稳定性相关的特征提取算法；由于辐射及密度相关特征
主要为阵列信号，等离子体控制相关特征多为直接读取的信号，因此将此 3 类特征
共同介绍。

3.3.1 MHD 不稳定性相关特征提取

   MHD 不稳定性是等离子体破裂的一个重要前兆。其中，撕裂模锁模、2/1 磁岛
的快速增长及多模耦合被认为是导致破裂的重要因素。Mirnov 探针与锁模探针是测
量 MHD 不稳定性的重要诊断。该工作将主要从 Mirnov 探针与锁模探针两种诊断数
据中进行特征提取。两个诊断及对应的特征如表 3-2 所示，提取的特征分别为 Mirnov
探针峰峰值(Mir_Vpp)、Mirnov 探针主频率(Mir_fre)、Mirnov 探针主频率对应幅值
(Mir_abs)、平均极向模数(mode_number_m, MNM)、平均环向模数, (mode_number_n,
MNN)与 n = 1 锁模幅值(n = 1 amplitude)。
   Mir_Vpp 是 Mirnov 探针经过 50 kHZ 低通滤波器后的峰-峰值。Mir_abs 和 Mir_fre
的提取中，J-TEXT 中 2/1 撕裂模式的典型频率约为 3 kHz，EAST 装置中该频率会稍
低。因此，可以选择一个 5 ms 的滑动窗口作为 Mirnov 探针快速傅里叶变换（FFT）
的时间窗口。Xi(f)代表第 i 个时间窗口（切片）的傅里叶变换。Mir_abs 和 Mir_fre 是
Xi(f)的强度和频率。如果 Mirnov 探针频谱中存在多个频率，将选择频谱强度最高的
一个，即主频率。在这里，我们没有使用积分 Mirnov 信号，以避免不同放电之间的
零漂不确定性对预测产生影响。X1i(f)和 X2i(f)代表两个 Mirnov 探针信号，各切片的傅
里叶变换。它们的互功率谱密度（Cross Spectral Density, CSD）可以表示为，



                                 39
       华 中 科 技 大 学 博 士 学 位 论 文

                 P12j ( f ) = X 1j* ( f ) X 2j* ( f ) = A( f )ei12 ( f )
                                                                    j
                                                                                     (3-1)

P12i(f) 是两信号间的互相关系数， A(f)是复数 P12i(f)的幅值，δ12i(f) 是复数 P12i(f)的相
角如果两信号为极向阵列的两个 Mirnov 探针信号，则极向模数可以表示为，

                                      12j ( f )
                                   m=                                                (3-2)
                                          
其中 θ 为两探针磁面位型下的极向角度，由于 J-TEXT 为圆截面限制器位型托卡马
克，因此当该角度较小时，柱坐标下空间极向角度可近似等于磁面坐标下的极向角
度。考虑到 Mirnov 探针可能测量到多个模式，因此将计算平均极向模数，由 MNM
表示。平均极向模数的表达式为

                        m =
                                ( f ) A( f )
                                          j
                                         12    k        k
                                                                                     (3-3)
                                 A( f )           k


其中 k 代表了 CSD 识别出的不同频率。环向平均模数 MNN 也通过此方法得到。 图
3-7 展示了 J-TEXT 上一次典型的撕裂模放电。

              表 3-2 MHD 不稳定性相关诊断及其可提取的特征


      诊断信号（输入信号）                                                  特征（输出信号）

                                                                 Mirnov 探针峰峰值

                                                                 Mirnov 探针主频率

          Mirnov 探针                                         Mirnov 探针主频率对应幅值

                                                                        平均极向模数

                                                                        平均环向模数

           锁模探针                                                         n = 1 锁模幅值


   图中显示了 MNM、MNN、Mir_fre 和 Mir_abs 与原始 Mirnov 信号随时间的变化。
撕裂模频率的减小与幅值的增长，迅速导致了锁模（小于 1ms），之后诱发了破裂。




                                              40
      华 中 科 技 大 学 博 士 学 位 论 文

该撕裂模为 2/1 撕裂模，Mir_fre 在锁模前约为 3kHz，Mir_fre 的下降代表了锁模的
发生。
   锁模后，n = 1 amplitude 将是重要的 MHD 相关特征。一个锁模探针测量到的锁
模信号可以表示为

                            Br ( ,  ) =  brn =i cos(m + n +  n =i )              (3-4)

其中 θ 和 φ 分别为锁模探针的极向与环向空间位置, m 和 n 分别是待测磁岛的极
向与环向模数， ξ 为螺旋相角。考虑到占比较大的几个分量，n = 0, 1 和 2，处在托
卡马克中平面测量位置的锁模探针（后面皆考虑这一位置）所测量到的信号可以将式
(2-4) 表示为

        Br ( = 0,  ) = brn =0 + brn =1 cos( +  n =1 ) + brn =2 cos(2 +  n =2 )
                                                                                       (3-5)
brn=1 可以通过两个环向相距 180°的锁模探针相减得到，可表示为式(2-6)
                                                      Br (1 ) − Br (1 +  )
                  Br1 = brn =1 cos(1 +  n =1 ) =
                                                                 2            .        (3-6)
n = 1 amplitude，即 brn=1 与 ξn=1 则可以通过两对上述锁模探针拟合得到。

3.3.2 辐射与密度及等离子体控制相关特征提取

   等离子体辐射与密度剖面可以很好的表现等离子体的辐射与密度不对称性状态，
是非常重要的破裂前兆。但等离子体剖面是一维数据，难以直接作为机器学习的输入
信号。国外的几大装置如 DIII-D、JET 与 AUG 等均使用了零维的剖面因子代替剖面
信息，但其使用的仅为平均值这样的一阶统计量。深度学习模型可以通过卷积对 1D
信号进行特征提取，其中包括高阶统计信息，是一种更强大的特征提取。本工作中，
我们直接计算了来自 SXR、AXUV 和 FIR 阵列的辐射和密度相关特征的 1D 信号的
高阶统计量(higher-order statistics, HOS)。这里我们选取了二、三、四阶统计量，方差
(var)、偏度(skew)、峰度(kurt)，其与诊断对应的输入与输出信号及其主要测量的物理
量如表 3-3 所示。
   方差是描述数据离散程度的统计量，本文用来表现阵列数据的离散程度，用来体
现等离子体空间分布的连续性，方差可以表示为：



                                               41
      华 中 科 技 大 学 博 士 学 位 论 文

                              1 n
                      var =     
                              n k =1
                                     ( xk −  )2       (3-7)

这里 n 代表了阵列中的通道数，xk 是第 kth 个通道的信号, μ 是一个阵列中所有通道的
平均值。由于等离子体剖面在径向上的分布为抛物分布，因此各通道数据分布的方差
越大，代表该剖面越峰化。




图 3-7 J-TEXT 中#1056014 ，典型撕裂模放电。a）等离子体电流；b）和 c）为 Mirnov 信号极
                       ；d）Mirnov 信号极向阵列原始信号的
 向与环向阵列的原始信号（左）和平均模式数（右）
                   Mir_abs（左）和 Mir_fre（右）




                                  42
    华 中 科 技 大 学 博 士 学 位 论 文

         表 3-3 阵列信号高阶统计量相关诊断及其可提取的特征




 诊断信号（输入信号）      特征（输出信号）                      主要测量的物理量




                SXR 的方差(var)、偏度
    SXR 阵列                                     测量芯部辐射分布为主
                  (skew)、峰度(kurt)



               AXUV 的方差(var)、偏度
    AXUV 阵列                                    测量边界辐射分布为主
                  (skew)、峰度(kurt)



                FIR 的方差(var)、偏度
    FIR 阵列                                       测量密度分布
                  (skew)、峰度(kurt)



  偏度是衡量阵列信号的分布对其平均值的不对称性，本文用偏度表现阵列信号
的数据偏移程度，用来判定等离子体剖面的整体幅值大小在数据分布上的偏移程度，
偏度可以表示为：
                         1 n
                             ( xk −  )3
                         n k =1
                skew =                                    (3-8)
                        1 n
                       [  ( xk −  ) 2 ]3/2
                        n k =1

如果 skew > 0，那么这种偏度被称为正偏或右偏状态，它代表了阵列信号的平均值大
于中位数大于模式（统计学意义）。如果偏度小于 0，则相反，如果偏度为 0，则上
述三个值是相同的。
  峰度是对分布的尾部相对于分布中心的综合权重的衡量，通常情况下，用峰度"
减去 3"，即使正态分布的峰度为 0 作为与正态分布的对齐。这种峰度也被称为超额
峰度，本工作简化称峰度。其计算方式可以表示为：



                            43
      华 中 科 技 大 学 博 士 学 位 论 文

                             1 n
                               
                             n k =1
                                    ( xk −  ) 4
                     kurt =                      −3   (3-9)
                             1 n
                            [  ( xk −  ) ] 2 2

                             n k =1

   更高的峰度表示更少的较大或较小的离群值，以及剖面中更集中的数据分布。因
此，较高的峰度代表一个平坦的剖面，而较低的峰度代表一个较陡的剖面。J-TEXT
一炮中的 HOS 特征如图 3-8 所示。蓝线代表每个阵列中间通道的 0D 信号，绿线、
黄线和橙线分别代表峰度、偏度和方差。在这种放电中，等离子体辐射的持续增加导
致了破裂。SXR 阵列和 AXUV 阵列的方差的增加代表辐射曲线逐渐达到峰值。FIR
阵列的峰度值略有下降，表明密度曲线的梯度增加。在 0.15 ms 之前，var, skew 和
kurt 的异常波动是由于等离子体的水平位移还没有完全稳定下来。辐射相关特征还
包括等离子体辐射功率 P_rad 和一些 0D 信号，如杂质辐射(Carbon III, CIII)和的软 X
射线辐射中心道 SXR_core。与密度有关的特征还包括 sum_ne 和 0D 信号芯部弦积分
密度 ne0。特征 sum_ne 是通过将 FIR 阵列中的所有信号相加来计算的，以近似地表
达一个极向剖面的电子密度。
   该炮的详细 HOS 特征如图 3 9 所示，时间范围从 0.315 s 到 0.355 s。在 0.341 s
之前，HOS 特征变化不大。每个数组的方差增加，每个数组的偏度和峰度略微减少。
在 0.341 s 之后，HOS 特征显示出明显的变化和振荡，锯齿消失。FIR 和 SXR 数组的
方差以及 FIR 数组的偏度显著减少。而 FIR 数组的峰度显著增加，AXUV 数组的方
差先增加后减少。其他 HOS 特征显示出轻微变化的振荡。大约在 0.349 s 时，发生了
破裂。
   等离子体控制相关信号则包括，纵场、等离子体电流、垂直场与水平场这些平衡
参数。还包括了垂直场和水平场的微分信号和等离子体位移信号这些反应等离子体
动态变化的变化信号。所有的特征信号与提取该信号所需的诊断，及其与破裂间的联
系均展示在表 3 4 中。




                                 44
      华 中 科 技 大 学 博 士 学 位 论 文




图 3-8 #1057831 炮中 HOS 信号展示。蓝线代表每个阵列中间通道的 0D 信号，绿线、黄线和
橙线分别代表 kurt、skew 和 var。 a）等离子体电流；b）FIR 阵列信号（密度）；c）SXR 阵列
                    信号，d）AXUV 阵列信号


3.4 面向 J-TEXT 单一装置破裂预测模型的实现

  本节将主要介绍基于 PGFE 的 J-TEXT 破裂预测模型的实现及其性能分析。首先
将介绍模型的结构与本节所使用的数据集与训练方式；接着将介绍模型的预测性能
与减少模型训练数据时的模型性能。

3.4.1 常用机器学习算法介绍与选择

  本文需要同时考虑破裂预测的精度与可解释性，因此在机器学习算法的选择上，


                           45
     华 中 科 技 大 学 博 士 学 位 论 文

也需要算法能同时保证预测精度与具有一定的可解释性。破裂预测研究中常用的机
器学习算法主要可以分为神经网络、决策树与支持向量机三大类。
  早期的多层感知器结构，与现在常用的深度神经网络结构，都属于神经网络的算
法。神经网络是一种模仿生物神经系统的机器学习算法，广泛用于分类、回归、图像
识别等任务。它们的核心是由多个层次的“神经元”或节点组成的网络结构。多层感知
器是一种前馈神经网络，通常由一个输入层、一个或多个隐藏层和一个输出层组成。
每个神经元与上一层的所有神经元相连，通过激活函数输出结果。在处理线性可分或
低维度数据时表现较好，但由于其结构相对简单，对于高维度或复杂模式的学习能力
有限。因此，如今破裂预测一般不再使用多层感知器。不过多层感知器的可解释性较
好。由于其网络层次较浅，可以通过分析权重来理解输入特征与输出之间的关系。然
而，随着隐藏层的增加，可解释性会逐渐降低。深度神经网络是指具有多个隐藏层的
神经网络，相比多层感知器，它具有更深的网络结构，因此可以学习更复杂的模式和
特征。像 CNN，RNN，LSTM 以及 Transformer 都属于深度神经网络。深度神经网络
由于能够提取数据的多层次特征，尤其是在处理非线性和高维数据时表现优异，因此
其精度通常高于多层感知器。然而，深度神经网络的训练需要更大的数据集和更强的
计算能力且可解释性较低。随着网络深度的增加，理解每一层所学特征的意义变得更
加困难。因此，深度神经网络虽具有较高的预测精度，但可解释性较差。目前破裂预
测研究中，深度神经网络是常用来实现高性能的破裂预测模型，但可解释性一直是难
以解决的问题。
  支持向量机（Support vector machines, SVM）是一种广泛应用于分类和回归任务
的机器学习算法，尤其擅长处理高维数据，SVM 主要分为线性 SVM 和非线性 SVM。
在处理线性可分的数据集时，线性 SVM 表现出色，通常能够提供高精度的分类结果。
即使在高维空间中，SVM 也能有效地找到分类边界，具有良好的泛化能力。线性 SVM
的可解释性较好，特别是在低维度情况下。因为分类决策基于输入特征与超平面之间
的线性关系，所以通过分析超平面的法向量（权重），可以了解哪些特征对分类影响
最大。当数据不可线性分割时，非线性 SVM 可以通过核函数（如多项式核、RBF 核）
将数据映射到更高维的空间，在这个空间中找到一个线性可分的超平面。非线性 SVM


                         46
     华 中 科 技 大 学 博 士 学 位 论 文

在处理复杂模式时表现出色，精度通常较高，也是破裂预测常用的算法。然而，选择
合适的核函数和参数可能需要大量的经验和调优过程。非线性 SVM 的可解释性相对
较差。由于数据经过核函数映射到高维空间，分类过程变得难以直观理解。虽然最终
的分类决策仍然由支持向量决定，但由于无法直接观察高维空间的分类边界，解释结
果变得复杂。SVM 算法早期在 JET 装置上实现了性能较好的破裂预测模型，但随着
破裂预测研究的不断深入，SVM 算法无论是精度还是可解释性都缺乏一定的竞争力。
  决策树通过递归地将数据集划分为子集，从而生成一棵树。每个内部节点代表一
个特征的测试，叶子节点则表示分类结果或预测值。决策树在处理简单和中等复杂度
的数据集时表现良好，特别是当数据特征之间的关系较为简单时。然而，单个决策树
容易过拟合，尤其是在数据集较小或存在噪声时，这可能导致模型的泛化能力不强，
从而影响精度。但是决策树的可解释性较强。它们通过树形结构直观地展示了决策过
程，可以很容易地追踪到输入特征如何影响预测结果。因此，决策树在实际应用中非
常受欢迎，特别是在需要解释模型决策的场景。梯度提升决策树(Gradient boosting
decision tree, GBDT)是一种基于决策树的集成算法，通过迭代地训练多个弱学习器
（通常是小的决策树），并逐步减少残差来提高预测精度。每一步的新树都是为了修
正之前模型的错误。GBDT 在精度上表现优异，尤其是在处理复杂数据集时。通过结
合多个决策树的预测结果，GBDT 通常能够达到很高的精度和较强的泛化能力。它在
实际应用中，如金融预测、分类任务等，表现得非常出色。GBDT 的可解释性较低于
单一的决策树。尽管每个单独的决策树仍然具有较好的可解释性，但由于 GBDT 是
多个树的组合，其整体决策过程变得更加复杂，难以直观理解。不过，特征重要性分
析和部分依赖图等可解释性工具可以帮助提升 GBDT 的可解释性。
  基于上述的三大类算法在精度和可解释性上的优劣势，本文决定采用 GBDT 算
法结合可解释性分析工具来实现本文破裂预测模型精度与可解释性都兼顾的需求。
由于深度神经网络为“黑箱”模型，可解释性难以保证，因此本文不再考虑深度神经
网络。而 SVM 算法也具有一定的可解释性，本章 3.4.4 节也使用 SVM 算法进行了破
裂预测模型的训练，但由于精度低于 GBDT 算法，因此最终还是选用 GBDT 算法作
为本文的机器学习算法。


                       47
      华 中 科 技 大 学 博 士 学 位 论 文




图 3-9 破裂炮 #1057831 的 HOS 特征范围从 0.315 秒到 0.355 秒。橙色、黄色和绿色线分别代
表方差、偏度和峰度。(a)显示了该放电的等离子体电流；(b)–(d)显示了 FIR 阵列，提供了密度
     信号；(e)–(g)显示了 SXR 阵列；(h)–(j)显示了 AXUV 阵列，提供了辐射信号




                             48
    华 中 科 技 大 学 博 士 学 位 论 文

              表 3-4 所有特征的描述和符号

  特征类型      可能的破裂诱因            诊断通道            特征名称
                                                Mir_abs
                             极向 Mirnov 探针        Mir_fre
            2/1 磁岛涨大;            阵列              Mir_VV
MHD 不稳定性相
             磁岛重叠;                          mode_number_m
   关
              锁模             环向 Mirnov 探针
                                            mode_number_n
                                 阵列
                               锁模探针          n=1 amplitude
                             AXUV 阵列（整个
                                                  P_rad
                                截面）
                             中心道 SXR 弦积
                                               SXR_core
                                  分
             边缘冷却；
  辐射相关                         CIII 辐射             CIII
             杂质聚芯
                                            AXUV_array_kurt
                              AXUV 阵列
                                               (skew, var)
                                            SXR_array_kurt
                               SXR 阵列
                                               (skew, var)
                             芯部弦平均密度                ne0
                                             FIR_array_kurt
  密度相关       密度极限              FIR 阵列
                                               (skew, var)
                               FIR 阵列            sum_ne
                             纵场、等离子体电
                                                  Bt, Ip
                                  流
  控制信号      控制及放电区间                               Ihf, Ivf,
                             水平与垂直场电流
                                             Ihf_diff, Ivf_diff
                                 位移               dr, dz




                        49
        华 中 科 技 大 学 博 士 学 位 论 文

3.4.2 J-TEXT 破裂预测模型结构

    本节中介绍的 J-TEXT 破裂预测模型主要基于 PGFE 以及机器学习算法实现，同
时该模型还具有可解释性，因此本论文将其称之为基于 PGFE 的可解释破裂预测器
(Interpretable Disruption Predictor based on PGFE, IDP-PGFE)。该模型对于可解释性的
研究与分析将在第 5 章详细介绍，本章仅对模型整体结构做简单介绍。IDP-PGFE 主
要结构分为特征提取器、分类器以及解释器，如图 3-10 所示，其中解释器便是为了
GBDT 算法可解释性而选取的合适的可解释性工具。其中特征提取器由 PGFE 构成，
已在上节中详细阐述。本文的分类器选择了一种使用了 dropout 方法的 GBDT 模型，
即 Dropouts meet Multiple Additive Regression Trees (DART)。非 dropout 的 GBDT 算
法，如多加回归树（Multiple Additive Regression Trees, MART），对最初添加的几棵
树的贡献可能过于敏感，可能导致模型学习到错误的知识。DART 使用了深度神经网
络中 dropout 的技巧，可以随机地丢弃现有决策树，防止过拟合。如果没有树被移除，
DART 实际上就是传统的 GBDT。如果所有的树都被放弃，DART 就相当于随机森林
（random forest, RF），因为回归树每次都要重新生成，而且没有以前的回归树作为基
础。解释器选用的是 SHapley Additive exPlanations (SHAP)，一种基于博弈论的方法，
用于计算如何在 "玩家"（特征）之间公平分配 "报酬"（预测）。Shapley 值并不是从
模型中去除特征后预测结果的差异，Shapley 值是一个特征值对不同模型中的预测的
平均贡献。SHAP 是一种解释模型预测的统一方法，它的优点是在博弈论中具有坚实
的理论基础，特征唯一的贡献度分配，以及全局和局部解释的一致性。PGFE 作为机
器学习算法的输入数据具有物理知识，因此无需通过深度神经网络来实现特征提取
的功能，并且 GBDT 模型与可解释工具 SHAP 结合在可解释性方面，相比于深度神
经网络与 SVM 算法也有着天然的优势。

3.4.3 J-TEXT 数据集及训练方法

    电子回旋共振加热(Electron Cyclotron Resonance Heating, ECRH)系统在 2019 年
开始时成功投入使用。J-TEXT 的数据集包含 2017-2018 年和 2021-2022 年中的 1791
次放电，包括应用 ECRH 和 RMP 的放电。除了由大量气体注入(Massive Gas Injection,



                                     50
       华 中 科 技 大 学 博 士 学 位 论 文

MGI)或散列弹丸注入(shattered pellet injection, SPI)和工程测试引发的主动破裂，其余
所所有破裂类型都包括在内。训练集和验证集均从 2017-2018 年的放电中随机选择。
测试集从 2017-2018 年和 2021-2022 年的放电中随机选择。




             图 3-10 基于 PGFE 的可解释破裂预测器模型结构图

   表 3-5 中展示了数据集的分布情况。训练集中有 212 炮破裂炮与 1199 炮非破裂
炮，其中混入了少量 2021-2022 年的放电用于适应跨年度训练。验证集中破裂炮与非
破裂炮各 80 炮。测试集中破裂炮与非破裂炮各 110 炮。2017-2018 年的锁模探针是
鞍形线圈，极向 Mirnov 阵列为 port10 处的阵列，而在 2021-2022 年锁模探针则是高
场侧磁探针，极向 Mirnov 阵列选取了 port2-3 之间的阵列。这也体现出了 PGFE 相
对于诊断系统的独立性，即可以通过不同的诊断提取相同的物理特征。大大增加了破
裂预测模型对于不断变化的装置诊断系统的适应性，也为诊断系统差异大的跨装置
破裂预测模型建立奠定基础。其中每一炮均每 0.1 ms 做成一个时间切片，切片维度
为特征数量，时间跨度为 0.15 s 至破裂时刻。将破裂时刻前 25 ms（改时间通过扫描
2~50 ms，选取了最好的模型结果决定）标记为破裂前兆，同时标签为 1，其余时刻
均为 0。非破裂炮中所有时刻标签均为 0。这种标签方式使得正负样本及其不均匀。
因此，在训练中调整了破裂样本的权重，并随机丢弃了一些非破裂样本，使得样本分
布均衡。
   训练前还需要对每个特征做 z-score 标准化处理，z-score 常用于数据标准化，将
不同特征转换为具有相同尺度的分布。通过标准化，特征值被转换为零均值和单位标
准差，这有助于消除特征量纲差异对模型训练的影响。标准化后的数据分布更加平
滑，有助于模型更好地泛化到未见过的数据，从而提高模型的泛化能力。z-score 可



                            51
      华 中 科 技 大 学 博 士 学 位 论 文

以表达为，
                             X −
                      Xz =                          (3-10)
                              
其中，X 为各特征所有的数据，μ 为该特征所有样本点分布的均值，σ 为该特征所
以样本点分布的标准差，Xz 为 z-score 标准化后的所有特征样本。

                    表 3-5 J-TEXT 数据划分


                     非破裂                   破裂


   训练炮数               1199                 212

   验证炮数               80                    80

   测试炮数               110                  110



3.4.4 模型预测性能

   PGFE 可以有效地提升破裂预测的性能，为了更直观的体现出效果，我们将所有
原始诊断数据也送入模型训练，得到了使用原始信号的破裂预测模型 (disruption
predictor using raw signals, DPRS)，作为参考。本工作考虑了一种增加模型鲁棒性的
方式，即设定连续报警阈值。后续的性能测试中，将连续报警阈值取为 10，即连续
报警 1ms 时，才认为是模型给出了破裂预警。J-TEXT 时间尺度较小，因此破裂过程
发展较快，本工作将提前 10 ms 正确报警认为是预测成功，记为 TP。若提前时间小
于 10 ms 则记为 FN。
   IDP-PGFE 与 DPRS 性能对比如图 3-11 所示。该图所示的模型结果，均为超参
数扫描后的模型结果。考虑到有效的模型性能对比，横轴与纵轴并未选取从 0%~100%
的所有区间。可以看出 IDP-PGFE 得益于 PGFE 的特征提取，性能远好于使用原始数
据的 DPRS 模型。模型 AUC 达到了 0.987，可选取的最佳 TPR 与 FPR 为 96.36%与
2.73%，此时模型阈值为 0.72。即可以实现性能以满足下一代托卡马克装置如 ITER
所需的要求 TPR>95%且 FPR<5%的破裂预测性能要求[24]。


                              52
     华 中 科 技 大 学 博 士 学 位 论 文




图 3-11 IDP-PGFE 与 DPRS 预测性能图。其中横轴为 FPR，选取了 0%~20%的区间。纵轴为
                  TPR，选取了 60%~100%的区间

  图 3-12 展示了当模型阈值为 0.5 时，随着预测提前时间的增加，TPR 减小的情
况。其中当预测提前时间大于 300 ms 仍预测成功的炮，认为是幸运炮，IDP-PGFE 对
该类型的预测较少。当提前时间为 30 ms 时 IDP-PGFE 仍能拥有高于 90%的预测成
功率，这将为破裂缓解系统争取更多的时间。提前时间主要受各装置的破裂缓解系统
影响，一般越大的装置，对提前时间的要求就越高，即需要更早预警的预测破裂。随
着破裂缓解系统研究的进展，会逐渐缩小对破裂预测提前时间的需求，这也可以降低
破裂预测算法的压力。
  本节还基于 3.4.3 的数据集，使用 SVM 算法分别对原始信号以及物理特征做了
破裂预测模型，一是为了验证 PGFE 在不同的机器学习算法上均可以相比于使用原
始信号提升破裂预测的性能；二是可以量化分析 SVM 算法与 GBDT 算法在预测精
度上的差异。表 3-6 展示了 SVM 算法与 DART 算法分别使用原始信号和物理特征
得到的模型 AUC，以及选取最合适的 TPR 与 FPR 的模型性能。由表中可以看出，
无论是基于 GBDT 的 DART 算法，还是 SVM 算法，物理特征作为输入数据得到的
破裂预测模型在各种评价指标上的性能均高于使用原始信号作为输入数据的模型。

                           53
     华 中 科 技 大 学 博 士 学 位 论 文

无论是使用原始信号还是物理特征作为输入数据的模型，DART 算法的评价指标性
能也均高于 SVM 算法。因此，证明了 PGFEPGFE 在不同的机器学习算法上均可以
相比于使用原始信号提升破裂预测的性能，且基于 GBDT 的 DART 算法训练的破裂
预测模型精度较 SVM 算法更高。




图 3-12 预测破裂的累计百分比（TPR）与预测提前时间的关系，模型阈值被固定为 0.5。红色
虚线代表累积的破裂预测百分比等于 90%。浅蓝色的虚线代表 10ms、30ms 和 300ms 的预测提
                        前时间

3.4.5 模型对数据量需求降低的能力

  上节中提到，由于 PGFE 将归纳偏置引入了机器学习模型，因此可以减少机器
学习模型对训练数据的需求。因此，本段测试了 IDP-PGFE 减少数据训练的性能。该
性能同样与未进行 PGFE 的 DPRS 进行对比。分别将训练数据减少为 40%、10%、5%
进行训练，并进行超参数扫描，选取性能最好的模型，其结果如图 3-13 所示。可以
看到，当训练数据为原始数据量的 10%时，IDP-PGFE 的性能与 DPRS 使用全训练数
据的性能相当。当训练数据为原始数据量的 5%时 IDP-PGFE 的性能出现了明显的下
降。


                         54
      华 中 科 技 大 学 博 士 学 位 论 文




图 3-13 IDP-PGFE 与 DPRS 预测性能图。其中横轴为 FPR，选取了 0%~20%的区间。纵轴为
                    TPR，选取了 60%~100%的区间




 图 3-14 两种模型的 AUC 值与训练集的数据量的关系。蓝线代表 DPRS。橙色线代表 IDP-
PGFE。x 轴从 100%下降到 5%。随着数据量的减少，DPRS 的 AUC 值比 IDP-PGFE 的 AUC 值
下降得快。随着数据规模从 10%到 5%，IDP-PGFE 的 AUC 值从 0.939 下降到 0.845，而 DPRS
            的 AUC 值从 0.839 下降到 0.763，数据规模从 20%到 5%


                              55
     华 中 科 技 大 学 博 士 学 位 论 文

 表 3-6 DART 算法与 SVM 算法分别使用原始信号与物理特征训练破裂预测模型性能对比


    算法        输入数据           评价指标        指标性能

                            TPR(>10ms)    90%

              原始信号             FPR       16.67%

                              AUC        0.935
   DART
                            TPR(>10ms)   96.36%

              物理特征             FPR       2.73%

                              AUC        0.987

                            TPR(>10ms)   89.09%

              原始信号             FPR       20.91%

                              AUC         0.87
    SVM
                            TPR(>10ms)   93.64%

              物理特征             FPR       10.91%

                              AUC         0.94




3.5 本章小结

  本章介绍了基于物理特征的机器学习 J-TEXT 破裂预测研究，发展了 PGFE 算
法，获得了高性能的 J-TEXT 源装置模型，并可以降低模型对训练数据量的需求。首
先本章介绍了通用破裂数据库关键子类的设计与实现。文件接口子类主要用于处理
HDF5 文件，可以高效的将对“一炮”为研究单位的托卡马克放电数据进行处理。数
据转储则可以链接 MDSPlus 服务器，下载托卡马克放电的原始数据，并转存成 HDF5
格式。该数据库可以极大地提升破裂预测研究者的工作效率。基础工程类工作介绍完



                       56
      华 中 科 技 大 学 博 士 学 位 论 文

后，本章介绍了本文所有章节均使用的特征提取算法 PGFE。PGFE 通过对现有破裂
的理解，分出了 4 类与破裂相关的特征信号，并利用测量到该特征的诊断与物理实
验中的数据处理方式结合进行特征提取。基于 PGFE 与 DART 机器学习算法，J-TEXT
实现了高性能的源装置破裂预测模型。并且该模型得益于 PGFE 引入的归纳偏置，
实现了极好的破裂预测性能，并拥有减少训练数据预测的能力。模型性能可以达到
AUC=0.986，TPR=96.36%，FPR=2.73%。可以满足下一代托卡马克装置如 ITER 对破
裂预测性能的要求。并且当训练数据仅为 20 炮破裂炮与 120 炮非破裂炮（原本训练
集的 10%）时，该模型依然可以实现 AUC = 0.939, TPR = 89.09%, FPR = 10%的模型
性能。即仅需 20 炮破裂炮与 120 炮非破裂炮（与基线模型相比 10%）的训练数据，
达到基线模型 AUC 的 95.2%。




                            57
       华 中 科 技 大 学 博 士 学 位 论 文


       4   物理指导的领域自适应跨装置破裂预测研究

   目前国际上的跨装置破裂预测研究均使用了混合数据的方式。然而，托卡马克装
置间的数据差异大，单纯依靠原模型提取装置间数据的差异过于困难，J-TEXT 与
EAST 是两个差异巨大的装置，非常适合开展跨装置破裂预测模型的方法研究。其中
J-TEXT 作为源装置，并可以类比为现有托卡马克，EAST 作为目标域装置，并可以
类比为未来的托卡马克。可以将 J-TEXT 到 EAST 的跨装置破裂预测研究，类比为现
有托卡马克到未来托卡马克跨装置破裂预测的实验测试。领域自适应在机器学习研
究中已广泛应用于迁移学习的任务中，有着良好的理论基础。PGFE 虽然对于跨装置
破裂预测可以更好的消除装置间诊断差距，但是依然依赖领域自适应算法去减小装
置间决策边界和数据分布差异对模型的影响。本章将首次将领域自适应算法应用于
跨装置破裂预测研究中，并针对破裂预测任务对领域自适应算法升级改造，使其更适
用于破裂预测任务。从而实现了比混合数据性能更好的跨装置破裂预测。本章还进一
步优化物理指导，不仅能提升领域自适应跨装置破裂预测的性能，还实现了零炮迁移
跨装置破裂预测模型，即不需要 EAST 数据用于训练的跨装置破裂预测模型。

4.1 EAST 托卡马克装置及其与 J-TEXT 装置差异介绍

   EAST (Experimental Advanced Superconducting Tokamak) 托卡马克是中国科学院
等离子体物理研究所在中国安徽省省会合肥市建设的世界第一个全超导磁体托卡马
克核聚变反应试验性装置，属于中国国家“九五”重大科学工程。装置外观如图 4-1
所示。EAST 托卡马克又被称为“人造太阳”、东方超环，是国际上稳态磁约束聚变
研究的重要实验平台，其研究成果将为未来国际热核聚变实验反应堆(ITER)实现稳
态高约束放电提供科学和工程实验支持。2006 年 9 月 28 日，该装置首次成功放电，
是全球首个投入运行的全超导非圆截面核聚变实验装置。EAST 大半径 R = 1.85 m，
小半径 a = 0.45 m。EAST 托卡马克主要运行在偏滤器位型下，等离子体截面为 D 形
截面，有金属壁环境。典型放电参数为 IP 约 450 kA ~ 1 MA、Bt 约 1.5 T ~ 3.5 T、常
规脉冲长度约为 10 s,并且可以达到 2.1 的 βN。

                               58
       华 中 科 技 大 学 博 士 学 位 论 文




                 图 4-1 EAST 托卡马克装置图

             表 4-1 J-TEXT 与 EAST 装置主要差异对比


                                       等离子体
  装置      截面形状    放电时长         壁条件                位型
                                            体积

 J-TEXT    圆形      百毫秒         石墨壁      1.35 m3   限制器

                                                  先进
  EAST     D形       千秒         金属壁      16 m3
                                                  偏滤器

  第 3 章中已经对 J-TEXT 装置及其诊断系统做出介绍，表 4-1 为 J-TEXT 与 EAST
装置的五种主要差异对比。设计与等离子体运行参数上的差异，将为破裂预测带来破
裂与非破裂决策边界的差异。除了装置设计与参数之间的巨大差异，J-TEXT 与 EAST
装置还在诊断设计与分布上有着较大的差异。例如图 4-2 中展示的 EAST 中(a) SXR
诊断分布与(b) AXUV 诊断分布无论从探测器位置，还是测量视角，以及空间分辨率
等都有较大的差异。如果直接使用原始诊断信号作为破裂预测模型的输入信号，则这


                          59
      华 中 科 技 大 学 博 士 学 位 论 文

种诊断造成的输入信号的差异，使得跨装置破裂预测几乎无法使用这类对等离子体
内部信息测量丰富的 1D 诊断信息。本文的 PGFE 算法可以很好的解决这些由诊断分
布导致的差异。




        图 4-2 EAST 装置(a) SXR 诊断阵列分布与(b) AXUV 诊断阵列分布


4.2 物理指导的领域自适应的跨装置破裂预测结构与训练

   领域自适应(Domain Adaptation, DA)是机器学习中的一项技术，通过将模型从一
个源领域（源装置）迁移到另一个相关但不同的目标领域（目标装置），以提高在新
领域中的表现。它利用各种方法来调整数据、特征或模型，使其能够更好地处理目标
领域的数据，即使这些数据的分布与源领域不同，尤其在目标领域数据有限的情况
下，显著提升模型性能。其中 CORrelation Alignment (CORAL) [121]是一种简单、广泛
使用且高效的 DA 方法，属于 DA 中的特征变换的方式，即通过变换特征使源领域
和目标领域的特征分布更接近。CORAL 通过对齐源域和目标域的二阶统计量来最小
化域漂移，而无需训练或调整任何超参数。CORAL 以“令人发指的简单”的方式对


                            60
      华 中 科 技 大 学 博 士 学 位 论 文

齐源域和目标域，更轻量且更具解释性。因此，在这项工作中，我们采用 CORAL 作
为跨托卡马克破裂预测方法的 DA 方法。本节将 PGFE 与 CORAL 结合建立了跨装
置破裂预测模型的结构，将 PGFE 针对 EAST 装置的诊断重新设计并应用于 EAST
数据，还将 CORAL 做了适用于破裂预测任务的改进。

4.2.1 模型结构

  该模型主要分为两步，第一步是对 J-TEXT 和 EAST 都做 PGFE，在提升 J-TEXT
源装置模型性能的同时也可以通过 PGFE 减少 J-TEXT 与 EAST 装置间的差异。第二
步通过领域自适应的方法对将 J-TEXT 与 EAST 经过 PGFE 后的特征分布更加接近，
进一步减少 J-TEXT 与 EAST 间数据差异对模型的影响。
  该模型的结构主要包括四个部分：特征提取器、领域自适应模块、破裂分类器和
解释器。与 IDP-PGFE 相比，增加了一个用于特征分布变换的领域自适应模块。如图
4-3 所示，第一步是使用 PGFE 对原始信号进行预处理，以提取与诊断无关且与破裂
相关的特征。然后，应用 CORAL 来对齐特征，将知识从目标域映射到源域。接下来，
将在映射后的数据上训练机器学习模型，DART。训练好的破裂预测器可以直接在目
标域中使用。最后，训练好的模型可以使用 SHAP 进行可解释性分析。




图 4-3 基于 DA 的跨装置破裂预测的结构。粉红色模块代表源域（现有）托卡马克装置，橙色
模块代表目标域（未来）托卡马克装置。蓝色模块是特征提取算法 PGFE。紫色模块是 DA 算
   法 CORAL。灰色模块是机器学习模型 DART。海螺色模块是可解释性模块 SHAP




                        61
      华 中 科 技 大 学 博 士 学 位 论 文

4.2.2 PGFE 提取 J-TEXT 与 EAST 共有物理特征

   DART 和 SHAP 在我们之前的工作中已经进行了广泛讨论。PGFE 的详细算法也
在之前的研究中介绍过。本工作将主要关注 PGFE 在 EAST 上的应用，并突出一些
差异。
   各个托卡马克装置的诊断系统是根据每个装置的工程和物理要求设计的。因此，
几乎不可能直接使用诊断信号进行跨装置的破裂预测。在之前的跨装置破裂预测研
究中，采用了不同的数据预处理方法，将不同托卡马克装置的诊断数据标准化为一致
的输入格式。在这项工作中，PGFE 作为特征提取器不仅提取与破裂相关的特征，同
时也标准化了输入格式。
   对 EAST 的破裂分类已进行了分析，并发现杂质辐射、密度限制、垂直位移事件
（Vertical Displacement Event, VDE）和磁流体不稳定性也是 EAST 破裂的主要原因。
因此，基于磁流体不稳定性、辐射、密度相关破裂和基本等离子体控制系统（Plasma
Control System, PCS）信号提取的物理引导特征，就像 IDP-PGFE 一样。由于 J-TEXT
和 EAST 的诊断系统不同，因此需要调整特征提取算法中的参数，或专门为 EAST 重
新设计算法。因此，PGFE 不是专门为某个特定托卡马克装置设计的算法。相反，有
必要为每个托卡马克装置设计独特的算法，以确保一致或类似的物理特征。J-TEXT
和 EAST 的特征列在表 4-2 J-TEXT 与 EAST 特征表中。
   与 MHD 不稳定性相关的特征已被证明对 J-TEXT 的破裂预测任务有显著贡献。
然而，由于基于 J-TEXT 的圆形截面假设，很难在 EAST 上提取 mode_number_m
（MNM）特征。在未来的研究中，如果能够获取到 EAST 整个截面的 Mirnov 数据，
那么可以设计新的算法来计算 EAST 的 MNM。辐射相关和密度相关特征主要由软 X
射线（SXR）、绝对极紫外线（AXUV）阵列和偏振仪-干涉仪阵列（J-TEXT 中的远
红外三波偏振仪-干涉仪，FIR 和 EAST 中的偏振仪-干涉仪，POINT）提供。从 J-TEXT
到 EAST 的跨装置破裂预测展示了 PGFE 处理阵列信号的优势。尽管 J-TEXT 和 EAST
的 SXR、AXUV 和偏振仪-干涉仪阵列通道数不同，但 PGFE 可以将它们转化为同一
组特征。额外提取了四个新特征，n = 1 phase, v_loop, Bt/IP, IP_diff。自然锁定后的相
位可能受到 J-TEXT 和 EAST 固有误差场差异的影响。因此，本工作中考虑了 n = 1


                            62
      华 中 科 技 大 学 博 士 学 位 论 文

phase，可以像 n = 1 amplitude 一样通过拟合四个锁定模式探测器来计算。由于 EAST
和 J-TEXT 的壁条件不同，因此很难仅使用 CIII 信号来单独评估杂质情况。因此，引
入了 v_loop 来反映总体杂质状况。Bt/IP 特征可以近似表示边界安全因子的信息，而
IP_diff 用于表示等离子体电流的变化。结果，J-TEXT 的 90 个诊断通道和 EAST 的
65 个诊断通道被提取为 25 个特征。所有特征的采样率为 1 kHz，与 EAST 等离子体
电流的采样率相同。

                 表 4-2 J-TEXT 与 EAST 特征表


  特征类型         诊断通道(J-TEXT/EAST)                  特征名称

                                                   Mir_abs
                极向 Mirnov 探针阵列                     Mir_fre

 MHD 不稳定                                          Mir_Vpp
   性相关       环向 Mirnov 探针阵列(2 道/2 道)       mode_number_n (MNN)
                                               n=1 amplitude
                 锁模探针 (4 道/4 道)
                                                n = 1 phase

                SXR 阵列(30 道/20 道)              SXRkurt (skew, var)
                 中心道 SXR 弦积分                       SXRcore
  辐射相关               CIII 辐射                         CIII
               AXUV 阵列(30 道/20 道)             AXUVkurt (skew, var)
                      环电压                           v_loop

               偏振仪阵列(17 道/11 道)               DENkurt (skew, var)
  密度相关
                  芯部弦积分密度                             ne0

                 纵场、等离子体电流                   Ip, Bt Bt/IP; Ip_diff
  控制信号
                  水平与垂直位移                            dz, dr

4.2.3 针对破裂预测任务优化的 CORAL

  领域自适应（DA）的目标是通过将从源域学习的知识转移到目标域来弥合源域
和目标域之间的差距。这种知识转移使模型能够很好地泛化，并在目标域上做出准确


                            63
       华 中 科 技 大 学 博 士 学 位 论 文

的预测，尽管存在差异。CORAL 是一种高效、轻量且更易解释的 DA 方法，通过对
齐源和目标分布的二阶统计量来最小化域偏移。CORAL 通过使用目标分布的协方差
对白化的源特征进行重新着色来对齐分布。它是一种涉及两个主要计算的简单且更
      （1）在每个域中计算协方差统计量；
易解释的方法：               （2）对源特征应用白化和重新着
色的线性变换。然后，可以训练转换后的源特征。接下来是 CORAL 实现的简要数学
推导和假设。
   假设源域数据为 DS，目标域数据为 DT, CS 和 CT 分别为源域与目标域的协方差矩
阵。线性变换 A 已经应用于原始源特征，且使用弗罗贝尼乌斯范数作为矩阵距离度
量。因此，源和目标特征的二阶统计量（协方差）之间的距离可以被最小化。
                                       2                                2
                  min CS ' − CT            = min AT Cs A − CT
                    A                  F        A                       F       (2-1)
其中 CS' 是转换后源特征的协方差。A 的最优解可通过推导表示为：
                                   1                           1
                 A* =（U S  +S 2 U S T )(U T [1:r ] T [1:r ] 2 U T [1:r ]T )
                                                                                (2-2)
其中, rCS 和 rCT 分别是 CS 和 CT 的秩。Σ为 CS 和 CT 经过奇异值分解（singular value
decomposition, SVD）后的特征值。因为 CS 和 CT 为对称矩阵，因此特征向量相同。
Σ+是Σ的摩尔-彭罗斯伪逆。
   图 4-4 作为一张示意图，展示了 CORAL 将如何在更高维度将 J-TEXT 与 EAST
数据变换到同一空间上。我们假设蓝色数据点与平面为 J-TEXT 数据及其所在平面，
红色数据点与平面为 EAST 数据及其所在平面。(a) 所示的 J-TEXT 与 EAST 数据，
分别对 J-TEXT 与 EAST 特征做 z-score 标准化后，会出现 J-TEXT 数据和 EAST 数
据分别在各自的平面，沿一条直线分布。这样的数据分布必然导致跨装置破裂预测的
性能差。CORAL 的做法分为两步，首先如(b)，将 J-TEXT 数据的协方差消除掉，称
之为“白化”；接着如(c)，将 EAST 数据的协方差信息映射到 J-TEXT 数据上，称为
“染色”，这样便实现了 J-TEXT 与 EAST 数据在同一平面上的对齐。(d) 展示了为
何 CORAL 没有将两个数据集同时“白化”后再混合，因为若不通过映射的“染色”
操作，两者依然无法对齐在同一平面（实际上高维数据空间，这里用平面示意）。



                                           64
      华 中 科 技 大 学 博 士 学 位 论 文




                 图 4-4 CORAL 数据空间变换示意图[121]

   CORAL 最初设计为一种无监督领域自适应（Unsupervised Domain Adaptation,
UDA）算法；然而，在跨装置破裂预测中，目标数据实际上是有标签的。因此，我们
将 CORAL 改进为一种监督领域自适应（Supervised Domain Adaptation, SDA）版本，
并在本工作中应用它。改进的思路类似于机器学习研究中设计 SDA 的方法，即在
CORAL 最小化不同域中协方差矩阵的距离时考虑标签信息。我们将 SDA 版本称为
监督 CORAL（Supervised CORAL, S-CORAL），UDA 版本称为无监督 CORAL
（Unsupervised CORAL, U-CORAL）。S-CORAL 和 U-CORAL 的流程图如图 4-5 所
示。U-CORAL 将整个目标数据的协方差着色到源数据上，因此不能有效地考虑来自
有标签数据的信息。这对于具有明确正负样本的破裂预测任务来说是一种浪费。S-
CORAL 可以通过在目标域和源域之间分别对齐破裂样本和非破裂样本，有效地考虑
来自有标签数据的信息。




                             65
      华 中 科 技 大 学 博 士 学 位 论 文




                图 4-5 S-CORAL 与 U-CORAL 示意图


4.3 物理指导的领域自适应跨装置破裂预测模型的性能及对比

4.3.1 J-TEXT 与 EAST 数据集与训练方法

  数据集及其划分与第 3 章类似。数据集的划分如表 4-3 所示，其中括号外的数
字代表选取的总放电炮数，括号内的数字代表其中破裂炮的放电数。选择了 1354 次
放电（188 次破裂）作为训练集。选择了 160 次放电（80 次破裂）作为验证集。选择
了 220 次放电（110 次破裂）作为测试集。对于 EAST，数据集及其划分与我们之前
的工作类似。训练集、验证集和测试集仍然是随机选择的。全 EAST 数据集模型选择
了 1896 次放电（355 次破裂）作为训练集，120 次放电（60 次破裂）作为验证集。
对于跨托卡马克模型，选择了 110 次放电（10 次破裂）作为训练集。为了进行公平
比较，选择了 360 次放电（180 次破裂）作为全 EAST 数据集模型和跨托卡马克模型
的测试集。
  接近电流猝灭（Current Quench, CQ）时间的破裂炮数据被视为破裂前兆数据，
并作为模型的正样本。所有在非破裂炮平顶期间的数据都是模型的负样本。破裂前兆
数据可以通过 CQ 时间之前的时间阈值确定。时间阈值可以根据统计分析手动选择，
要么对每次放电统一设定，要么针对每次放电分别设定。我们之前的工作采用了自动
方法来选择时间阈值，通过找到模型的最佳性能来确定。通过在 J-TEXT 中从 5 ms



                            66
      华 中 科 技 大 学 博 士 学 位 论 文

到 50 ms、在 EAST 中从 5 ms 到 500 ms 彻底扫描时间阈值，J-TEXT 的时间阈值被
选为 CQ 时间前的 25 ms，EAST 的时间阈值被选为 CQ 时间前的 125 ms。负样本（非
破裂样本）比正样本（破裂样本）多得多。大多数负样本属于稳定的等离子体放电，
因此更为相似，尤其是在长脉冲的 EAST 非破裂炮中。因此，为了平衡数据集，我们
随机丢弃了部分负样本，并增加了破裂样本的权重。

         表 4-3 物理指导的领域自适应跨装置破裂预测模型数据集分布

                               EAST                 EAST
             J-TEXT
                          (大量数据)                   (少量数据)

  训练炮数      1354 (188)    1896 (355)               110 (10)
  验证炮数       160 (80)      120 (60)                   /
  测试炮数       220 (110)                 360 (180)

  本章中，训练了五个模型。前两个模型是单一托卡马克完整数据装置的破裂预测
模型，不同于跨装置的破裂预测模型。J-TEXT 模型在源域中展示了性能，作为跨装
置模型的基础。EAST 模型使用表 4-3 中所示的 EAST 完整数据训练集进行训练，代
表性能的顶峰，这两个模型采用了图 3-10 的结构。第三个模型是混合数据模型，它
混合了中的 J-TEXT 训练集和 EAST 的跨装置训练集。混合数据模型也使用了图 3-10
的结构。最后两个模型是 CORAL 模型，它们使用了图 4-3 中的结构。在对整个数据
集应用 PGFE 之后，使用 CORAL 将表 4-3 中的 EAST 跨装置训练集与 J-TEXT 训练
集对齐。对于验证，我们专门使用 J-TEXT 验证集。一旦训练完成，我们将使用 EAST
测试集进行预测。最后，使用 SHAP 进行了彻底的分析，以了解模型学到了什么以
及如何改进跨装置破裂预测。
  本节展示了各种模型的预测性能。在 4.3.2 节中，将首先展示 J-TEXT 和 EAST
的面向单一装置完整数据装置模型作为跨装置的源域模型和基准模型。然后 4.3.3 节
将比较混合数据模型、U-CORAL 和 S-CORAL 在跨装置破裂预测中的表现。在本节
中，超参数搜索确定了每个最佳性能模型的超参数。
  破裂预测是一个二分类任务，其性能通常使用混淆矩阵来评估。然而，在破裂的



                          67
      华 中 科 技 大 学 博 士 学 位 论 文

背景下，真正阳性（TP）和假阴性（FN）有特定的定义方式。对于 J-TEXT，任何预
测的破裂，如果预警时间超过 10 ms，则被视为 TP（小于 10 ms 被视为 FN）。对于
EAST，任何预测的破裂，如果预警时间超过 30 ms，则被视为 TP（小于 30 ms 被视
为 FN）。对这两个托卡马克装置的标准化过程是独立进行的，采用 z-score 方法。值
得注意的是，在对 EAST 上的跨装置破裂预测进行标准化过程中，仅使用了 110 次
已知放电来计算标准化参数，旨在模拟实际应用场景。

4.3.2 J-TEXT 与 EAST 面向单一装置的破裂预测模型

   在这部分中，J-TEXT 和 EAST 的单一托卡马克完整数据装置模型使用完整的训
练集数据进行了训练，并在图 4-6 中展示了 ROC 曲线。黄色和橙色线分别代表 J-
TEXT 模型和 EAST 模型的 ROC 曲线。J-TEXT 模型的 AUC 值为 0.971，EAST 模型
的 AUC 值为 0.936。J-TEXT 模型的预测性能不如之前的 IDP-PGFE 模型，这是由于
缺少了一些特征。为了与 EAST 的采样率保持一致，J-TEXT 模型将每个样本视为 1
ms，而之前的 IDP-PGFE 模型将每个样本视为 0.1 ms，这也可能影响模型性能。




图 4-6 J-TEXT 和 EAST 单一托卡马克完整数据装置模型的 ROC 曲线。FPR 轴从 0%到 50%，
  TPR 轴从 50%到 100%。黄色和橙色线分别代表 J-TEXT 模型和 EAST 模型的 ROC 曲线


                            68
      华 中 科 技 大 学 博 士 学 位 论 文

   图 4-7 显示了以模型阈值为 J-TEXT 模型 0.56 和 EAST 模型 0.93 时，预测的破
裂累积百分比与预警时间的关系。对于 J-TEXT 模型，30 ms 的预警时间也应确保相
当数量的累积百分比（TPR>90%）的破裂被预测，以便其他缓解方法作出反应。对
于 EAST 模型，50 ms 的预警时间也应确保相当数量的累积百分比（TPR>90%）的破
裂被预测，以便其他缓解方法作出反应。因此，J-TEXT 和 EAST 单一托卡马克完整
数据装置模型的最终性能分别为 TPR = 93.64%，FPR = 8.18%，容忍度为 10 ms，以
及 TPR = 93.33%，FPR = 16.11%，容忍度为 30ms。J-TEXT 模型的平均和中位预警
时间均为 0.14 s，而 EAST 模型的平均预警时间为 1.34 s，中位预警时间为 0.75 s。
由于 EAST 存在长脉冲放电，平均预警时间可能受到显著影响。因此，中位值更好地
反映了 EAST 模型的整体预警时间。
   因此，通过考虑 J-TEXT 和 EAST 托卡马克装置共有的常见物理引导特征，PGFE
已经成功地为 J-TEXT 和 EAST 单一托卡马克完整数据装置模型实现了良好的性能。
这为接下来的跨装置工作提供了基础，作为模型和参考。

4.3.3 跨装置破裂预测模型性能对比

   在这部分中，描述并分析了从 J-TEXT 到 EAST 的跨装置破裂预测的三种模型，
其策略分别是混合数据、U-CORAL 和 S-CORAL。尽管 IDP-PGFE 具有使用有限数
据训练的能力，但在较小的数据集（如 J-TEXT 的 10 次破裂炮和 120 次非破裂炮）
上表现不佳。值得注意的是，即使在单个托卡马克装置的有限数据上训练，仍然需要
一定量的验证数据来防止过拟合并选择最佳模型。因此，使用有限数据进行训练的功
能不适用于像 EAST 的 10 次破裂炮和 100 次非破裂炮这样的场景。
   五种案例的模型，包括三个跨装置模型，在表 4-4 中展示。在'EAST 数据'列中，
数字代表'总放电次数（破裂炮次数）'。案例 1 的模型是跨装置破裂预测的基线模型，
直接在 J-TEXT 单一托卡马克完整数据装置模型上测试 EAST 数据，称为零次测试。
案例 2 的模型采用了将有限的 EAST 数据与 J-TEXT 数据混合以训练模型的策略。
这种策略也常用于跨装置破裂预测方法。案例 3 的模型直接使用 CORAL 将 EAST 数
据的知识映射到 J-TEXT 数据上进行训练。我们称此案例的数据策略为 CORAL，
CORAL 策略为无监督。案例 4 的模型使用 S-CORAL 将 EAST 数据中的破裂和非破

                          69
         华 中 科 技 大 学 博 士 学 位 论 文

裂数据分别映射到 J-TEXT 数据上，然后训练模型。我们也称此案例的数据策略为
CORAL，CORAL 策略为有监督。案例 5 的模型是 EAST 的单一托卡马克完整数据
装置模型，作为基准，意味着数据集的最高性能。




图 4-7 预测的破裂累积百分比与预警时间的关系。J-TEXT 模型的模型阈值为 0.56（黄色），
                     。红色虚线代表预测的破裂累积百分比等于 90%。浅蓝色
EAST 模型的模型阈值为 0.93（橙色）
虚线代表预警时间为 0.01 s（10 ms）、0.03 s（30 ms）、0.05 s（50ms）、0.3 s（300ms）和 1.5 s
                              （1500 ms）

                      表 4-4 跨装置破裂预测的五个模型

  案例编号          EAST 数据         数据策略          CORAL 策略         AUC
     1               0                 /           /           0.642
     2            110 (10)      混合数据               /           0.764
     3            110 (10)      CORAL          U-CORAL         0.797
     4            110 (10)      CORAL          S-CORAL         0.890
     5           1896 (355)     大量数据               /           0.936


                                  70
       华 中 科 技 大 学 博 士 学 位 论 文

   这五个模型的 ROC 曲线在图 4-8 中展示。浅蓝色线代表 J-TEXT 基准模型的
ROC 曲线，零炮迁移的 AUC 值为 0.642。黄色线代表混合数据模型的 ROC 曲线，
AUC 值为 0.764。绿色线代表 U-CORAL 模型的 ROC 曲线，AUC 值为 0.797。深蓝
色线代表 S-CORAL 模型的 ROC 曲线，AUC 值为 0.890。橙色线仍然代表 EAST 模
型，AUC 值为 0.936。与以往对跨装置破裂预测的研究类似，与直接零次测试相比，
混合数据模型确实提高了预测性能（AUC 值从 0.642 提高到 0.764）
                                      。然而，对于设
备和放电参数差异显著的跨装置破裂预测，如从 J-TEXT 到 EAST，混合数据模型的
性能仍然不可接受。U-CORAL 模型相比混合数据模型在预测性能上有所提高，但改
进并不显著（AUC 值从 0.764 提高到 0.797）。然而，S-CORAL 相比其他策略显著提
高了性能（AUC 值从 0.797 提高到 0.890），与 EAST 模型的性能差距更小。
   图 4-9 显示了预测的破裂累积百分比与预警时间的关系，EAST 模型的模型阈
值为 0.93，混合数据模型的模型阈值为 0.01，U-CORAL 模型的模型阈值为 0.31，S-
CORAL 模型的模型阈值为 0.58。EAST 测试集的预警时间选为 30ms。我们选择模型
阈值的原则是首先确保在此阈值下的 TPR 高于 90%。基于这一标准，我们进一步选
择了实现较低 FPR 的模型阈值。然而，对于混合数据模型，在模型阈值为 0.01 时，
最高 TPR 为 73.33%。因此，混合数据模型、U-CORAL 模型和 S-CORAL 模型的最
终性能分别为 TPR = 73.33%，FPR = 27.78%，TPR = 90.56%，FPR = 46.67%，TPR =
90%，FPR = 25.56%，容忍度为 30ms。混合数据模型的平均预警时间为 1.48 秒，中
位预警时间为 0.72 秒。U-CORAL 模型的平均预警时间为 1.85 秒，中位预警时间为
1.54 秒。S-CORAL 模型的平均预警时间为 1.43 秒，中位预警时间为 0.74 秒。除了
U-CORAL 模型外，其他两个模型的平均和中位预警时间与 EAST 模型相似。
   为了更好地反映破裂预测的实际情况，我们在所选阈值下将真实正例率（TPR）
和假正例率（FPR）划分为更详细的类别：成功预警率、延迟预警率、提前预警率、
漏报率和误报率，以更好地展示破裂预测的性能。在 JET 和 ASDEX-U 上的跨托卡
马克破裂预测中也提到了这些类别。对于 EAST，我们认为预警时间少于 30 毫秒应
视为延迟预警，预警时间超过 3 秒应视为提前预警。 如表 4-5 所示，与大量数据训
练模型相比，S-CORAL 模型的成功率、漏报率和误报率有所增加，成功率有所减少，


                               71
     华 中 科 技 大 学 博 士 学 位 论 文

而早报率保持不变。所有模型的早报率相似，这可能是由于测试集中某些放电具有较
早的破裂原因，导致提前预警。这需要在未来进行更详细的可解释性研究。




图 4-8 五个案例模型的 ROC 曲线。五种颜色的线分别代表五个案例的模型（案例 1 - 浅蓝
      色，案例 2 - 黄色，案例 3 - 绿色，案例 4 - 深蓝色，案例 5 - 橙色）

                  表 4-5 破裂预测的细节评估表


模型特点      成功率     晚报率          早报率     漏报率          误报率


大量数据      80%      5%          13.3%   1.67%        16.11%


混合数据      56.7%    10%         16.7%   16.7%        27.78%


U-CORAL   68.9%    4.4%        21.7%    5%          46.7%


S-CORAL   76.7%    5.6%        13.3%   4.4%         25.56%



                          72
      华 中 科 技 大 学 博 士 学 位 论 文

  可以得出结论，CORAL 的应用在跨装置破裂预测中优于以前广泛使用的混合数
据方法。S-CORAL 模型进一步提高了跨装置破裂预测的性能，实现了 TPR 为 90%，
FPR 为 25.56%，AUC 值为 0.89。这一性能接近于使用完整数据训练的 EAST 单一托
卡马克完整数据装置模型。因此，在性能方面，基于 DA 的跨装置破裂预测是实现未
来托卡马克装置跨装置破裂预测的一种有竞争力的方法。




图 4-9 预测的破裂累积百分比与预警时间的关系。EAST 单一托卡马克完整数据装置模型的模
型阈值为 0.93（橙色），混合数据模型的模型阈值为 0.01（黄色），U-CORAL 模型的模型阈值
                                     。红色虚线代表 90%预测准确率
为 0.31（绿色）和 S-CORAL 模型的模型阈值为 0.58（深蓝色）

  我们进一步研究了在数据量较小时（主要是破裂放电的次数），S-CORAL 的性能
表现。我们使用 1 次、3 次、5 次和 8 次破裂放电重新训练了 S-CORAL 模型（与 10
次破裂放电相同比例的非破裂放电配对），并获得了如图 4-10 所示的各个模型的
ROC 曲线，以及如图 4-11 所示的 AUC 值随破裂放电次数变化的曲线。不幸的是，
当仅使用一次破裂放电作为训练数据时，S-CORAL 的 AUC 值仅为 0.726。当破裂放



                         73
       华 中 科 技 大 学 博 士 学 位 论 文

电次数少于五次时，随着破裂放电次数的增加，S-CORAL 的性能显著提高。然而，
一旦破裂放电次数超过五次，这种性能提升就会放缓。对于在新托卡马克上进行破裂
预测，可能有必要在初期有意设计一些危害较小的破裂放电场景，以覆盖更广泛的破
裂类型。




图 4-10 使用不同数量的破裂放电时模型的 ROC 曲线。深红色、绿色、藏青色、黄色、橙色和
          浅蓝色线分别表示使用 10、8、5、3、1 和 0 个破裂放电


4.4 优化物理指导的领域自适应跨装置破裂预测

  上一节基于改进的领域自适应算法 S-CORAL，仅使用 EAST 装置放电数据中的
100 炮非破裂炮放电以及 10 炮破裂炮放电，实现了 AUC = 0.89 的性能，并可以做到
在提前 30 ms 的预测要求下达到 TPR = 90%，FPR = 25.56%的预测性能。然而，未来
ITER 及反应堆可能依然难以承受 10 次以上的破裂炮，并难以保证能积累 100 炮非
破裂炮时不造成更多的破裂炮。因此，还需要继续研究如何使用更少的放电数据实现
新装置的破裂预测。本节将探讨进一步优化物理指导在跨装置破裂预测研究中的作


                         74
       华 中 科 技 大 学 博 士 学 位 论 文

用。本节首先介绍两种优化物理指导的方法，分别为优化的物理指导特征提取（PGFE-
Upgrade, PGFE-U）以及提高数据标注质量采用的准确度更高的标签策略(Floating
Labeling Strategy, FLS)；并分析使用了这两种优化物理指导的方法后对领域自适应跨
装置破裂预测的性能影响。




              图 4-11 S-CORAL 的 AUC 值与破裂放电数量的关系

4.4.1 优化的物理指导特征提取

   第 3 章中详细介绍了 PGFE 的设计思路与计算方式，并在第 4 章中也应用于
EAST 托卡马克装置。但是在第 4 章中，由于诊断分布差异，例如极向 Mirnov 阵列，
导致部分特征无法通过 PGFE 提取。利用领域自适应是一种从数据驱动的角度对齐
特征分布差异的办法，若是想减少对数据的需求，如实现零炮迁移的跨装置破裂预
测，则需要考虑更多物理指导的方式，因此本节对 PGFE 做了优化与升级，称之为
PGFE-Upgrade，即 PGFE-U。
   第 3 章中介绍了基于互功率谱的方式得到 MHD 不稳定性的极向模数，但是该



                             75
      华 中 科 技 大 学 博 士 学 位 论 文

方法不适用于非圆截面的 EAST 托卡马克。因此，本章采用了奇异值分解（singular
value decomposition, SVD）的方法代替互功率谱实现非圆截面下的 MHD 不稳定性的
极向模数提取。
   SVD 是线性代数中一种重要的矩阵分解，多用于数据降维、特征提取、噪声过
滤、推荐系统等多个领域。它的基本思想是将一个矩阵分解成三个矩阵的乘积，从而
能够更好地理解和表示原始矩阵的结构和特征。假设存在一个矩阵 A, SVD 可以将 A
分解为以下三个矩阵的乘积：

                       A= U V T                    (4-1)
其中 U 是一个正交矩阵，包含了原始矩阵 A 的左奇异向量（left singular vectors），Σ
是一个对角矩阵，包含了奇异值（singular values），表示了矩阵 A 的特征值，VT 是另
一个正交矩阵的转置，包含了原始矩阵 A 的右奇异向量（right singular vectors）。在
提取极向模数中，矩阵 A 是一个由[time_dim, channel_dim]构成的矩阵，第一个维度
为各 Mirnov 探针的时间序列，第二个维度为 Mirnov 探针在整个极向截面的分布通
道。U 反应了每个 Mirnov 探针测量到的时间序列信息，而 VT 反应了 Mirnov 探针阵
列所测量到的空间信息，Σ 则代表了 Mirnov 探针阵列测量到的不同模式的幅度。在
J-TEXT 与 EAST 中，2/1、3/2 以及 3/1 模主要可能导致破裂的发生，因此使用 SVD
分解也仅需关注最大的 3 个模式（后续的模式基本为噪声）。
   使用 SVD 进行 MHD 不稳定性相关特征的提取相比于第 3 章中基于互功率谱的
方式，有更高的鲁棒性，且适用场景更加宽泛，不局限于两个相邻足够近的 Mirnov
探针的假设。并且即使某一个 Mirnov 探针损坏，只要能保证整个极向截面 360°布有
磁探针，则对最终结果影响较小。
   阵列特征的提取也需要进一步的优化，虽然第 3 章中对阵列信号提取了方差、
偏度与峰度等高阶统计量，可以一定程度上减少因诊断丢失与装置参数差异带来的
差别，但是不同托卡马克诊断视野的差异仍然难以消除。本节通过对齐 J-TEXT 与
EAST 装置 SXR 与 AXUV 辐射弦心距的方式，进行阵列特征的优化。
   考虑到 J-TEXT 装置 AXUV 诊断要与 EAST 装置 PXUV 诊断视野对齐，原本
IDP-PGFE 选取的 AXUV_CA 以及 AXUV_CF 阵列，若想更好的减少 J-TEXT 与 EAST


                           76
     华 中 科 技 大 学 博 士 学 位 论 文

装置数据间的差距，需要更换为 AXUV_CB 与 AXUV_CE 阵列。选取通道时，我们
将 AXUV（PXUV）阵列以 0.7a 为分界（通常 2/1 附近），划分出两个区域，并用 0.7a
以内的均值除以 0.7a 以外的均值，得到 XUV_ratio 特征，以表征 AXUV 阵列特征所
提取的具有一定空间分辨能力的特征。同时，还提取了 0.7a 以内的 SXR 阵列均值，
以表征内部的 SXR 辐射信息。

           表 4-6 PGFE-U 提取的 J-TEXT 和 EAST 所有特征说明

          诊断通道                             特征名称

                                            Mir_abs

                                            Mir_fre
      极向 Mirnov 探针阵列
                                           Mir_Vpp

                                        mode_number_m

      环向 Mirnov 探针阵列                    mode_number_n

          锁模探针                           n=1 amplitude

                                   SXR_array_kurt (skew, var)
         SXR 阵列
                                          SXR_mean

          CIII 辐射                             CIII

                                   XUV_array_kurt (skew, var)
         AXUV 阵列
                                          XUV_ratio

       芯部弦积分密度                               ne0/nG

                                             Bt, Ip
      纵场、等离子体电流
                                           qa_proxy

          环电压                               V_loop

     环电压、等离子体电流                             Z_proxy

       水平与垂直位移                             dr/a, dz/a



                            77
      华 中 科 技 大 学 博 士 学 位 论 文

  部分特征还进行了无量纲化处理，如将芯部弦平均密度通过 Greenwald 密度极
限定标关系处理为 ne/nG 的无量纲特征。使用环电压除以等离子体电流代理整体电阻
的信息 Z_proxy。同时将水平与垂直位移除以小半径以归一化等离子体位移的程度。
优化后的所有特征如表 4-6 所示。

4.4.2 根据实际放电提高数据标注质量

  目前破裂预测的研究对于数据打标签的方式多采用统一阈值的方式，即对破裂
炮的破裂前 X 时刻的样本标记为破裂前兆样本（正样本），对非破裂炮整体标记为非
破裂样本（负样本）。第 3 章中的 IDP-PGFE 以及第五章中的基于领域自适应的跨装
置破裂预测分别对 J-TEXT 与 EAST 标注破裂前兆的阈值为破裂前 25 ms 以及破裂
前 125 ms，该阈值的确定是通过对超参数扫描确定的，是固定阈值打标签方式的最
好结果。由于每一炮的破裂类型，破裂原因，以及不稳定性出现的时刻均不同。在监
督学习中，越准确的标签越能提升模型学习到正确知识的能力。之前的模型中，由于
固定阈值并不能保证在阈值之前的时刻不存在破裂前兆，因此，并未使用破裂炮中的
非破裂样本。若能对每一炮破裂前兆都单独标记破裂以及非破裂样本，可以更好的利
用已有数据，减少跨装置迁移时的训练炮数，增加源域训练集中破裂炮的非破裂样
本，并且能提升模型性能。但是面对大量托卡马克放电数据时，人工标注成本过高，
难 以 通过 人工 方式 标注 出 每一 炮不 同 的 样本 。 本团 队通 过一 种基 于 异常 检 测
（Anomaly Detection）的破裂预测方式[122]，可以无需人工标注得到破裂前兆标签。
并通过与人工标注比对，证明了异常检测也可以得到质量更高的标注数据，甚至有时
候人工无法识别的，异常检测也可以识别。但是对于新装置，少量数据无法训练得到
异常检测模型，因此只能用高成本的方式人工标注。
  异常检测是机器学习和统计分析中的一种重要任务，旨在识别数据集中的异常
或罕见事件，这些事件与正常数据模式明显不同。异常通常被称为离群点、异常点、
异常值或奇异点。异常检测的目标是找到那些与大多数数据不同或具有不寻常特征
的数据点。异常检测通过仅训练非破裂样本，在测试和推理时破裂样本便会被识别为
异常值，属于一种无监督的学习方式。一炮中，若出现偏离非破裂炮（正常样本）的
情况，便认为是出现了破裂前兆。基于此，便实现了对大量数据的自动破裂前兆标签

                         78
      华 中 科 技 大 学 博 士 学 位 论 文

识别。我们基于深度自编码器（Autoencoder，AE）、一类支持向量机（One-Class Support
Vector Machine，OCSVM）、K 临近异常检测（K-Nearest Neighbor，KNN）、基于角
度异常检测（Angle-Based Outlier Detection，ABOD）分别构建了异常检测模型用于
论证多种算法的结果一致性。结果表明，无论是哪一种异常检测模型得到的破裂前兆
时刻，误差基本分布在 0 附近。




图 4-12 两种模型的 ROC 曲线，橙色线表示通过固定标签策略训练的 IDP-PGFE。绿线代表通
                       过 FLS 训练的模型

   异常检测对每一炮破裂炮得到破裂前兆标签后，破裂炮之前的非破裂样本也可
以得以使用。考虑到异常检测得到的破裂前兆标签存在一定的误差，我们将 J-TEXT
破裂标签的前 50 ms 和 EAST 破裂标签的前 200 ms 的样本视为“灰色样本”，即既不
属于非破裂样本也不属于破裂样本的“缓冲地带”。这种破裂与非破裂样本的标记方
法被我们称为“准确度更高的标签策略(FLS)”将 FLS 应用于 IDP-PGFE，得到了更
优化的结果。如图 4-12 所示，虽然在总体 AUC 上，FLS 模型并未有性能提升，但
是在对破裂预测更重要的 TPR > 90%, FPR < 10%的区间中，FLS 模型的性能均好于
固定标签策略的 IDP-PGFE 模型。可以通过阈值选择获得 TPR = 98.2%，FPR = 2.7%



                            79
      华 中 科 技 大 学 博 士 学 位 论 文

的最好性能，固定标签的 IDP-PGFE 模型在 TPR = 98.2%时 FPR 为 7.2%。由此可见，
利用该方法相比于一刀切的固定阈值打标签方式，不仅可以将破裂炮的非破裂样本
得以使用，还可以获得更准确的非破裂以及破裂样本，从而提升源域的性能并使模型
学习到的破裂知识更加准确。

4.4.3 优化物理指导后对模型性能的影响

  本节使用的数据与 4.3 节中类似，由于 FLS 允许使用破裂炮中的非破裂样本进
行训练，因此本节中仅选用了 10 炮 EAST 破裂炮作为跨装置模型目标装置的训练数
据，具体数据分布如表 4-7 所示。本节训练了 3 个破裂预测模型，分别为使用上述
两种优化物理指导后的 EAST 面向单一装置的破裂预测模型，模型结构为图 3-10；
使用上述两种优化物理指导后的领域自适应跨装置破裂预测模型，模型结构为图 4-3；
与用于对比的，仅用 10 炮 EAST 破裂炮训练的面向单一装置的破裂预测模型，模型
结构为图 3-10。

             表 4-7 优化物理指导的跨装置破裂预测模型数据分布

                               EAST                 EAST
              J-TEXT
                          (大量数据)                   (少量数据)

  训练炮数       1354 (188)   1896 (355)                10 (10)
  验证炮数        160 (80)     120 (60)                    /
  测试炮数        220 (110)                360 (180)


  由于 4.3 节中已经证明了 S-CORAL 策略可以实现性能最好的跨装置破裂预测模
型，因此本节中仅训练了 S-CORAL 策略的模型，并将 4.3 节中 EAST 装置大量数据
训练模型与 S-COARL 模型的性能与本节使用了两种优化物理指导的性能进行对比。
图 4-13 为这些案例的 ROC 曲线。案例 1 与案例 2 为 4.3 节中的结果，分别为 4.3 节
中的 EAST 大量数据训练的面向单一装置的破裂预测模型性能，以及使用 100 炮非
破裂炮与 10 炮破裂炮的领域自适应跨装置破裂预测模型性能。案例 3 相比于案例 1
为优化物理指导后面向 EAST 单一装置破裂预测模型的性能提升，性能从 AUC 为



                          80
       华 中 科 技 大 学 博 士 学 位 论 文

0.936 提升至 0.974，提升了 4.1%。这体现了优化物理指导后可以提升大量数据训练
的面向单一装置的破裂预测性能，将 EAST 模型的基线性能提高。案例 4 相比于案
例 2 为优化物理指导后跨装置模型的性能提升，在仅使用炮 EAST 破裂放电而无需
非破裂放电训练的情况下，性能从 AUC 为 0.890 提升至 0.947，提升了 6.4%。这体
现了优化物理指导后可以用更少的目标装置训练数据达到更高的预测性能。

           表 4-8 优化物理指导的跨装置破裂预测模型性能对比

 案例编号   J-TEXT 数据     EAST 数据           PGFE-U   FLS   AUC

   1         0        1896 (355)          N      N     0.936
   2     1354 (188)    110 (10)           N      N     0.890
   3         0        1896 (355)          Y      Y     0.974
   4     1354 (188)    10 (10)            Y      Y     0.947
   5         0         10 (10)            Y      N     0.753




         图 4-13 优化物理指导的跨装置破裂预测模型性能对比 ROC



                                   81
       华 中 科 技 大 学 博 士 学 位 论 文

   案例 5 为仅使用 10 炮 EAST 破裂炮训练的面向单一装置的破裂预测模型性能，
体现了即使依靠上述两种优化物理指导的方法，仅用 10 炮 EAST 破裂炮依然无法得
到性能较好的破裂预测模型，证明现有托卡马克的数据与内在知识，对跨装置破裂预
测有着巨大的帮助。综上，利用上述两种优化物理指导的方法后，可以仅使用 10 炮
EAST 破裂炮（与基线模型相比 0.5%）的数据，即可实现 AUC 为基线模型 97.2%的
跨装置破裂预测性能。

4.5 优化物理指导实现零炮迁移跨装置破裂预测模型

   上一节通过进一步优化物理指导仅使用 10 炮 EAST 训练便实现了 AUC 为 0.947
的跨装置破裂预测性能。本节又增加了一种优化物理指导的方法，即估计标准化参数
(Estimation of the Feature Distribution, EFD)实现了无需任何 EAST 数据训练的零炮迁
移模型。

4.5.1 估计标准化参数

   估计标准化参数 EFD 这一优化物理指导的方法主要目的是实现零炮迁移的跨装
置破裂预测模型。3.3.2 节中介绍了 z-score 的数据标准化预处理方式，通过标准化，
特征值被转换为零均值和单位标准差，这有助于消除特征量纲差异对模型训练的影
响。公式（3-10）表明了标准化参数主要为各特征数据分布的均值 μ 与标准差 σ。在
训练时，J-TEXT 数据使用的是 J-TEXT 各特征分布的均值 μJ 与标准差 σJ 进行标准化
处理，EAST 数据使用的是用于训练的 EAST 数据分布得到均值 μE 与标准差 σE 进行
标准化处理。本章 4.3 与 4.4 节中在对 EAST 数据做跨装置模型推理预测时，也均使
用的是用于训练的 EAST 数据分布得到均值 μE 与标准差 σE。因此，零炮迁移模型由
于无需 EAST 数据训练，无法得到标准化参数，这会对模型推理预测结果造成巨大
的影响。所以需要估计标准化参数实现零炮迁移的跨装置破裂预测模型。
   理想情况下，在未来聚变堆放电参数和诊断设置稳定，通过使用托卡马克的设计
参数和诊断设置，可以大致估算出放电期间目标域上该特征的均值和标准差。随着聚
变领域其他研究的深入，还可以根据数值模拟、全数字托卡马克、数字孪生或合成诊
断，找出源域和目标域之间特征的平均值和标准差的比值，来实现估计标准化参数。


                                82
     华 中 科 技 大 学 博 士 学 位 论 文

由于 EAST 装置并非聚变堆这种长期稳定在类似放电区间且诊断不做大幅改动的托
卡马克，也有许多物理实验。因此本工作在已知 EAST 数据情况下，使用了 EAST 的
10 炮破裂炮来计算均值和标准差，但并未将这些数据用于模型的训练。第 5 章中将
对该方法做敏感性分析的可解释性研究，以验证模型性能对均值与标准差的估计波
动值敏感性较低，是鲁棒性较高的优化物理指导方法，可以用于未来装置。

4.5.2 零炮迁移模型的跨装置破裂预测模型

  零炮迁移模型的跨装置破裂预测模型的训练与推理如图 4-14 所示。训练阶段仅
使用 J-TEXT 原始诊断数据，通过 PGFE-U 与 FLS 这两种优化物理指导的方法训练
出泛化能力强的破裂预测模型。测试阶段将 EAST 原始诊断数据经过 PGFE-U 处理
后，在经过 EFD 处理后送入训练好的 J-TEXT 机器学习破裂预测模型，实现零炮迁
移的跨装置破裂预测。零炮迁移模型的跨装置破裂预测模型使用的数据分布与表 4-7
中数据相同。训练集与验证集数据均为 J-TEXT 数据，仅测试数据为 EAST 数据。模
型在 J-TEXT 数据上训练以及验证完成后，直接应用于 EAST 数据中实现零炮迁移。




            图 4-14 零炮迁移模型训练与测试结构与流程

  上一节中优化物理指导的基线模型与领域自适应模型体现了 PGFE-U 与 FLS 这
两种优化物理指导对跨装置破裂预测模型的作用。本节的零炮迁移模型在上一节的
基础上又加入了 EFD 这一优化物理指导的方法得以实现。三种模型的性能在表 4-9



                       83
        华 中 科 技 大 学 博 士 学 位 论 文

中展示。案例 1 为优化物理指导的 EAST 基线模型性能、案例 2 为优化物理指导的
领域自适应模型和案例 3 为优化物理指导的零炮迁移模型。三种案例的 ROC 曲线如
  图 4-15 所示。




                                  。绿线代表案例 2（领域自适应
图 4-15 三种案例的 ROC 曲线。黑色线表示案例 1（基线模型）
                 。暗橙色线代表案例 3（零炮迁移模型）
               模型）

                表 4-9 优化物理指导后各模型性能对比

  案例序号         EAST 数据          模型         AUC

    1          完整数据            基线模型        0.974
    2          10 破裂炮         领域自适应模型      0.947
    3             0           零炮迁移模型       0.892


  零炮迁移模型无需任何 EAST 数据训练，即可实现 AUC 为 0.892（91.6%基线模
型性能）的跨装置破裂预测性能。下一代托卡马克装置如 ITER 所需的要求为 TPR >
95%且 FPR < 5%的破裂预测性能 [24]。而本章无论是领域自适应还是零炮迁移的跨


                         84
          华 中 科 技 大 学 博 士 学 位 论 文

装置破裂预测模型虽然相比于之前的方案都有明显的性能提升，但是距离跨装置破
裂预测的需求仍旧有非常大的提升空间。表 4-10 给出了本文工作与国际其他先进破
裂预测模型性能对比，可以看出本工作采用了最少量的目标域装置数据实现了并不
输于国际领先水平的跨装置破裂预测性能。

           表 4-10 本工作提出的模型与国际其他先进破裂预测模型性能对比


                         目标域      目标域                          训练数
                                              跨装置
                         装置大      装置少                 目标域      据与基
目标域                                           与基线
              模型         量数据      量数据                 装置所      线模型
 装置                                           模型性
                         训练           训练              需数据      所需数
                                              能比例
                         AUC          AUC                      据之比

                                                      20 破裂
 EAST         HDL        0.973        0.959   98.6%   +5995    72.5%
                                                      非破裂

                                                      1134 破
HL-2A     1.5DCNN+LSTM   0.979          /       /     裂+3157     /
                                                      非破裂

                                                      20 破裂
C-MOD         HDL        0.801        0.728   90.9%   +2651    79.9%
                                                      非破裂

                                                      20 破裂
 DIII-D       HDL        0.945        0.873   92.4%   +4554    86.5%
                                                      非破裂

                                                      5 破裂
  JET        FRNN        0.952        0.911   95.7%   +16 非    0.6%
                                                       破裂




                                 85
         华 中 科 技 大 学 博 士 学 位 论 文

         续表 4-11 本工作提出的模型与国际其他先进破裂预测模型性能对比


                      目标域      目标域                          训练数
                                           跨装置
                      装置大      装置少                 目标域      据与基
目标域                                        与基线
             模型       量数据      量数据                 装置所      线模型
 装置                                        模型性
                      训练           训练              需数据      所需数
                                           能比例
                      AUC          AUC                      据之比

                                                   20 破裂
J-TEXT     IDP-PGFE   0.987        0.939   95.2%   +120 非   10%
                                                    破裂

          优化物理指导+
                                   0.947   97.2%   10 破裂    0.5%
 EAST      S-CORAL    0.974

           零炮迁移                    0.892   91.6%    0炮      0%



4.6 本章小结

  本章介绍了基于物理指导与领域自适应算法的跨装置破裂预测模型。本章首先
详细介绍了本工作的两个主要数据来源的装置 J-TEXT 与 EAST，当托卡马克之间存
在显著的大小、操作模式甚至配置上的差异时，将现有的托卡马克破裂预测器转移到
未来的托卡马克时会遇到问题。本章将 J-TEXT 作为源装置，EAST 作为目标域装置
用以模拟将现有装置破裂预测模型迁移到未来装置的情况。通过领域自适应算法，在
上一章的物理指导特征提取基础上，进一步减少装置间差异，从而实现将破裂预测模
型从源域装置迁移到目标域装置的跨装置破裂预测模型。通过优化物理指导的三种
方法更好的减少了装置间数据差异对模型的影响，提高数据的质量，进而实现了零炮
迁移的跨装置破裂预测模型。表 4-12 宏观的列举了本章中所用方法及其对跨装置破
裂预测的作用。
  首先使用来自 EAST 的大量数据，它已经实现了高性能的 EAST 单一托卡马克



                              86
      华 中 科 技 大 学 博 士 学 位 论 文

完整数据模型（AUC = 0.936，TPR = 93.33%，FPR = 16.11%）。这证明了 PGFE 具有
转移到其他托卡马克的适应性。物理指导的领域自适应的跨装置破裂预测通过 PGFE
与改进的 CORAL 算法，S-CORAL 相比于混合数据方法提高了 17%的预测性能。进
一步优化物理指导后，使 EAST 装置大量数据模型提升 4.1%的性能；在 S-CORAL
领域自适应模型的框架上，提升 6.4%的性能，并实现了 J-TEXT 到 EAST 装置零炮
迁移的跨装置破裂预测。领域自适应模型仅需与基线模型相比 0.5%的目标域装置训
练数据，达到基线模型 AUC 的 97.2%。零炮迁移模型无需目标域装置训练数据，达
到基线模型 AUC 的 91.6%。

            表 4-12 本章中所用方法及其对跨装置破裂预测的作用


                 方法                    跨装置破裂预测的作用

                                       将诊断信号统一为基于物
        物理指导的特征提取算法 PGFE
                                         理特征的输入信号

                                       少量 EAST 数据训练实现
       改进的领域自适应算法 S-CORAL
                                       初步跨装置破裂预测模型

                   优化的物理指导特征提取         更少的训练数据训练出性
                         PGFE-U
                                       能更好的跨装置破裂预测

                      提高数据质量 FLS              模型
    优化物理指导
                                       实现无需 EAST 数据训练
                      估计标准化参数 EFD      的零炮迁移跨装置破裂预
                                             测模型




                            87
     华 中 科 技 大 学 博 士 学 位 论 文


             5   破裂预测的可解释性研究

  目前的破裂预测多使用了数据驱动的机器学习算法，这种算法建立的模型经常
被称为“黑箱”模型，不具有可解释性。本章将介绍第 3 章提到的 IDP-PGFE 模型以
及第 4 章基于领域自适应算法的跨装置破裂预测模型的可解释性研究。前文的章节
中均提到了在模型设计的过程中，考虑到了如何实现模型可解释性的设计。本章将首
先对 J-TEXT 模型的全局可解释性进行研究，研究模型学习到了什么样的破裂规律，
以验证基于托卡马克物理特征的破裂预测模型拥有学习破裂规律的能力，且能学习
到正确的破裂规律；之后进一步对 J-TEXT 物理实验研究中一炮内随时间演化的破裂
预测做局部可解释性研究，发现了可解释破裂预测模型不仅可以预测破裂，还可以辅
助托卡马克物理实验，启发新物理机理的分析；最后对跨装置破裂预测模型的可解释
性进行研究，分别从数据分布和 SHAP 可解释性证明了为什么 S-CORAL 能获得最
好的模型预测性能。还对零炮迁移模型中 EFD 的敏感性做可解释性研究，验证了 EFD
方法具有较高的鲁棒性。

5.1 J-TEXT 破裂预测模型的全局可解释性研究

  IDP-PGFE 的出色表现可以在一定程度上反映出 IDP-PGFE 已经学到了与 J-
TEXT 破裂有关的足够正确的知识。更进一步，通过已有的对破裂的理解，结合解释
器给出的贡献度，也可以分析模型是否学习到了真正的破裂相关知识，而非信息泄露
导致的高预测性能。本节先对 PGFE 提取的四类破裂相关特征均做了贡献分析；接
着着重介绍了 J-TEXT 模型学习到 Greenwald 密度极限定标关系的研究。

5.1.1 物理特征对破裂贡献度分析

  图 5-1 显示了不同特征的 SHAP 值以及它们与特征值的关系，其中纵轴为提取
的物理特征，横轴为各特征对破裂（正值）与非破裂（负值）的贡献度，颜色代表特
征的幅值（红高蓝低），线长代表贡献度大小，线宽代表数据的聚集程度。特征的排
序代表特征重要性其主要取决于数据分布，而特征大小对破裂的贡献反应破裂规律，


                       88
      华 中 科 技 大 学 博 士 学 位 论 文

这是更加重要的。贡献度最大的特征是 Mirnov 探针的频率 Mir_fre，其反映了 MHD
不稳定性的频率。Mir_fre 的值更低可能对“破裂”和“非破裂”都有贡献。这是因
为较低的 Mir_fre 可能是两种情况，分别为没有 MHD 不稳定性与即将发生锁模。如
果 Mirnov 探针的频率减慢，这便是锁模的过程，则贡献为“破裂”。否则，如果 Mirnov
探针的频率始终为 0 左右，则没有测量到 MHD 不稳定性，则贡献为“非破裂”。
Mir_fre 的值越高对“非破裂”的贡献越大，这意味着高速旋转的模式不是破裂的直
接原因。这两种情况可以通过排名第三贡献的特征，即 Mirnov 探针的强度 Mir_abs
来区分。Mir_abs 的值更低对“非破裂”的贡献更大，这便代表没有 MHD 不稳定性
的情况。J-TEXT 是一个中等尺寸的托卡马克，锁模破裂的时间尺度相对较小，时常
锁模后立马发生破裂，第 3 章中所示的典型放电也证明了此现象。因此，n = 1
amplitude 不是一个有效的时间敏感的破裂前兆。故而，n = 1 amplitude 是排名第 24
位的贡献特征，数值越高对“破裂”贡献越大。MNM 是排名第 6 的贡献特征，MNN
是排名第 7 的贡献特征。MNM 的较高值（m ≥ 2）对“破裂”和“非破裂”都有较
大贡献。对“破裂”贡献较大的情况可能与 m/n = 2/1（TM）和耦合磁岛重叠的增长
有关。对“非破裂”贡献较大的情况则与边界磁岛有关，高 m 的边界磁岛甚至可以
改善等离子体约束。
   排名第二的贡献特征是 SXRskew，更低的 SXRskew 值对 “破裂”的贡献更大。然
而较低的 SXRskew 并不意味着软 X 射线辐射高本身强度的高低。图 5-2 展示了 SXRskew
的 SHAP 值与 SXRskew 和 SXRcore 值的关系。该图显示，只有较低的 SXRcore 和较低的
SXRskew 共同出现时对“破裂”贡献较大，这反映了软 X 射线辐射的普遍下降。排名
第 15 位的贡献特征是 SXRvar，SXRvar 的数值越高，代表剖面越峰化，对“破裂”的
贡献越大，这通常是密度极限的破裂前兆。排在第 9 位的贡献特征是 AXUVkurt，
AXUVkurt 的值越低代表剖面越陡峭，对“破裂”的贡献越大。较陡峭的剖面通常代表
更大的梯度。排名第 20 位的贡献特征是 P_rad，P_rad 的值越高，代表等离子体辐
射能量的损失越大，对“破裂”的贡献越大。




                           89
      华 中 科 技 大 学 博 士 学 位 论 文




图 5-1 不同特征的 SHAP 值以及它们与特征值的关系。特征的顺序代表特征的贡献。颜色图表
示每个特征的特征值，红色表示高，蓝色表示低。正的 SHAP 值代表对模型的 “破裂”影响，
              而负的 SHAP 值代表对模型的“非破裂”影响

 与密度有关的特征将非常直观。在密度相关特征中，贡献最大的特征是 ne0，是排
名第八的贡献特征。ne0 的数值越高，代表密度极限破裂的可能性越高。无论 FIRvar、
FIRskew 和 FIRkurt 如何贡献，都会因密度极限而导致最终破裂。较高的 FIRvar 值和较



                         90
       华 中 科 技 大 学 博 士 学 位 论 文

低的 FIRskew 值对“破裂”的贡献更大。这可以提供关于密度极限破裂的更详细的信
息，即更大的密度曲线峰化和更广泛的等离子体密度增加。




图 5-2 SXRskew 的 SHAP 值相对于 SXRskew 和 SXRcore 的值。X 轴表示 SXRskew 的值；颜色图表示
                  SXRcore 的值；Y 轴表示 SXRskew 的 SHAP 值

  IP 和 Bt 分别是排名第四和第五的贡献特征。即使 IP 和 Bt 在一次放电中变化不大，
它们的贡献仍然很大，因为它们是等离子体的基本参数。IP 和 Bt 的值对“破裂”或
“非破裂”没有影响。dZ 和 IHF 都可以反映垂直位移。更低的 IHF 代表了垂直位移的
失控，这对 "破裂"的影响更大。dr 和 IVF 都可以反映水平位移。dr 的值越高，对“破
裂”和“非破裂”的贡献大，这可能表示在 J-TEXT 中，水平位移到低场侧(low field
side, LFS)限制器导致的破裂是可以挽救的。

5.1.2 J-TEXT 破裂预测模型学习物理规律的研究

  IDP-PGFE 的卓越性能及其初步的可解释性分析已经在之前的研究中取得了显
著成果。具有物理引导特征的 IDP-PGFE 模型的真实正例率（TPR）为 96.36%，假



                                 91
      华 中 科 技 大 学 博 士 学 位 论 文

正例率（FPR）为 2.73%。使用 SHAP 进行的可解释性研究提供了对 J-TEXT 破裂的
理解，并与之前对破裂及其过程的理解相符。
  当仔细分析中心弦平均密度和等离子体电流对破裂的贡献时，得到模型已经学
习到了 Greenwald 密度极限标度律的现象。如图 5-3 所示，当密度大于 4×1019 m-3 时，
密度对“破裂”的贡献开始增加，而较小的密度（小于 1×1019 m-3）对“破裂”的贡
献较少。结合等离子体电流，可以发现当等离子体电流大于 200 kA 时，无论密度如
何（在此范围内），对“破裂”的贡献都很低，因为此时的 Greenwald 密度极限较高。
当电子密度大于 4.3×1019 m-3 时，只有等离子体电流小于 180 kA 时对“破裂”的贡
献较大（0.5 nG ~ 0.7 nG）。与此同时，较小的等离子体电流对“破裂”的贡献更多。
对于机器学习方法来说，密度极限破裂的物理学过于复杂，标度律是一个捷径。因此，
我们认为 IDP-PGFE 已经学习到了 Greenwald 密度极限标度律。




图 5-3 密度 ne 的 SHAP 值与密度 ne 和等离子体电流 IP 大小的关系。横轴表示密度的大小，颜
           色表示等离子体电流的大小; 纵轴表示密度的 SHAP 值


                          92
        华 中 科 技 大 学 博 士 学 位 论 文

5.2 J-TEXT 破裂预测模型在物理实验中的应用

    IDP-PGFE 不仅具有全局的可解释性，表明了该模型学习到了 J-TEXT 正确的破
裂知识，可以作为跨装置破裂预测的基础。同时，IDP-PGFE 的可解释性可以应用于
物理实验，为破裂带来新的实验理解，帮助跨装置破裂预测更好地提取、选择特征与
搭建网络。该可解释性还可以分析每一炮的破裂预测结果，分析误报、漏报原因。
    将可解释破裂预测模型应用与物理实验的基本原理为 SHAP 会对每一个时刻（即
破裂预测的数据样本）给出每一个特征对于破裂的贡献度。结合实验现象与最终的破
裂时间，可以分析一整炮中究竟是哪个特征产生的主要破裂贡献以及破裂事件发展
链条，从而研究破裂发生的原因。接下来将分别介绍 IDP-PGFE 在 J-TEXT 上 ECRH
与 RMP 影响密度极限破裂实验中的应用以及一例破裂预测漏报原因分析。

5.2.1 J-TEXT 破裂预测模型在 ECRH 影响密度极限实验中的应用

    调查 ECRH 对 J-TEXT 中因密度持续增加而导致破裂的影响的实验在 2021 年春
季进行的。在 ECRH 实验中（IP = 120 kA, Bt = 1.7 T, PECRH = 100-300 kW, rECRH = 10.2
cm），实验现象表明投入 ECRH 后，无法达到 J-TEXT 的密度极限，实验现象具有可
重复性。测试集中找出了该实验中的三炮典型放电。他们的实验概况如图 5-4 所示，
没有投入 ECRH 的放电达到了最高密度极限，约为 0.79 nG。投入 300 千瓦 ECRH 的
放电只达到了约 0.69 nG 和 0.56 nG 的密度极限。#1074395 炮中，在投入 ECRH 后，
当密度达到 0.69 nG 时，很快就发生了破裂。#1074399 炮中，在投入 ECRH 后出现了
MHD 不稳定性。ECRH 关断后，密度达到约 0.56 nG 时发生了破裂。从现有的实验现
象来看，很难得出 ECRH 是否降低了密度极限，或者在达到密度极限之前，其他原
因导致了破裂的结论。
    图 5-5、图 5-6 和图 5-7 分别显示了#1074378、#1074395 和#1074399 炮的预测
结果、SHAP 值和四个典型特征。在典型的密度极限破裂炮中（#1074378），破裂前
最有贡献的特征是芯部弦积分密度 ne0。然而，在投入 ECRH（#1074395 和#1074399）
时，破裂前的最大贡献特征不是芯部弦积分密度。这表明 ECRH 的投入并没有降低
密度极限，因为破裂不是由芯部弦积分密度达到密度极限导致的。


                                   93
      华 中 科 技 大 学 博 士 学 位 论 文




图 5-4 ECRH 下 J-TEXT 破裂实验中三种典型放电的概况。蓝线代表没有投入 ECRH 的实验，
密度极限约为 0.79 nG。橙色和绿色的线条代表投入 300 千瓦 ECRH 的放电，其密度极限分别为
0.69 nG 和 0.56 nG。a）等离子体电流；b）中心道的弦平均密度；c）Mirnov 信号；d）ECRH 功
率。在# 1074395 放电中，ECRH 由于破裂而关断，而在# 1074399 放电中，破裂发生在 ECRH
                          关断之后

   #1074378 炮（未投入 ECRH）是一个典型的密度极限破裂炮。模型预测结果的
升高是由于 ne0 的 SHAP 值的增加。MNM 的 SHAP 值在接近破裂时增加，这与密度



                            94
     华 中 科 技 大 学 博 士 学 位 论 文

极限破裂前的 MHD 不稳定性的快速发展相吻合。#1074395 炮（投入 ECRH），P_rad
的 SHAP 值在投入 ECRH 后增加，然而，这对预测结果的贡献很小。在大约 0.33s 时，
MHD 不稳定性的开始（可能是 m=3 和 m=2 模式耦合）出现，对预测结果的贡献仍
然很小。重要的贡献是 Mir_abs，它模型预测结果升高，并大于 0.5，可惜该炮提前
时间过短，属于漏报警炮。因此，这种放电不是密度极限破裂，在这种情况下，ECRH
的应用并没有降低密度极限。




图 5-5 未投入 ECRH 时，#1074378 炮的预测结果、SHAP 值和四个典型特征。a）等离子体电
流和模型预测结果；b）所有特征的 SHAP 值，彩色线条代表四个典型特征；c）其中两个典型
特征，中心道弦平均密度 ne0（浅蓝色）和辐射功率 P_rad（橙色）；d）其中两个典型特征，
       Mirnov 探针的强度 Mir_abs（绿色）和平均极向模数 MNM（黄色）


                          95
       华 中 科 技 大 学 博 士 学 位 论 文

                      ，P_rad 的 SHAP 值在投入 ECRH 后也增加了。在
   #1074399 炮中（投入 ECRH）
大约 0.32s 时，MHD 不稳定性也出现了，Mir_fre 特征对模型预测结果有很大贡献，
并引起了提早预警。然而，在这种情况下，破裂并没有瞬间发生，而是在 ECRH 关
断后。Mir_abs 的 SHAP 值是提早报警后模型预测结果的主要贡献，并在该炮内持续
报警。很明显，该炮仍然不是密度极限破裂，ECRH 的投入并没有降低密度极限。




图 5-6 #1074395 炮的预测结果、SHAP 值和四个典型特征，ECRH 于 0.25s 时投入。a), b), c), d)
                       代表的物理量与图 5-5 相同




                                96
       华 中 科 技 大 学 博 士 学 位 论 文




图 5-7 #1074399 炮的预测结果、SHAP 值和四个典型特征，ECRH 于 0.25s 时投入。a), b), c), d)
                       代表的物理量与图 5-5 相同

   通过对这三种典型 ECRH 影响密度极限破裂的可解释性研究，可以得出结论：
ECRH 的投入并没有降低 J-TEXT 的密度极限，而是引起了辐射增强导致的破裂与
MHD 不稳定性导致的破裂。通过上述分析，还可以找到两个进一步分析实验的方向。
第一，辐射功率和 MHD 不稳定性之间的关系需要深入研究，这可能与密度极限破裂
的物理机制类似。第二，在#1074399 放电中，MHD 不稳定性的出现引起了早期预警，


                                97
      华 中 科 技 大 学 博 士 学 位 论 文

而 ECRH 的应用延迟了 MHD 不稳定性引起的破裂。这两种情况下的 MHD 不稳定
性对密度极限破裂起到的作用值得研究。

5.2.2 J-TEXT 破裂预测模型在 RMP 影响密度极限实验中的应用

   RMPs 对 J-TEXT 密度极限实验在 2022 年春天进行。在 RMP 实验中（IP = 120
kA, Bt = 2.1 T, Ic = 0-4 kA），RMP 的投入提高了破裂时的密度极限。测试集中找出
了该实验中的两个典型炮。它们的实验概况如图 5-8 所示。未投入 RMP 的参考炮密
度极限了约为 0.79 nG，是 J-TEXT 正常情况下的密度极限。在 RMP 实验中，投入
2kA RMP 的实验达到了最高的密度极限，约为 0.91 nG，这是 J-TEXT 上目前最高的
密度极限。#1080564 炮是 J-TEXT 上典型的高 qa 密度极限破裂炮。这种类型的炮中，
MARFE 和等离子体极向脱栏可以通过高低场侧密度之比来体现。随着密度的持续上
升，高低场侧密度比随着 MARFE 的出现而增加，MARFE 的持续增加会导致边缘冷
却，MARFE 区的中性粒子逐渐增多后，会导致等离子体与高场侧极向脱栏，这时由
于高场侧等离子体已经收缩，高低场侧密度之比开始下降。#1080550 炮中，从实验
现象上，RMP 的投入延迟了高低场侧密度比的下降，提高了密度极限，延迟了
#1080550 炮的破裂。
                             （未投入 RMPs）和#1080550（投入 RMPs）
   图 5-9 和图 5-10 分别显示了#1080564
炮模型预测结果、SHAP 值和四个典型特征。投入 RMPs 后，实际破裂时间远晚于模
型报警时间。这表明 RMPs 的应用延迟了密度极限的破裂，提高了密度极限。#1080564
炮（未投入 RMPs）与#1074378 炮不同，该炮为高 qa 密度极限破裂炮。模型预测结
果上升是因为 CIII、AXUVkurt 和 MNM 的 SHAP 值上升。ne0 的 SHAP 值只在接近破
裂时上升。CIII 的 SHAP 值在大约 0.39 秒（MARFE 期间）上升，对预测结果的贡献
约为 0.4。在大约 0.42 秒时，发生了等离子体极向脱栏，AXUVkurt 的 SHAP 值随着
AXUVkurt 的降低而上升，这表明了一个剖面的陡峭程度开始增加，对模型预测结果贡
献度较大。在大约 0.44 秒时，MNM 的 SHAP 值上升，并导致模型预测结果大于 0.5。
高 qa 密度极限破裂放电的可解释性研究表明，在密度极限破裂之前，等离子体极向
脱栏和后续 MHD 不稳定性可能是造成密度极限破裂的原因。



                           98
     华 中 科 技 大 学 博 士 学 位 论 文




图 5-8 RMP 影响 J-TEXT 密度极限破裂的两个典型炮。蓝线代表未投入 RMPs 的放电，密度极
限约为 0.79 nG。橙色线代表投入 2kA RMPs 的放电，密度极限约为 0.91 nG。a）等离子体电
 流；b）中心道弦平均密度；c）高低场侧密度比；d）RMPs 电流。RMPs 关断后发生破裂

  在#1080550 放电中（投入 RMPs），CIII 的 SHAP 值仍然在 0.39 秒左右（MARFE
期间）上升。然而，由于 RMPs 的投入，等离子体极向脱栏未发生，由等离子体极向
脱栏而导致的电流通道收缩，诱发 MHD 不稳定性也没有出现。因此，AXUVkurt 没有
下降，AXUVkurt 的 SHAP 值也没有上升。对预测结果贡献最大的是 ne0，因为对于破



                          99
      华 中 科 技 大 学 博 士 学 位 论 文

裂预测模型，该炮达到了密度极限。在 RMPs 关断后，大约在 0.56 秒时，AXUVkurt 下
降，最终电流通道收缩，导致诱发 MHD 不稳定性，MNM 贡献度上升，等离子体极
向脱栏和 MHD 不稳定性再次出现，并导致破裂。




图 5-9 未投入 RMPs 时，#10080564 炮的预测结果、SHAP 值和四个典型特征。a）等离子体电
流和模型预测结果；b）所有特征的 SHAP 值，彩色线条代表四个典型特征；c）其中两个典型
特征，中心道弦平均密度 ne0（浅蓝色）和杂质幅值强度 CIII（橙色）
                                   ；d）其中两个典型特征，
        AXUV 阵列峰度 AXUVkurt（绿色）和平均极向模数 MNM（黄色）




                          100
      华 中 科 技 大 学 博 士 学 位 论 文

   因此，RMPs 的投入可能通过在密度极限破裂之前延迟等离子体极向脱栏和
MHD 不稳定性来提高密度极限。RMPs 的投入不仅对 MHD 不稳定性有影响，而且
对辐射剖面（AXUVkurt）也有影响。AXUVkurt 和 MNM 的贡献比 ne0 的贡献更显著且更
早。这表明 RMP 影响了边界的辐射分布，使原本的 MARFE 进入脱栏的过程得到逆
转。这是 RMP 实验对密度极限破裂的一个新认识，可以指导后续找出密度极限破裂
的物理机制。例如边界磁岛影响杂质屏蔽，从而改善边界辐射分布等。




图 5-10 投入 RMPs 时，#10080550 炮的预测结果、SHAP 值和四个典型特征，RMPs 约 0.4s 投
                入。a), b), c), d)代表的物理量与图 5-9 相同


                              101
      华 中 科 技 大 学 博 士 学 位 论 文

5.2.3 破裂预测结果的可解释性研究

  破裂预测模型的可解释性还可以用于分析与研究破裂预测模型结果产生误报或
漏报的原因。本节将选取一炮典型的漏报炮做可解释性的分析与研究。# 1054187 炮
为一炮破裂炮，破裂预测模型于 0.427 s 给出破裂预警，然而该炮于 0.435 s 发生破
裂。该炮的破裂预警的提前时间仅为 8 ms，小于设定的 10 ms 提前时间。因此该炮
被视为漏报炮。该炮等离子体电流为 180 kA，纵场为 2.2 T。放点期间运行平稳，密
度也没有持续升高，磁扰动较小，因此模型预测的破裂概率一直处于较低水平。通过
特征贡献度可以看出，0.427 s 该炮是由于不明杂质掉入等离子体诱发的破裂，辐射
剖面的变化在此时最为明显并触发了报警。可惜这种类型的破裂会导致等离子体内
部温度迅速降低，诱发 MHD 不稳定性，从而快速导致破裂。因此，该炮仅提前 8 ms
预测出破裂，为延迟报警，被视为漏报。
  这种由不明杂质掉入等离子体的破裂类型，由于是不明杂质，所以常被称为不明
飞行物（Unidentified Flying Object, UFO）破裂。这种破裂类型是最棘手的破裂类型
之一，尤其是在小装置上，等离子体体积小，能量约束时间短，会很快的导致破裂。
而若是在更大的装置上从 UFO 出现到破裂时间更长，且更先进的破裂缓解系统可以
减少响应时间，则只要能在 UFO 出现的时刻检测到，即可成功触发破裂预测的报警
信号。
  该炮在稳定运行时，辐射剖面也出现了几次较小的突变，是由少量杂质掉入等离
子体导致。此时破裂预测模型给出的破裂预警较低，证明模型认为并非所有的杂质掉
入等离子体都会成为 UFO 导致的破裂。该现象展现了模型并非从某一两个特征中学
习特征的突变情况，而是综合所有输入特征学习等离子体破裂的规律。同时，辐射剖
面贡献度也在每次掉入少量杂质时出现一定程度的贡献度增加。若可以将该破裂贡
献度实时化运行，可以帮助放电运行人员或反馈系统，及时处理破裂概率虽不高，但
可能导致后续更严重破裂诱因的事件，从而较破裂预测更早一步以实现破裂避免。这
还需要更进一步的深入研究。
  由本例可以发现，该可解释性分析方法，可以应用在任意的实验放电运行中，是
较为通用的研究破裂诱因分析破裂原因的方法。


                          102
     华 中 科 技 大 学 博 士 学 位 论 文




 图 5-11 #1054187 炮的预测结果，该炮为延迟报警炮，被视为漏报。SHAP 值和四个典型特
征。a）等离子体电流和模型预测结果；b）所有特征的 SHAP 值，彩色线条代表四个典型特
征；c）其中两个典型特征，中心道弦平均密度 ne0（浅蓝色）和杂质幅值强度 CIII（橙色）；
 d）其中两个典型特征，AXUV 阵列峰度 AXUVkurt（绿色）和平均极向模数 MNM（黄色）


5.3 跨装置破裂预测的可解释性研究

  本节将描述可解释性研究。可解释性研究的目标是探究为什么 S-CORAL 模型能
够胜过混合数据模型和 U-CORAL。它还可以为未来在 ITER 和 SPARC 等其他未来
托卡马克装置上的应用提供洞见和宝贵经验。首先介绍了 S-CORAL 如何对齐 J-

                         103
      华 中 科 技 大 学 博 士 学 位 论 文

TEXT 和 EAST 之间的训练数据分布，这可以称为内在可解释性。之后介绍了使用
SHAP 探索混合数据、U-CORAL 和 S-CORAL 模型相比于完整数据训练的 EAST 单
一托卡马克完整数据装置模型在测试集上学到的知识的差异。这种可解释方法可以
称为事后可解释性。已经确定了一种评估这种差异的方法，以证明 S-CORAL 确实学
习到了更接近 EAST 单一托卡马克完整数据装置模型的知识。本节还将结合一炮
EAST 放电展示跨装置破裂预测不仅可以成功预测出破裂，还可以识别出破裂诱因。
最后介绍了对零炮迁移模型中关键的 EFD 方法做了敏感性分析，模型对数据特征的
均值与方差敏感性不高，因此该方法具有较强的可靠性。

5.3.1 跨装置物理特征分布分析

   尽管 PGFE 可以将 EAST 和 J-TEXT 的诊断信号转化为物理引导特征，但两个托
卡马克之间的巨大差距意味着每个托卡马克的决策边界将不同。例如，相同的物理现
象或参数变化可能会触发 J-TEXT 中的破裂预警，但不一定会导致 EAST 中的破裂。
归一化和 CORAL 的目的是尽可能地在数据分布方面对齐每个特征。S-CORAL 之所
以比 U-CORAL 和混合数据表现更好，是因为更多的特征可以比其他两种情况更好
地对齐。四个典型的归一化特征 ne0, n =1 phase, SXRskew 和 SXRkurt 的概率密度在图
5-12 和图 5-13 中显示。图 5-12 表示非破裂数据的概率密度，而图 5-13 表示破裂数
据的概率密度。黄色区域和线表示 J-TEXT 数据的概率密度。橙色区域和线表示 EAST
数据的概率密度。绿色区域和线表示 U-CORAL 数据的概率密度。海军蓝色区域和
线表示 S-CORAL 数据的概率密度。
   图 5-12 显示，J-TEXT 和 EAST 之间的非破裂数据分布已经非常相似。这表明
通过 PGFE 和归一化的过程足以有效地对齐 J-TEXT 和 EAST 之间的非破裂数据分
布。U-CORAL 和 S-CORAL 的非破裂数据分布相同，这表明这两种 CORAL 方法不
会影响非破裂数据分布。相比之下，图 5-13 显示，S-CORAL 的破裂数据分布与 EAST
的破裂数据分布更相似，而 U-CORAL 的破裂数据分布与 J-TEXT 的破裂数据分布更
相似。使用 S-CORAL 进行对齐后，破裂数据分布包含了来自 EAST 数据分布的更多
信息。但不是所有特征都需要使用 S-CORAL 来对齐破裂数据分布，也不是所有特征
都可以通过 PGFE 和 CORAL 有效地对齐。应用 PGFE 和归一化可以对齐 56%
                                            （14/25）

                           104
     华 中 科 技 大 学 博 士 学 位 论 文

特征的非破裂数据分布，可以对齐 36%（9/25）特征的破裂数据分布。应用 S-CORAL
可以对齐 68%（17/25）特征的破裂数据分布。




        图 5-12 ne0, n =1 phase, SXRskew 和 SXRkurt 非破裂数据的概率密度

5.3.2 跨装置模型 SHAP 可解释性研究

  数据分布分析显示，基于特征的方法 PGFE 和 CORAL 能够调整 J-TEXT 和 EAST
之间的数据分布。这是由于 PGFE 和 CORAL 是一种基于规则的模型，因此具有内在
的可解释性。SHAP 是一种基于属性的可解释方法，属于事后可解释性的一种。SHAP
为模型提供全局可解释性，分析了特征变化对模型输出的贡献。在本节中，完整数据
训练的 EAST 单一托卡马克完整数据模型是一个基准模型。三个跨托卡马克模型（混
合数据、U-CORAL 和 S-CORAL）将与该基准模型进行比较，以分析哪个跨托卡马
克模型从 EAST 数据中学到了更多的全局可解释性知识。为了进行公平比较，SHAP
的数据集被选为测试集。图 5-14（b）显示了不同特征的全局 SHAP 值及其与 EAST
单一托卡马克完整数据模型特征值的关系。在测试集上的 SHAP 结果可以理解为模


                                105
    华 中 科 技 大 学 博 士 学 位 论 文

型学到的知识，应用于区分测试集中的“破裂”或“非破裂”。特征的顺序表示了其
贡献度，颜色映射表示每个特征的特征值，红色表示高，蓝色表示低。SHAP 在全局
可解释性方面的优势在于，它不仅可以提供特征对模型的贡献排名，还可以指示特征
变化对模型预测的贡献是积极还是消极的。在分析多个模型是否学到了类似的知识
时，特征变化对模型的积极或消极贡献比特征贡献的排名更重要。在预测破裂时，即
使对于物理学家来说，对破裂的判断可能基于各种特征。不同的物理学家可能对特征
重要性的排名有所不同。然而，无论特征重要性如何排名，特征的变化对“破裂”或
“非破裂”的贡献应保持不变。例如，在密度极限破裂之前，密度不仅是一个关键特
征，MARFE 和 MHD 不稳定性也是密度极限破裂的重要指标。无论特征重要性如何
排名，密度越高，其对破裂的贡献越大。数据集中破裂类型和原因的分布也可能影响
特征贡献的排名。因此，特征变化对“破裂”或“非破裂”的贡献应比特征贡献的排
名更重要。




        图 5-13 ne0, n =1 phase, SXRskew 和 SXRkurt 破裂数据的概率密度




                                106
     华 中 科 技 大 学 博 士 学 位 论 文




图 5-14 (a) 通过与单一托卡马克完整数据模型相似性评估的三个跨装置模型的得分。表最后一
行以红色背景显示总得分。(b) 不同特征的 SHAP 值及其与完整数据训练的 EAST 单一托卡马
克完整数据模型特征值的关系。SHAP 结果中条形的宽度代表样本数量。颜色图表示每个特征
             的特征值，红色表示高值，蓝色表示低值

  本节设计了一种评估方法，用于根据 SHAP 的全局可解释性结果评估模型学到
的知识是否相似。这种评估方法的核心逻辑是计算具有相似变化模式的特征数量。由
于完整数据训练的 EAST 单一托卡马克完整数据模型是使用更多 EAST 数据训练的，
并且表现最佳，因此关于 EAST 破裂的学到的知识更为全面和准确。因此，将使用完
整数据训练的 EAST 模型作为基准，将三个跨托卡马克模型进行比较。如果跨托卡
马克模型中任何特征的变化对“破裂”或“非破裂”的贡献与基准模型相同，则该特
征得分一分。例如，在单一托卡马克完整数据模型中，特征 v_loop 的值越大，其对



                       107
     华 中 科 技 大 学 博 士 学 位 论 文

“破裂”的贡献越高。在 S-CORAL 模型中，特征贡献的趋势也一致。因此，对于 S-
CORAL 模型，特征 v_loop 得分一分。相反，如果跨托卡马克模型中任何特征的变化
对“破裂”或“非破裂”的贡献与单一托卡马克完整数据模型不同，则该特征得分一
分。例如，在单一托卡马克完整数据模型中，特征 dZ 的值越大，其对“破裂”的贡
献越高。在 S-CORAL 模型中，dZ 的值既不对“破裂”也不对“非破裂”有贡献，这
也与基准模型不同。因此，对于 S-CORAL 模型，特征 dZ 得分一分。然后，将每个
特征的得分相加，以评估哪个模型与基准模型更相似。




图 5-15 SHAP 分析的 EAST 破裂放电案例。(a) 深蓝色线表示等离子体电流。深红色线表示预
测结果。(b) 浅蓝色线表示 Mirnov 探针的原始信号。橙色线分别表示（c）Mir_Vpp 的特征值
     和（d）SHAP 值。绿色线分别表示（c）v_loop 的特征值和（d）SHAP 值


                         108
      华 中 科 技 大 学 博 士 学 位 论 文

   图 5-14（a）还显示了通过与单一托卡马克完整数据模型进行相似性评估的三个
跨托卡马克模型的所有特征得分。表的第 1、2、3 列分别显示了混合数据模型、U-
CORAL 模型和 S-CORAL 模型在每个特征上的得分。除了第一行和最后一行外，每
行对应图 5-14（b）中的每个特征。表的最后一行是红色背景颜色，显示了总得分。
总得分的排名表明，S-CORAL 模型（得分 7）与单一托卡马克完整数据模型最相似。
而混合数据模型得分-3，U-CORAL 模型得分 3。数组信号的偏度是关于其平均值的
分布的不对称性的度量，可以近似地反映诊断测得的等离子体的位移程度。在所有三
个跨托卡马克模型中，dr, AXUVskew, SXRskew 和 DENskew 的得分都是-1。这反映了在
EAST 和 J-TEXT 接近破裂时，等离子体从中心向不同方向偏离。在以前的研究中，
对 J-TEXT 的可解释性研究证明，即使可以挽救，等离子体在接近破裂时通常倾向于
向低磁场侧（LFS）移动。然而，在接近破裂时，EAST 的等离子体倾向于向高磁场
侧（HFS）移动。这可能与 J-TEXT 和 EAST 之间的等离子体控制系统的差异有关。
   SHAP 分析也可用于识别破裂原因。我们之前的工作基于放电过程中 SHAP 值
的时间演变，提供了一种可能的实验分析方向，该放电受限于密度极限破裂并受到
RMPs 影响。在本节中，我们将展示一个使用 S-CORAL 模型分析破裂原因的破裂放
电示例。图 5-15 展示了 EAST 中的破裂放电#86485 的预测结果。破裂时间是 4.005
s，预测时间是 3.448 s，所选阈值为 0.58，这是在论文中选择的阈值。这次破裂的原
因是杂质引起了 MHD 不稳定性，进而导致最终的破裂，这是 EAST 上的典型破裂类
型。大约在 3.435 秒时，杂质导致 v_loop 显著增加，此时 v_loop 的 SHAP 值也触发
了较高值，结果模型在 0.58 阈值下发出预警。大约在 3.585 s 时，杂质也导致了 v_loop
和 Mir_Vpp 的增加，v_loop 和 Mir_Vpp 的 SHAP 值均升高，预测结果接近 1。因此，
如果需要更低的 FPR，模型的阈值应设定得更高。即使模型的阈值高于 0.58，模型
也可以在足够的预警时间内对该破裂发出预警。这个示例显示，传输模型 S-CORAL
不仅可以预测破裂，还能正确识别破裂原因。

5.3.3 零炮迁移模型的 EFD 敏感性分析

   由 4.6 节的结果可以看出，EFD 是实现零炮迁移的关键，即使是只用源装置的均
值与标准差也难以得到性能较好的模型。因此需要对数据的均值与标准差做敏感性

                          109
     华 中 科 技 大 学 博 士 学 位 论 文

分析，研究均值与标准差的变化对模型的预测结果影响如何，从而判断 EFD 的可行
性与鲁棒性。首先，我们对单一特征均值与标准差的变化对预测性能的影响做了分
析。我们挑取了部分特征，分布改变其标准化参数中的均值与标准差，得到预测结果
AUC 的相应变化如图 5-16 与图 5-17 所示。图 5-16 为部分特征均值变化率与模型
测试性能 AUC 变化率关系，图 5-17 为部分特征标准差变化率与模型测试性能 AUC
变化率关系。可以得出单一特征，无论是均值还是标准差的变化均无法对性能造成较
大的影响。单一特征的均值与标准差变化率不会对预测性能有较大的影响，主要是因
为即使是 PGFE-U 提取的特征也并非完全相互独立的特征，特征之间的信息存在耦
合，只是单一特征的变化不足以影响最终的预测性能。因此，我们也测试了当所有特
征共同的变化率与预测性能之间的关系。图 5-18 展现了所有特征的均值与标准差的
变化率对预测性能的影响。若想保证性能下降在 90%以内，则整体均值的变化率需
要控制在-100% ~ 200%之间，标准差的变化率要控制在 50% ~5 00%之间，是非常大
的变化阈度。




         图 5-16 部分特征均值变化率与模型测试性能 AUC 变化率关系




                        110
华 中 科 技 大 学 博 士 学 位 论 文




 图 5-17 部分特征标准差变化率与模型测试性能 AUC 变化率关系




 图 5-18 所有特征的均值与标准差的变化率对预测性能的影响




                 111
      华 中 科 技 大 学 博 士 学 位 论 文

5.4 本章小结

  本章分别对面向 J-TEXT 单一装置的可解释破裂预测模型 IDP-PGFE 以及基于
领域自适应算法的跨装置破裂预测模型做了可解释性的研究与分析。借助 SHAP 工
具，可对基于 PGFE 的破裂预测模型进行解释。输入信号为 PGFE 后提取的特征信
号，因此各信号具有具体意义，而非某一道诊断信号。
  通过可解释性研究，证明了 IDP-PGFE 学习到了实际的破裂知识。通过特征与特
征间相互影响的分析还证明了 IDP-PGFE 具有学习物理规律的能力。IDP-PGFE 强大
的可解释性还可以应用于 J-TEXT 破裂物理实验中，为密度极限实验带来了新的实验
理解，IDP-PGFE 可以作为一种新的物理实验辅助工具，为破裂物理机理的研究带来
启发。
  对跨装置破裂预测的可解释性研究主要聚焦于不同的数据策略，混合数据、U-
CORAL 和 S-CORAL 为何会导致模型最终预测性能的差异。本章通过可解释性研究
得出，S-CORAL 实现的跨装置破裂预测模型，模型学习到的破裂知识与规律与使用
大量数据训练的面向 EAST 的单一装置模型更加类似，从而实现了更好的跨装置破
裂预测性能。与此同时，在跨装置破裂预测模型依然可以像面向单一装置的模型如
IDP-PGFE 一样在识别出是否破裂的同时，还能识别出破裂诱因，对未来的破裂避免
研究能提供帮助与启发。本章还对 EFD 对预测性能的敏感性做了细致的分析，得出
EFD 对预测性能的敏感性较低，若想保证性能下降在 90%以内，则整体均值的变化
率需要控制在-100%~200%之间，标准差的变化率要控制在 50%~500%之间，是非常
大的变化阈度。在未来聚变堆的应用场景中，放电区间，诊断设计一般不会做重大修
改的情况下，可以通过设计参数、模拟代码、合成诊断等方式，估计出目标域装置特
征分布的均值与标准差。




                      112
      华 中 科 技 大 学 博 士 学 位 论 文

                    6   总结与展望

6.1 本工作主要内容及结论

   托卡马克破裂预测是未来大型托卡马克破裂防护系统中的重要一环。目前主流
的破裂预测模型为数据驱动的模型，可以做到对单一装置预测性能极佳。然而未来大
型托卡马克难以获得足够多的训练数据以实现现有单一装置破裂预测的性能，因此，
需要进行跨装置破裂预测的研究。目前的跨装置破裂预测研究仍旧存在着现有数据
量难以体现深度模型的优势、装置间差距导致的跨装置性能欠佳以及模型可解释性
不足等问题。本工作提出了基于托卡马克物理特征的机器学习跨装置破裂预测的方
案。通过物理知识指导，减小了数据驱动模型的参数搜索域，使模型用更少数据也可
训练高性能的破裂预测模型；减少了装置间数据差异对模型的影响，实现了仅需目标
域装置少量数据甚至无需任何数据的跨装置破裂预测模型；增强了破裂预测模型的
可解释性，并开发了破裂预测模型在物理实验中的新应用。本文的主要工作如下：
   （1）提出了物理指导的特征提取算法 PGFE，并发展了 J-TEXT 装置高性能可
迁移、可解释的破裂预测模型。本论文首先介绍了一种用于破裂预测与跨装置破裂
预测的通用数据库框架，该框架可以高效批量处理不同装置的放电数据。通过可控核
聚变及等离子体物理研究者对于破裂的理解，对装置原始诊断信号进行物理指导的
特征提取（PGFE）。该方案可以一定程度上减少装置间因诊断差异导致的数据分布差
异，并且降低模型学习破裂物理的难度，提高模型的可解释性。在 J-TEXT 托卡马克
装置上实现了基于物理指导特征提取的可解释破裂预测器，实现了高性能破裂预测
（AUC = 0.987， TPR = 96.36%，FPR = 2.73%）。该模型还可以减少对训练数据量的
需求，仅需 20 炮破裂炮与 120 炮非破裂炮即可实现 AUC = 0.939， TPR = 89.09%,
FPR = 10%的破裂预测性能。即训练数据下降了 90%，而模型 AUC 仅下降了 4.8%。
   （2）基于优化物理指导与领域自适应算法，实现了少量 EAST 数据训练与无需
EAST 数据训练的跨装置破裂预测模型。本论文首次在跨装置破裂预测的研究中引
入领域自适应算法 CORAL，并对 CORAL 做了适应于破裂预测的改进，减少了 J-
TEXT 与 EAST 装置间的数据分布差异，仅用 10 炮 EAST 破裂炮与 100 炮 EAST 非

                          113
      华 中 科 技 大 学 博 士 学 位 论 文

破裂炮实现了 AUC = 0.89，TPR = 90%，FPR = 25.56%的跨装置破裂预测性能。相比
于混合数据的方式性能提升了 17%，相比于使用大量 EAST 数据训练的基线模型，
在数据量减少了 94%的情况下，性能仅下降 5%。通过优化物理指导，将使用 CORAL
的 EAST 跨装置破裂预测性能提升至仅需 10 炮 EAST 破裂炮便得到 AUC = 0.947 的
跨装置破裂预测性能，仅比大量数据训练的 EAST 破裂预测模型，在数据量减少了
95%的情况下，性能仅下降 2.8%。并且得到了零炮迁移的预测模型，可以达到 AUC
= 0.893 的性能，仅比大量数据训练的 EAST 破裂预测模型，在数据量减少了 100%
的情况下，性能仅下降 8.4%。
  （3）深入研究了破裂预测模型的可解释性，证明了破裂预测模型学习破裂规律
的能力，增强了本文跨装置破裂预测模型的可靠性，并通过可解释性研究发现 J-
TEXT 实验中的新破裂物理规律。为了研究该破裂预测器是否学习到了通用的破裂
物理知识，对该破裂预测器做了全局与局部的可解释性研究，证明了该破裂预测器基
本学习到了通用的破裂物理知识，并且具有学习物理规律的能力。同时开发了该破裂
预测器辅助 J-TEXT 物理实验进行实验现象分析的功能。通过 SHAP 对该跨装置模
型进行可解释性研究证明 S-CORAL 算法可以学习到更多的 EAST 原本的破裂知识。
解释了为什么 S-CORAL 算法可以实现最好的跨装置破裂预测性能，并且证明了领域
自适应算法在跨装置破裂预测研究中的有效性。对零炮迁移模型中 EFD 方法做了敏
感性分析，证明了 EFD 方法具有较高的鲁棒性，可以应用于未来装置中。

6.2 本工作的主要创新点

  本工作针对托卡马克跨装置破裂预测所面临的问题以及对现有托卡马克破裂预
测的深入调研，提出了基于托卡马克物理特征的机器学习跨装置破裂预测的方案，具
体有以下创新点：
   （1） 针对现有破裂预测模型较少考虑物理，且可解释性差的特点，提出了基
于物理指导的特征提取算法的 J-TEXT 可解释破裂预测模型（IDP-PGFE），实现了
高性能的 J-TEXT 破裂预测模型（AUC = 0.987），并发现 J-TEXT 实验中 RMP 通
过影响边界辐射分布提高密度极限的破裂物理新规律。


                         114
      华 中 科 技 大 学 博 士 学 位 论 文

   数据驱动的破裂预测模型通常较少考虑破裂物理的贡献，因此难以保证模型学
习到了足够可靠的破裂物理。且通过大量数据训练得到的是“黑箱”模型，通常可解
释性较差，即使利用机器学习中的可解释算法对模型解释，也仅能得到诊断信号与破
裂概率的相关性。本文基于对现有破裂物理的理解，将 J-TEXT 机器学习破裂预测模
型的输入信号由诊断信号提取为破裂物理特征，将物理归纳偏置加入机器学习模型
训练。不仅可以指导模型用更少的数据训练模型，还极大地增强了模型的可解释性，
直接建立了物理特征对破裂概率的贡献关系。经过可解释性的研究验证了模型学习
到了正确的破裂物理规律，还发现 J-TEXT 实验中的新破裂物理规律。
   （2） 针对现有跨装置模型多使用混合数据的训练方式导致数据利用效率低的
问题，提出了基于物理指导特征提取与领域自适应算法的跨装置破裂预测模型，仅
用少量目标装置数据得到了性能远超混合数据训练模型的破裂预测性能。
   国际上主要的跨装置破裂预测研究的技术路线均为，将目标装置与源装置数据
混合训练模型。该方案对数据利用效率较低，且少量目标装置数据容易被搜索域不足
的模型当作噪声数据忽略。本文基于物理指导特征提取先通过物理指导的方式减小
两个差异巨大装置 J-TEXT 与 EAST 间诊断数据差异对模型的影响，再通过针对破裂
预测改进的领域自适应算法减小装置间决策边界和数据分布的差异，实现了仅用 10
炮破裂炮与 100 炮非破裂炮的跨装置破裂预测模型，性能较混合数据方法相比 AUC
从 0.76 提升至 0.89 提升了 17%。
   （3） 针对现有跨装置破裂预测仍需要一定目标装置数据的问题，提出了优化
物理指导的跨装置破裂预测方法，通过优化物理指导特征提取、提高数据标注质量、
估计标准化参数，实现了无需目标装置数据的跨装置破裂预测模型。
   不使用任何目标装置数据实现零炮迁移的跨装置破裂预测模型，是跨装置破裂
预测研究的目标与难题。本文基于对物理与数据结合的破裂预测研究经验，根据当无
法利用目标装置数据驱动时，就更多考虑物理驱动的思路，提出了优化物理指导的跨
装置破裂预测方法。通过优化 PGFE 进一步减少 J-TEXT 与 EAST 装置间差异；对数
据做更准确的标注，提高数据质量；并在估计 EAST 放电特征分布的均值与标准差
做 z-score 标准化，实现了无需 EAST 数据的跨装置破裂预测模型。


                           115
     华 中 科 技 大 学 博 士 学 位 论 文

6.3 展望

  本工作将物理驱动与数据驱动相结合，开发了可解释性，可迁移性更强的破裂预
测模型。基于本工作，还可以开展更深入的破裂预测研究：
  （1） 将基于托卡马克物理特征的机器学习破裂预测算法推广至其他装置
  本工作提出的基于托卡马克物理特征的机器学习破裂预测算法已成功在 J-
TEXT 与 EAST 两个托卡马克装置上得以实现。希望可以将该算法推广至更多托卡
马克装置上，以体现该算法的可靠性与通用性。该算法的可解释性研究功能可以研究
不同托卡马克间的共有破裂前兆与破裂物理，为破裂机理研究提供帮助。提取物理特
征时，需要对目标装置上的诊断系统与基本的物理现象有充分的理解，是将该算法应
用于其他装置的潜在挑战。
  （2） 深入研究破裂预测模型的可解释性
  本工作采用的模型目前仅为初步将物理与数据结合的研究方法，主要体现在物
理对算法和模型设计上的指导。物理与数据更深度的结合，可以开发深度模型探索并
学习物理规律的算法与模型，通过深度学习与物理公式的结合学习物理机理，提高模
型的泛化性。并对该模型做深度可解释性研究，发现新物理机理。基于类似本工作中
SHAP 给出的破裂贡献度，只要模型能给出破裂贡献随时间的演化，便可以开发基于
可解释破裂预测的破裂缓解方案，实时获得不同破裂特征给出的贡献度，不仅能判断
是否即将破裂，还可以知道破裂原因，介入辅助系统进行破裂防护与破裂避免。
  （3） 研究破裂预测乃至可控核聚变大模型的实现
  在如今的人工智能大模型时代，开发可控核聚变领域的大模型可以进一步破裂
预测模型的准确率与泛化能力。若拥有足够多的现有托卡马克运行数据，传统机器学
习会随着数据量的增多逐渐达到模型的训练瓶颈。而利用基于 transformer 的 BERT
模型，GPT 模型或生成模型，可以开发能模拟托卡马克放电的预训练模型，并微调
出破裂预测模型以及其他的实用模型。




                      116
       华 中 科 技 大 学 博 士 学 位 论 文

                  致         谢

  四年的时光如白驹过隙，首先要感谢我的母亲，在物质与精神上均给予了我极大
的支持，是我最坚强的后盾。
  由衷的感谢我的导师丁永华教授，丁老师治学严谨，视野开阔，有着崇高的学术
理想，丰富的学术经验。丁老师不仅悉心指导我的学术研究，还注重培养我的综合素
质，并且乐于倾听并指导我人生中遇到的困难，是我学术和人生的引路人。丁老师指
导了我博士课题的大方向，指出需要将物理融入进机器学习中，这是我博士课题的主
旋律。丁老师谦逊低调的品格，具有前瞻性的学术敏锐度也是我学习的榜样。
  衷心的感谢我的导师郑玮老师，郑老师年轻有为，作为青年科学家能与年轻的学
生们打成一片，既是我的导师，也是我的朋友。郑老师的思维非常活跃，脑中有永远
沸腾的新奇想法，启发了我博士课题中实现目标的各种方法。郑老师的编程功底十分
扎实，经常能从结果中抽丝剥茧，一语道出我在程序中造成的问题。在一次国际会议
中，由于我发烧卧床，郑老师白天开会，晚上照顾我这个病人，对此非常感激。
  感谢高丽老师与偏振仪组的小伙伴。高丽老师有丰富的激光工程与密度极限物
理经验，只要是偏振仪的问题，最终都可以在高老师那里找到答案，与高老师在密度
极限物理实验的讨论为我的博士课题提供了丰富的启发与物理理解。
  感谢合作的单位中科院等离子体物理研究所的肖炳甲教授、沈飚教授、陈大龙老
师、郭笔豪老师提供的 EAST 数据以及学术交流与讨论；感谢核工业西南物理研究
院夏凡教授与杨宗谕老师在博士论文课题上的深入讨论；感谢麻省理工学院 Cristina
Rea 教授与朱劲翔博士在跨装置破裂预测以及破裂数据库上的学术探讨。
  感谢实验室同学和工作人员的帮助和陪伴。感谢王能超老师在博士培养计划和
平时生活和学习中的帮助；周松、李达、黄卓和李建超老师在生活和学术讨论中的倾
囊相授；艾鑫坤、薛凤鸣、钟昱和罗润玉一起调试模型讨论结果，以及组会上的头脑
风暴；扰动场组的全体小伙伴毛飞越、李杨波、赵传旭、李述豪、任正康、贾若、何
莹、胡博、侯张蓉、唐智俞、姚昕晨、余雷等在生活和工作中的共同合作与进步；偏
振仪组的小伙伴杨庆隆、王钰涵、陶沁琳、陈彦秋、林伟杰在偏振仪诊断工作中给予
的帮助。
  最后要感谢我的女朋友徐佳歆，与我一起度过了大半博士时光，并在生活上包容
理解我的情绪。
  有了你们的帮助和陪伴，我的学位课题才得以完成，再次由衷感谢你们！




                      117
           华 中 科 技 大 学 博 士 学 位 论 文

                                            参考文献

[1]    ITER Physics Basis Editors, et al. ITER Physics Basis, Chapter 1: Overview and summary[J].
       Nuclear Fusion, 1999, 39(12): 2137.01-237.39.
[2]    K. Ikeda. Progress in the ITER Physics Basis[J]. Nuclear Fusion, 2007, 47(6): E01-E03.
[3]    ITER Physics Expert Group on Disruptions, et al. ITER Physics Basis, Chapter 3: MHD stability,
       operational limits and disruptions[J]. Nuclear Fusion, 1999, 39(12): 2251-2390.
[4]    T. C. Hender, J.C Wesley, J. Bialek, et al. ITER Physics Basis, Chapter 3: MHD stability,
       operational limits and disruptions[J]. Nuclear Fusion, 2007, 47(6): S128 -S202.
[5]    邱励俭. 聚变能及其应用[M]. 北京: 科学出版社, 2007
[6]    马腾才，胡希伟，陈银华. 等离子体物理原理[M]. 合肥: 中国科学技术大学出版社, 2012
[7]    朱士尧. 核聚变原理[M]. 合肥: 中国科学技术大学出版社, 1992
[8]    Stocker, T. F., D. Qin, G.-K. Plattner, et al. Intergovernmental Panel on Climate Change, Climate
       Change 2013: The Physical Science Basis[EB/OL]. [2013]. http://www.ipcc.ch.
[9]    A. H. Boozer, Theory of tokamak disruptions[J]. Physics of Plasmas, 2012, 19(5): 058101.01-
       058101.26.
[10]   M. Sugihara, M. Shimada, H. Fujieda, et al. Disruption scenarios, their mitigation and operation
       window in ITER[J]. Nuclear Fusion, 2007, 47(4): 337-353.
[11]   INTERNATIONAL ATOMIC ENERGY AGENCY, Summary of the ITER Final Design Report,
       ITER EDA Documentation Series No. 22[R], Vienna: IAEA, 2001.
[12]   V. Riccardo, A. Loarte and the JET EFDA Contributors. Timescale and magnitude of plasma
       thermal energy loss before and during disruptions in JET[J]. Nuclear Fusion, 2005, 45(11): 1427-
       1439.
[13]   M. Lehnen, A. Alonso, G. Arnoux, et al. Disruption mitigation by massive gas injection in JET
       [J]. Nuclear Fusion, 2011, 51(12): 123010.1-123010.12.
[14]   R. S. Granetz, E.M. Hollmann, D.G. Whyte, et al. Gas jet disruption mitigation studies on Alcator
       C-Mod and DIII-D [J]. Nuclear Fusion, 2007, 47(9):1086-1092.
[15]   G. Pautasso, M. Bernert, M. Dibon, et al. Disruption mitigation by injection of small quantities
       of noble gas in ASDEX Upgrade[J]. Plasma Physics and Controlled Fusion, 2017, 59(1):
       014046.01-014046.11.
[16]   G. F. Matthews, B. Bazylev, A. Baron-Wiechec, et al. Melt damage to the JET ITER-like Wall
       and divertor[J]. Physica Scripta, 2016, 2016(T167): 014070.01-014070.07.
[17]   M.N. Rosenbluth and S.V. Putvinski. Theory for avalanche of runaway electrons in tokamaks[J].
       Nuclear Fusion, 2002, 37(10):1355-1363.
[18]   R. Yoshino, S. Tokuda and Y. Kawano. Generation and termination of runaway electrons at major
       disruptions in JT-60U[J]. Nuclear Fusion, 1999, 39(2): 151-162.



                                                  118
           华 中 科 技 大 学 博 士 学 位 论 文

[19]   R.D. Gill, B. Alper, M. de Baar, et al. Behaviour of disruption generated runaways in JET[J].
       Nuclear Fusion, 2011, 42(8):1039-1045.
[20]   M. Lehnen, D. J. Campbell, S. Maruyama, et al., Control, detection and mitigation of disruptions
       on ITER[J]. IEEE 26th Symposium on Fusion Engineering (SOFE), 2015, Austin, TX, USA: 1-
       8.
[21]   J. Vega, A. Murari, S. Dormido-Canto, et al. Adaptive high learning rate probabilistic disruption
       predictors from scratch for the next generation of tokamaks[J]. Nuclear Fusion, 2014, 54(12):
       123001.01-123001.18.
[22]   G. Pautasso, P.C. de Vries, D. Humphreys, et al. The ITER disruption mitigation trigger:
       developing its preliminary design[J]. Nuclear Fusion, 2018, 58(3): 036011.01-036011.14.
[23]   P.C. de Vries, M.F. Johnson, B. Alper, et al. Survey of disruption causes at JET[J]. Nuclear
       Fusion, 2011, 51(5): 053018.01-053018.13.
[24]   E.J. Strait, J.L. Barr, M. Baruzzo, et al. Progress in disruption prevention for ITER[J]. Nuclear
       Fusion, 2019, 59(11): 112012.01-112012.12.
[25]   P. C. de Vries, G. Pautasso, D. Humphreys, et al. Requirements for Triggering the ITER
       Disruption Mitigation System[J]. Fusion Science and Technology, 2016, 69(2): 471–484.
[26]   M. Shimada, D.J. Campbell, V. Mukhovatov, et al. Chapter 1: Overview and summary[J]. Nucl.
       Fusion, 2007, 47: S1-S17.
[27]   D. J. Ward. The physics of DEMO[J]. Plasma Physics and Controlled Fusion, 2010, 52(12):
       124033.01-124033.12.
[28]   A. J. Creely, M. J. Greenwald, S. B. Ballinger, et al. Overview of the SPARC tokamak[J]. Journal
       of Plasma Physics, 2020, 86(5):865860502.01-865860502.25.
[29]   杨宗谕, 基于深度学习的托卡马克放电破裂预测先进算法研究[D]: 博士学位论文. 北京：
       清华大学, 2022.
[30]   J. Vega, R. Moreno, A. Pereira, et al. Advanced Disruption Predictor Based On The Locked Mode
       Signal: Application To Jet. Proceedings of 1st EPS conference on Plasma Diagnostics, 240 [R].
       Italy: ECPD, 2016.
[31]   M.K. Zedda, D. Testa, B. Cannas, et al. An example of a new approach for the development of
       Disruption Protection Tools for JET: the mode-lock disruption class. 34th EPS Conference on
       Plasma Physics, EFDA-JET-CP(07)03/70[R]. Poland: EPS, 2007.
[32]   L. Spolladore, R. Rossi, I. Wyss, et al., Detection of MARFEs using visible cameras for
       disruption prevention[J]. Fusion Engineering and Design, 2023, 190(4):113507.01-113507.05.
[33]   A. Pau, A. Fanni, B. Cannas, et al. A first analysis of jet plasma profile-based indicators for
       disruption prediction and avoidance[J]. IEEE Transactions on Plasma Science, 2018, 46(7):
       2691-2698.
[34]   R. Rossi, M. Gelfusa, J. Flanagan, et al., Development of robust indicators for the identification
       of electron temperature profile anomalies and application to JET[J]. Plasma Physics and
       Controlled Fusion, 2022, 64(4): 045002.01-045002.19.



                                                  119
           华 中 科 技 大 学 博 士 学 位 论 文

[35]   Riccardo Rossi, Michela Gelfusa, T. Craciunescu, et al. A systematic investigation of radiation
       collapse for disruption avoidance and prevention on JET tokamak[J]. Matter and Radiation at
       Extremes, 2023, 8(4): 046903.01-046903.21.
[36]   J. W. Berkery, S. A. Sabbagh, R. E. Bell, et al. A reduced resistive wall mode kinetic stability
       model for disruption forecasting[J]. Physics of Plasmas, 2017, 24:056103.01-056103.10.
[37]   J. W. Berkery, S. A. Sabbagh, J.D. Riquezes, et al. Characterization and forecasting of global and
       tearing mode stability for tokamak disruption avoidance. 44th EPS Conference on Plasma
       Physics P1.138[R], Belfast: EPS, 2017.
[38]   S.A. Sabbagh, J.W. Berkery, Y.S. Park, et al. Disruption event characterization and forecasting in
       tokamaks. IAEA Fusion Energy Conference, IAEA-CN-286/1025[R]. Gandhinagar: IAEA ,
       2018.
[39]   S.A. Sabbagh, J.W. Berkery, Y.S. Park, et al. Disruption event characterization and forecasting in
       tokamaks[J]. Physics of Plasmas, 2023, 30: 032506.01-032506.13.
[40]   D. Wroblewski, G.L. Jahns and J.A. Leuer. Tokamak disruption alarm based on a neural network
       model of the highbeta limit[J]. Nuclear Fusion, 1997, 37(6):725-742.
[41]   C. Rea, R.S. Granetz, K. Montes, et al. Disruption prediction investigations using machine
       learning tools on DIII-D and Alcator C-Mod[J]. Plasma Physics and Controlled Fusion, 2018,
       60(8): 084004.01-084004.13.
[42]   C. Rea, K. Montes, K. Erickson, et al. A realtime machine learningbased disruption predictor in
       DIIID[J]. Nuclear fusion, 2019, 59(9):096016.01-1096016.10.
[43]   B. Cannas, A. Fanni, P. Sonato et al. A prediction tool for realtime application in the disruption
       protection system at JET[J]. Nuclear Fusion, 2007, 47(11):1559-1569.
[44]   B. Cannas, A. Fanni, A. Murari, et al. Overview of manifold learning techniques for the
       investigation of disruptions on JET[J]. Plasma Physics and Controlled Fusion, 2014, 56(11):
       114005.01-114005.14.
[45]   B. Cannas, A. Fanni, E. Marongiu, et al. Disruption forecasting at jet using neural networks[J].
       Nuclear Fusion, 2004, 44(1):68-76.
[46]   M. Lungaroni, A. Murari, E. Peluso, et al. On the potential of ruledbased machine learning for
       disruption prediction on JET[J]. Fusion Engineering and Design, 2018, 130(MAY):62-68.
[47]   R. Tinguely, K. Montes, C. Rea, et al. An application of survival analysis to disruption prediction
       via random forests[J]. Plasma Physics and Controlled Fusion, 2019, 61(9):095009.01-095009.12.
[48]   T. Yokoyama, Y. Miyoshi, R. Hiwatari, et al. Prediction of highbeta disruptions in JT60U based
       on sparse modeling using exhaustive search[J]. Fusion Engineering and Design, 2019, 140
       (MAR.):67-80.
[49]   Yoshino R. Neuralnet disruption predictor in JT60U[J]. Nuclear Fusion, 2003, 43(12): 1771-
       1786, 2003.
[50]   B. Cannas, A. Fanni, G. Pautasso, et al. An adaptive realtime disruption predictor for ASDEX
       upgrade[J]. Nuclear Fusion, 2010, 50(7):075004.01-075004.12.



                                                   120
           华 中 科 技 大 学 博 士 学 位 论 文

[51]   F.C. Morabito, M. Versaci, G. Pautasso, et al. Fuzzyneural approaches to the prediction of
       disruptions in ASDEX upgrade[J]. Nuclear Fusion, 2001, 41(11):1715-1723.
[52]   Y. Zhong, W. Zheng, Z. Chen, et al. Disruption prediction and model analysis using LightGBM
       on J-TEXT and HL-2A[J]. Plasma Physics and Controlled Fusion, 2021, 63(7):075008.01-
       075008.11.
[53]   Z. Yang, F. Xia, X. Song, et al. A disruption predictor based on a 1.5-dimensional convolutional
       neural network in HL-2A[J]. Nucl. Fusion, 2020, 60(1): 016017.01-016017.11.
[54]   Z. Yang, F. Xia, X. Song, et al. In-depth research on the interpretable disruption predictor in HL-
       2A[J]. Nuclear Fusion, 2021, 61(12): 126042.01-126042.07.
[55]   黄尧，夏凡，杨宗谕等. 基于深度学习的 ELM 实时识别研究[J]. 核聚变与等离子体物理,
       2020, 4: 300-308.
[56]   郭笔豪. EAST 托卡马克的等离子体破裂预测研究[D]: 博士学位论文. 合肥：中国科学技
       术大学, 2021.
[57]   B. Guo, B. Shen, D. Chen, et al. Disruption prediction using a full convolutional neural network
       on EAST[J]. Plasma Physics and Controlled Fusion, 2021, 63(2): 025008.01-025008.13.
[58]   J.V. Hernandez, A. Vannucci, T. Tajima, et al. Neural network prediction of some classes of
       tokamak disruptions[J]. Nuclear Fusion, 1996, 36(8):1009-1018.
[59]   A. Vannucci, K.A. Oliveira and T. Tajima, et al. Forecast of TEXT plasma disruptions using soft
       x rays as input signal in a neural network[J]. Nuclear Fusion, 1999, 39(2):255-262.
[60]   钟昱. J-TEXT 和 HL-2A 装置上基于决策树的等离子体破裂预测与破裂缓解研究[D]: 硕士
       学位论文. 武汉：华中科技大学, 2021.
[61]   胡斐然. J-TEXT 实时破裂预测与避免系统设计与实现[D]: 博士学位论文. 武汉：华中科
       技大学, 2018.
[62]   王绅阳. J-TEXT 等离子体破裂预测及破裂缓解系统研究[D]: 硕士学位论文. 武汉：华中
       科技大学, 2016.
[63]   吴其其. 基于深度学习异常检测的等离子体破裂预测[D]: 硕士学位论文. 武汉：华中科技
       大学, 2021.
[64]   W. Zheng, F. Hu, M. Zhang, et al. Hybrid neural network for density limit disruption prediction
       and avoidance on J-TEXT tokamak[J]. Nuclear Fusion, 2018, 58(5): 056016.01-056016.11.
[65]   W. Zheng, Q. Wu, M. Zhang, et al. Disruption predictor based on neural network and anomaly
       detection on J-TEXT[J]. Plasma Physics and Controlled Fusion, 2020, 62(4): 045012.01-
       045012.08.
[66]   Y. Ding, X. Jin, Z. Chen, et al. Neural network prediction of disruptions caused by locked modes
       on J-TEXT tokamak[J]. Plasma Science and Technology, 2013, 15(11):1154-1159.
[67]   S. Wang, Z. Chen, D. Huang, et al. Prediction of density limit disruptions on the J-TEXT
       tokamak[J]. Plasma Physics and Controlled Fusion, 2016, 58(5): 055014.01-055014.10.
[68]   G. Rattá, J. Vega, A. Murari, et al. An advanced disruption predictor for JET tested in a simulated


                                                   121
           华 中 科 技 大 学 博 士 学 位 论 文

       realtime environment[J]. Nuclear Fusion, 2010, 50(2): 025005.01-025005.10.
[69]   J.M. López, J. Vega, D. Alves, et al. Implementation of the disruption predictor apodis in jet’s
       realtime network using the marte framework[J]. IEEE Transactions on Nuclear Science, 2014,
       61(2):741-744.
[70]   J. Vega, S. Dormido-Canto, J.M. López, et al. Results of the JET real-time disruption predictor
       in the ITER-like wall campaigns[J]. Fusion Engineering and Design, 2013, 88(6-8): 1228-1231.
[71]   A. Piccione, J.W. Berkery, S.A. Sabbagh, et al. Physics-guided machine learning approaches to
       predict the ideal stability properties of fusion plasmas[J]. Nucl. Fusion, 2020, 60(4): 046033.01-
       046033.14.
[72]   G. A. Rattá, J. Vega, A. Murari. Viability Assessment of a Cross-Tokamak AUG-JET Disruption
       Predictor[J]. Fusion Science and Technology, 2018, 74(1–2): 13-22.
[73]   P.C. de Vries, G. Pautasso, E. Nardon, et al. Scaling of the MHD perturbation amplitude required
       to trigger a disruption and predictions for ITER[J]. Nuclear Fusion, 2015, 56(2): 026007.01-
       026007.10.
[74]   G. Sias, B. Canna, A. Fanni, et al. A locked mode indicator for disruption prediction on JET and
       ASDEX upgrade[J]. Fusion Engineering and Design, 2019, 138: 254-266.
[75]   S. Dormido-Canto, J. Vega, J.M. Ramírez, et al. Development of an efficient real-time disruption
       predictor from scratch on JET and implications for ITER[J]. Nucl. Fusion, 2013, 53(11):
       113001.01-113001.08.
[76]   A. Murari, R. Rossi, E. Peluso, et al. On the transfer of adaptive predictors between different
       devices for both mitigation and prevention of disruptions[J]. Nucl. Fusion, 2020, 60(5):
       056003.01-056003.18.
[77]   J. Kates-Harbeck, A. Svyatkovskiy and W. Tang. Predicting disruptive instabilities in controlled
       fusion plasmas through deep learning[J]. Nature, 2019, 568: 526-531.
[78]   J.X. Zhu, C. Rea, K. Montes, et al. Hybrid deep-learning architecture for general disruption
       prediction across multiple tokamaks[J]. Nucl. Fusion, 2021, 61(2): 026007.01-026007.16.
[79]   J.X. Zhu, C. Rea, R.S. Granetz, et al. Scenario adaptive disruption prediction study for next
       generation burning-plasma tokamaks[J]. Nucl. Fusion, 2021, 61(11): 114005.01-114005.12.
[80]   B. Guo, D. Chen, C. Rea, et al. Disruption prediction on EAST with different wall conditions
       based on a multi-scale deep hybrid neural network[J]. Nuclear Fusion, 2023, 63(9): 094001.01-
       094001.12.
[81]   W. Zheng, F. Xue, Z. Chen, et al. Disruption prediction for future tokamaks using parameter-
       based transfer learning[J]. Communications Physics, 2023, 6: 181-193.
[82]   S. J. Pan and Q. Yang. A Survey on Transfer Learning[J]. IEEE Transactions on Knowledge and
       Data Engineering, 2010, 22(10): 1345-1359.
[83]   J. Wang, C. Lan, C. Liu, et al. Generalizing to Unseen Domains: A Survey on Domain
       Generalization[J]. IEEE Transactions on Knowledge and Data Engineering, 2023, 35(8): 8052-
       8072.



                                                  122
           华 中 科 技 大 学 博 士 学 位 论 文

[84]   A. Vaswani, N. Shazeer, N. Parmar, et al. Attention Is All You Need[J]. 31st Conference on Neural
       Information Processing Systems, 2017, 5998-6008.
[85]   J. Devlin, M. Chang, K. Lee, et al. BERT: Pre-training of Deep Bidirectional Transformers for
       Language Understanding[J]. Proceedings of the 2019 Conference of the North American Chapter
       of the Association for Computational Linguistics: Human Language Technologies (NAACL-
       HLT), 2019, 4171-4186.
[86]   A. Radford, K. Narasimhan, T. Salimans, et al. Improving Language Understanding by
       Generative Pre-Training [EB/OL]. [2018-06]. https://cdn.openai.com/research-covers/language-
       unsupervised/language_understanding_paper.pdf
[87]   A. Radford, et al. Language Models are Unsupervised Multitask Learners[EB/OL]. [2019-02].
       https://cdn.openai.com/better-language-models/language models are unsupervised multitask
       learners.pdf
[88]   T. Brown, B. Mann, N. Ryder, et al. Language Models are Few-Shot Learners[J]. 34th
       International Conference on Neural Information Processing Systems, 2020, 159: 1877-1901.
[89]   A. Dosovitskiy, et al. An Image is Worth 16x16 Words: Transformers for Image Recognition at
       Scale[EB/OL]. [2021-06-03]. https://doi.org/10.48550/arXiv.2010.11929
[90]   R. Rombach, A. Blattmann, D. Lorenz, et al. High-Resolution Image Synthesis with Latent
       Diffusion Models[EB/OL]. [2022-04-13]. https://doi.org/10.48550/arXiv.2112.10752
[91]   A. Radford, J. W. Kim, C. Hallacy, et al. Learning Transferable Visual Models From Natural
       Language Supervision[EB/OL]. [2021-02-26]. https://doi.org/10.48550/arXiv.2103.00020
[92]   A. Ramesh, M. Pavlov, G. Goh, et al. Zero-Shot Text-to-Image Generation[EB/OL]. [2021-02-
       26]. https://doi.org/10.48550/arXiv.2102.12092
[93]   Y. Lecun, L. Bottou, Y. Bengio, et al. Gradient-Based Learning Applied to Document
       Recognition[J]. Proceedings of the IEEE, 1998, 86(11): 2278-2324.
[94]   A. Murari, E. Peluso, M. Lungaroni , et al. Investigating the physics of tokamak global stability
       with interpretable machine learning tools[J]. Applied Sciences, 2020, 10(19): 6683.01-6683.22.
[95]   J. Vega, A. Murari, S. Dormido-Canto, et al. Disruption prediction with artificial intelligence
       techniques in tokamak plasmas[J]. Nature Physics, 2022, 18: 741-750.
[96]   G.A. Rattá, J. Vega and A. Murari Improved feature selection based on genetic algorithms for
       real time disruption prediction on JET[J]. Fusion Engineering and Design, 2012, 87(9): 1670-
       1678.
[97]   D.R. Ferreira, T.A. Martins and P. Rodrigues Explainable deep learning for the analysis of MHD
       spectrograms in nuclear fusion[J]. Machine Learning: Science and Technology, 2022, 3(1):
       015015.01-015015.11.
[98]   K. Olofsson, D. Humphreys and R. La Haye. Event hazard function learning and survival analysis
       for tearing mode onset characterization[J]. Plasma Physics and Controlled Fusion, 2018, 60(8):
       084002.01-084002.10.
[99]   A. Pau, A. Fanni, S. Carcangiu, et al. A machine learning approach based on generative



                                                  123
           华 中 科 技 大 学 博 士 学 位 论 文

       topographic mapping for disruption prevention and avoidance at JET[J]. Nuclear Fusion, 2019,
       59(10): 106017.01-106017.22.
[100] E. Aymerich, A. Fanni, G. Sias, et al. A statistical approach for the automatic identification of the
      start of the chain of events leading to the disruptions at JET[J]. Nucl. Fusion, 2021, 61(3):
      036013.01-036013.20.
[101] C. Rea, K.J. Montes, A. Pau, et al. Progress toward interpretable machine learning-based
      disruption predictors across tokamaks[J]. Fusion Science and Technology, 2020, 76(8), 912–924.
[102] Y. Tay, M. Dehghani, S. Abnar, et al. Scaling laws vs model architectures: how does inductive
      bias influence scaling?[EB/OL]. [2022-07-21]. https://doi.org/10.48550/arXiv.2207.10551
[103] G. Wilson and D. Cook. A Survey of Unsupervised Deep Domain Adaptation[J]. ACM
      Transactions on Intelligent Systems and Technology, 2020, 11(5): 1-46.
[104] M. Wang and W. Deng. Deep visual domain adaptation: A survey[J]. Neurocomputing, 2018,
      312: 135-153.
[105] A. Ramponi and B. Plank. Neural Unsupervised Domain Adaptation in NLP—A Survey[J].
       Proceedings of the 28th International Conference on Computational Linguistics,2020, 6838-
       6855.
[106] H. He and D. Wu. Different Set Domain Adaptation for Brain-Computer Interfaces: A Label
      Alignment Approach[J]. IEEE Transactions on Neural Systems and Rehabilitation Engineering,
      2020, 28(5): 1091-1108.
[107] C. Chen, O. Li, C. Tao, et al. This looks like that: deep learning for interpretable image
      recognition[J] 33rd International Conference on Neural Information Processing Systems, 2019,
      801: 8930-8941.
[108] C. Rudin. Stop explaining black box machine learning models for high stakes decisions and use
      interpretable models instead[J]. Nature Machine Intelligence, 2019, 1: 206-215.
[109] A. Davies, P. Veličković, L. Buesing, et al. Advancing mathematics by guiding human intuition
      with AI[J]. Nature, 2021, 600: 70-74.
[110] M.T. Ribeiro, S. Singh and C. Guestrin. 'Why should I trust you?': explaining the predictions of
      any classifier[J]. 22nd ACM SIGKDD International Conference on Knowledge Discovery and
      Data Mining, 2016, 1135-1144.
[111] R.K. Mothilal, D. Mahajan, C. Tan, et al. Towards unifying feature attribution and counterfactual
      explanations: different means to the same end[J]. 2021 AAAI/ACM Conference on on AI, Ethics,
      and Society, 2021, 652-663.
[112] S. Lundberg and S.-I. Lee. A unified approach to interpreting model predictions[J]. 31st
      International Conference on Neural Information Processing Systems, 2017, 4768–4777.
[113] S.M. Lundberg, B. Nair, M. S. Vavilala, et al. Explainable machine-learning predictions for the
      prevention of hypoxaemia during surgery[J]. Nature Biomedical Engineering, 2018, 2: 749-760.
[114] 沈呈硕. J-TEXT 托卡马克装置磁诊断误差研究与优化[D]: 硕士学位论文, 武汉：华中科
       技大学, 2020.



                                                   124
           华 中 科 技 大 学 博 士 学 位 论 文

[115] 李建超. J-TEXT 上锯齿振荡行为的实验研究[D]: 博士学位论文, 武汉：华中科技大学,
      2017.
[116] 张晓龙. J-TEXT 装置上低 Z 杂质行为实验研究[D]: 博士学位论文. 武汉：华中科技大学,
      2017.
[117] 陈杰. J-TEXT 三波远红外激光偏振干涉仪的建立[D]: 博士学位论文. 武汉：华中科技大
      学, 2013.
[118] 柳强. 下一代托卡马克实验数据分布式存储技术研究[D]: 博士学位论文. 武汉：华中科技
      大学, 2018.
[119] T. Fredian, J. Stillerman, G. Manduchi, et al. MDSplus yesterday, today and tomorrow[J]. Fusion
      Engineering and Design, 2018, 127: 106-110.
[120] T. W. Fredian and J. A. Stillerman. MDSplus. Current developments and future directions[J].
      Fusion Engineering and Design, 2002, 60(3): 229-233.
[121] B. Sun, J. Feng and K. Saenko. Return of Frustratingly Easy Domain Adaptation[J]. Thirtieth
      AAAI Conference on Artificial Intelligence, 2016, AAAI Press: 2058–2065.
[122] X.K. Ai, W. Zheng, M. Zhang, et al. Tokamak plasma disruption precursor onset time study based
      on semi-supervised anomaly detection[J]. Nuclear Engineering and Technology, 2024, 56(4):
      1501-1512.




                                                125
     华 中 科 技 大 学 博 士 学 位 论 文

              附录 1   答辩委员会决议

  2024 年 8 月 16 日下午，答辩委员会线下会议听取了沈呈硕同学对博士学位论文
《基于托卡马克物理特征的机器学习跨装置破裂预测研究》的答辩。委员们对该论文
进行了质询、讨论与表决投票，形成答辩意见如下：
  沈呈硕同学的博士学位论文研究了基于托卡马克物理特征的机器学习跨装置破
裂预测，选题对聚变堆安全稳定运行具有重要意义。主要创新点如下：
  (1) 提出基于物理指导的特征提取算法、建立了可解释的 J-TEXT 破裂预测模型，
在 J-TEXT 上实现了准确的破裂预测；
  (2) 发展基于领域自适应的迁移方法，解决了现有跨装置模型数据利用效率低的
问题，实现了从 J-TEXT 到 EAST 的跨装置破裂预测；
  (3) 引入 SHAP 模型，开展了破裂预测的可解释性研究，发现 J-TEXT 实验中的
磁扰动提升密度极限等破裂物理新规律。
  该论文结构合理，逻辑清晰，创新点突出，达到了工学博士论文要求。论文答辩
过程中，沈呈硕同学表述清楚，回答问题准确，表明其在破裂预测领域具有扎实的理
论基础和创新能力。
  经答辩委员会全体成员讨论并以无记名投票方式表决，一致同意通过答辩，建议
授予工学博士学位。


答辩总体评价（请按百分制）：94



                     答辩委员会主席（签名）：


                     答辩日期： 2024 年 8 月 16 日




                        126
            华 中 科 技 大 学 博 士 学 位 论 文

                附录 2          攻读博士学位期间取得的研究成果

第一作者发表论文：
[1] Chengshuo Shen, Wei Zheng, Bihao Guo, Yonghua Ding, Dalong Chen, Xinkun Ai, Fengming Xue,
     Yu Zhong, Nengchao Wang, Biao Shen, Binjia Xiao, Zhongyong Chen, Yuan Pan and J-TEXT Team.
     Cross-tokamak Disruption Prediction based on domain adaptation[J]. Nuclear Fusion, 2024, 64:
     066036. (SCI 源刊；IF:3.5；中科院一区 TOP；署名单位:华中科技大学)
[2] Chengshuo Shen, Wei. Zheng, Yonghua Ding, Xinkun Ai, Fengming Xue, Yu Zhong, Nengchao
     Wang, Li Gao, Zhipeng Chen, Zhoujun Yang, Zhongyong Chen, Yuan Pan and J-TEXT team. IDP-
     PGFE: an interpretable disruption predictor based on physics-guided feature extraction[J]. Nuclear
     Fusion, 2023, 63: 046024. (SCI 源刊；IF:3.5；中科院一区 TOP；署名单位:华中科技大学)
[3] Chengshuo Shen, Wei Zheng, Bihao Guo, Dalong Chen, Xinkun Ai, Fengming Xue, Yu Zhong,
     Nengchao Wang, Biao Shen, Binjia Xiao, Yonghua Ding, Zhongyong Chen, Yuan Pan and J-TEXT
     team. In-depth research on the interpretability and fewer data learning for the disruption predictor
     in J-TEXT. 49th EPS Conference on Contr. Fusion and Plasma Phys, P4.016[R], Bordeaux: EPS,
     2023. (EI 源刊；磁约束等离子体领域会议；署名单位:华中科技大学)
[4] Chengshuo Shen, Wei Zheng, Bihao Guo, Xinkun Ai, Fengming Xue. Role of Human Input in
     Cross-tokamak Disruption Prediction in Magnetic Confinement Fusion. 38th Annual Conference on
     Neural Information Processing Systems[R], Vancouver: NeurIPS, 2024. (人工智能 ccf-a 类会议；
     审稿中；署名单位:华中科技大学)

第一作者参加国内外会议：
[1] Poster, Predicting disruption in future tokamaks with fewer data by more physics-guided, Workshop
     on Artificial Intelligence for Accelerating Fusion and Plasma Science. Vienna, Austria (2023).
[2] Poster, In-depth research on the interpretability and fewer data learning for the disruption predictor
     in J-TEXT, 49th Conference on Plasma Physics of the European Physical Society (EPS). Bordeaux,
     France (2023).
[3] Oral, Disruption prediction based on disruptive-related feature extraction in J-TEXT and EAST,
     4th IAEA Technical Meeting on Fusion Data Processing, Validation and Analysis. Virtual (2021).
[4] 口头报告, Predicting disruption with fewer data for next generation tokamaks by physics-guided
     approach, 第二届受控聚变与人工智能会议. 成都，中国, (2023). 最佳报告
[5] 口头报告, Machine learning disruption prediction based on physics feature extraction, 第一届受
     控聚变与人工智能会议. 成都，中国, (2021).




                                                   127
           华 中 科 技 大 学 博 士 学 位 论 文

合作发表论文：
[1] Yanqiu Chen, Chengshuo Shen, Li Gao, Zhongyong Chen, Qinlin Tao, Yuhan Wang, Weijie Lin,
    Wei Zheng, Zhoujun Yang, Zhipeng Chen, Yuan Pan. Faraday angle prediction based on 1-D CNN
    on the J-TEXT tokamak[J]. Fusion Engineering and Design, 2024, 199: 114101. (SCI 源刊；IF:1.9)
[2] Dongliang Han, Chengshuo Shen, Nengchao Wang, Da Li, Feiyue Mao, Zhengkang Ren, Yonghua
    Ding and the J-TEXT Team. Magnetic diagnostics for magnetohydrodynamic instability research
    and the detection of locked modes in J-TEXT[J]. Plasma Science and Technology, 2021, 23 (5):
    055104. (SCI 源刊；IF:1.6)
[3] Wei Zheng, Fengming Xue, Chengshuo Shen, Yu Zhong, Xinkun Ai, Zhongyong Chen, Yonghua
    Ding, Ming Zhang, Zhoujun Yang, Nengchao Wang, Zhichao Zhang, Jiaolong Dong, Chouyao Tang
    and Yuan Pan. Overview of machine learning applications in fusion plasma experiments on J-TEXT
    tokamak[J]. Plasma Science and Technology, 2022, 24: 12. (SCI 源刊；IF:1.6)
[4] Wei Zheng, Fengming Xue, Zhongyong Chen, Dalong Chen, Bihao Guo, Chengshuo Shen, Xinkun
    Ai, Nengchao Wang, Ming Zhang, Yonghua Ding, Zhipeng Chen, Zhoujun Yang, Biao Shen, Bingjia
    Xiao and Yuan Pan. Disruption prediction for future tokamaks using parameter-based transfer
    learning[J]. Communications Physics, 2023, 6: 181. (SCI 源刊；IF:5.4)
[5] Wei Zheng, Fengming Xue, Zhongyong Chen, Chengshuo Shen, Xinkun Ai, Yu Zhong, Nengchao
    Wang, Ming Zhang, Yonghua Ding, Zhipeng Chen, Zhoujun Yang and Yuan Pan. Disruption
    prediction based on fusion feature extractor on J-TEXT[J]. Chinese Physics B, 2023, 32 (7): 075203.
    (SCI 源刊；IF:1.5)
[6] Xinkun Ai, Wei Zheng, Ming Zhang, Dalong Chen, Chengshuo Shen, Bihao Guo, Binjia Xiao, Yu
    Zhong, Nnengchao Wang, Zhoujun Yang, Zhipeng Chen, Zhongyong Chen, Yonghua Ding, Yuan
    Pan and J-TEXT team. Tokamak plasma disruption precursor onset time study based on semi-
    supervised anomaly detection[J]. Nuclear Engineering and Technology, 2024, 56 (4): 1501. (SCI 源
    刊；IF:2.6)
[7] Xinkun Ai, Wei Zheng, Ming Zhang, Yonghua Ding, Dalong Chen, Zhongyong Chen, Chengshuo
    Shen, Bihao Guo, Nengchao Wang, Zhoujun Yang, Zhipeng Chen, Yuan Pan, Biao Shen, Binjia
    Xiao. Cross-tokamak deployment study of plasma disruption predictors based on convolutional
    autoencoder[J]. Plasma Physics and Controlled Fusion, 2024, 66: 085015. (SCI 源刊；IF:2.1)
[8] Yu Zhong, Wei Zheng, Zhongyong Chen, Fan Xia, Limin Yu, Qiqi Wu, Xinkun Ai, Chengshuo
    Shen, Zhoujun Yang, Wei Yan, Yonghua Ding, Yunfeng Liang, Zhipeng Chen, Ruihai Tong, Wei
    Bai, Jiangang Fang, Feng Li and J-TEXT team. Disruption prediction and model analysis using
    LightGBM on J-TEXT and HL-2A[J]. Plasma Physics and Controlled Fusion, 2021, 63 (7): 075008.
    (SCI 源刊；IF:2.1)


                                                 128
       华 中 科 技 大 学 博 士 学 位 论 文

     附录 3         公开发表的学术成果与博士学位论文的关系

                                    成果                          与学位论文
序号           成果名称                              成果主要内容
                                    形式                          对应的关系

     IDP-PGFE:                an           介绍物理特征提 取算 法

     interpretable     disruption   期刊     与 J-TEXT 破 裂 预 测 模   对应第 3 章
1
     predictor based on physics-    论文     型，并研究 J-TEXT 模型      与第 5 章
     guided feature extraction             可解释性

     Cross-tokamak Disruption              介绍 跨装置破裂 预测 模
                                    期刊                          对应第 4 章
2    Prediction      based    on           型，并通过可解释性研究
                                    论文                          与第 5 章
     domain adaptation                     证明方法的可靠性
     In-depth research on the              深入研究 J-TEXT 模型的
     interpretability and fewer
                                    会议     可解释性并初步实现 J-         对应第 4 章
3    data   learning    for   the
                                    论文     TEXT 到 EAST 的跨装置     与第 5 章
     disruption predictor in J-
                                           破裂预测
     TEXT




                                         129
       华 中 科 技 大 学 博 士 学 位 论 文

            附录 4       攻读学位期间参加的科研项目

1. 国家重点研发计划
项目名称: 托卡马克 Greenwald 密度极限物理机制的研究
项目编号: 2018YFE0310300
起止时间: 2018 年 12 月至 2023 年 11 月
担任角色：开展密度极限破裂实验研究，并利用可解释性研究密度极限破裂机理
2. 国家重点研发计划课题
课题名称: 破裂避免及逃逸电流软着陆研究
课题编号: 2019YFE03010004
起止时间: 2020 年 12 月至 2025 年 11 月
担任角色：研究 J-TEXT 破裂预测模型
3. 国家重点研发计划课题
课题名称: 基于归一化参数的跨装置破裂预警研究
课题编号: 2022YFE03040004
起止时间: 2021 年 10 月至 2026 年 9 月
担任角色：研究基于托卡马克物理特征的跨装置破裂预测模型




                                 130
         华 中 科 技 大 学 博 士 学 位 论 文

                 附录 5       中英文缩写对照表

AI         Artificial Intelligence（人工智能）
NBI        Neutral Beam Injection（中性束注入）
ICRH       Ion Cyclotron Resonance Heating（离子回旋共振加热）
ECRH       Electron Cyclotron Resonance Heating（电子回旋共振加热）
JET        Joint European Torus（欧洲联合环托卡马克装置）
ITER       International Thermonuclear Experimental Reactor（国际热核聚变实
           验堆）
MHD        magnetohydrodynamic（磁流体动力学）
VDE        vertical displacement event（垂直不稳定性事件）
DMS        Disruption Mitigation System（破裂缓解系统）
PGFE       Physics-Guided Feature Extraction（物理指导的特征提取）
DEMO       Demonstration Power Station（示范发电站项目）
SPARC      Smallest Possible Affordable, Robust, Compact（美国 Commonwealth
           Fusion Systems 公司的高温超导托卡马克）
J-TEXT     Joint- Texas EXperimental Tokamak（华中科技大学运行的中型托卡
           马克）
EAST       Experimental Advanced Superconducting Tokamak（中科院等离子体
           物理研究所运行的全超导托卡马克）
CORAL      CORrelation Alignment（协方差对齐，一种领域自适应算法）
TP         True positive（真阳性）
TN         True negative（真阴性）
FN         False negative（假阴性）
FP         False positive（假阳性）
TPR        True positive rate（真阳率）
FPR        False positive rate（假阳率）


                                 131
         华 中 科 技 大 学 博 士 学 位 论 文

ROC        The receiver operating characteristic curve（接受者操作特性曲线）
AUC        area under the ROC curve（接受者操作特性曲线下的面积）
MARFE      Multifaceted Asymmetric Radiation From the Edge（边缘不对称辐
           射）
DECAF      The Disruption Event Characterization and Forecasting Code（破裂事
           件特征化和预测算法）
DIII-D     Doublet III-D（美国通用原子能公司运行的托卡马克）
C-Mod      Alcator C-Mod（美国麻省理工学院运行的托卡马克）
JT-60U     Japan Torus-60 Upgrade（日本原子能研究开发机构运行的托卡马
           克）
AUG        Axially Symmetric Divertor Experiment Upgrade（德国马克斯普朗克
           研究所运行的托卡马克）
HL-2A      Huan-Liuqi-2A（环流器 2 号 A，中核集团运行的托卡马克）
AOPDIS     Advanced Predictor of DISruptions（先进破裂预测器）
MARTe      Multithreaded Application RealTimeexecutor（多线程应用程序实时执
           行器）
SVM        Support vector machines（支持向量机）
DPRF       Disruption Predictor using Random Forests（随机森林破裂预测器）
CNN        Convolutional Neural Networks（卷积神经网络）
LSTM       Long Short-Term Memory（长短记忆网络）
NSTX       National Spherical Torus eXperiment（美国普林斯顿大学运行的球形
           托卡马克）
MAST       Mega Ampere Spherical Tokamak（英国原子能机构运行的球形托卡
           马克）
FRNN       Fusion Recurrent Neural Network（聚变循环神经网络）
RNN        Recurrent Neural Network（循环神经网络）
HDL        Hybrid deep-learning（混合深度学习结构）


                                 132
       华 中 科 技 大 学 博 士 学 位 论 文

CV         Computer Vision（计算机视觉）
NLP        Natural Language Processing（自然语言处理）
DA         Domain Adaptation（领域自适应）
MMD        Maximum Mean Discrepancy（最大均值差异）
SHAP       SHapley Additive exPlanations（一种解释任何机器学习模型输出的
           博弈论方法）
JDDB       J-TEXT Disruption DataBase（J-TEXT 破裂数据库）
CSD        Cross Spectral Density（互功率谱密度）
SXR        soft x-ray（软 X 射线）
AXUV       Absolute eXtended Ultra Violet（强紫外辐射）
FIR        far-infrared three-wave polarimeter-interferometer（三波远红外偏振干
           涉仪）
HOS        higher-order statistics（高阶统计量）
IDP-PGFE   Interpretable Disruption Predictor based on PGFE（基于 PGFE 的可解
           释破裂预测器）
DART       Dropouts meet Multiple Additive Regression Trees（随机丢弃生成的
           决策树）
GBDT       Gradient boosting decision tree（梯度提升决策树）
MART       Multiple Additive Regression Trees（多加回归树）
RF         Random Forest（随机森林）
MGI        massive gas injection（大量气体注入）
SPI        shattered pellet injection（散列弹丸注入）
DPRS       disruption predictor using raw signals（使用原始信号的破裂预测模
           型）
PCS        Plasma Control System（等离子体控制系统）
SVD        singular value decomposition（奇异值分解）
UDA        Unsupervised Domain Adaptation（无监督的领域自适应）


                                133
         华 中 科 技 大 学 博 士 学 位 论 文

SDA        Supervised Domain Adaptation（有监督的领域自适应）
U-CORAL    Unsupervised CORAL（无监督的 CORAL）
S-CORAL    Supervised CORAL（有监督的 CORAL）
CQ         current quench（电流猝灭）
PGFE-U     PGFE-Upgrade（优化物理指导特征提取）
FLS        Floating labeling Strategy（浮动标签策略，一种准确度更高的标签
           策略）
EFD        Estimation of the Feature Distribution（估计特征分布，估计标准化参
           数）




                             134
