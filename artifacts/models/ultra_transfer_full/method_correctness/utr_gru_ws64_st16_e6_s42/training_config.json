{
  "generated_at_utc": "2026-02-20T11:48:15.407853+00:00",
  "run_name": "utr_gru_ws64_st16_e6_s42",
  "model_name": "gru",
  "device": "cuda",
  "data_root": "G:\\\u6211\u7684\u4e91\u7aef\u786c\u76d8\\Fuison\\data",
  "hdf5_root": "G:\\\u6211\u7684\u4e91\u7aef\u786c\u76d8\\Fuison\\data\\J-TEXT\\unified_hdf5",
  "features": [
    "Bt",
    "CIII",
    "MNM",
    "Mir_VV",
    "Mir_avg_amp",
    "Mir_avg_fre",
    "Z_proxy",
    "dx_a",
    "dy_a",
    "ip",
    "mode_number_n",
    "n=1 amplitude",
    "ne_nG",
    "qa_proxy",
    "sxr_kurt",
    "sxr_mean",
    "sxr_skew",
    "sxr_var",
    "v_loop",
    "xuv_kurt",
    "xuv_ratio",
    "xuv_skew",
    "xuv_var",
    "d1__Bt",
    "d1__CIII",
    "d1__MNM",
    "d1__Mir_VV",
    "d1__Mir_avg_amp",
    "d1__Mir_avg_fre",
    "d1__Z_proxy",
    "d1__dx_a",
    "d1__dy_a",
    "d1__ip",
    "d1__mode_number_n",
    "d1__n=1 amplitude",
    "d1__ne_nG",
    "d1__qa_proxy",
    "d1__sxr_kurt",
    "d1__sxr_mean",
    "d1__sxr_skew",
    "d1__sxr_var",
    "d1__v_loop",
    "d1__xuv_kurt",
    "d1__xuv_ratio",
    "d1__xuv_skew",
    "d1__xuv_var",
    "dr__Bt",
    "dr__CIII",
    "dr__MNM",
    "dr__Mir_VV",
    "dr__Mir_avg_amp",
    "dr__Mir_avg_fre",
    "dr__Z_proxy",
    "dr__dx_a",
    "dr__dy_a",
    "dr__ip",
    "dr__mode_number_n",
    "dr__n=1 amplitude",
    "dr__ne_nG",
    "dr__qa_proxy",
    "dr__sxr_kurt",
    "dr__sxr_mean",
    "dr__sxr_skew",
    "dr__sxr_var",
    "dr__v_loop",
    "dr__xuv_kurt",
    "dr__xuv_ratio",
    "dr__xuv_skew",
    "dr__xuv_var"
  ],
  "feature_count": 69,
  "window": {
    "window_size": 64,
    "stride": 16,
    "eval_stride": 1,
    "strict_method_checks": true
  },
  "feature_engineering": {
    "augment_dynamics": true,
    "dynamics_eps": 1e-06,
    "feature_count_after_augmentation": 69
  },
  "imbalance": {
    "balanced_sampler": true,
    "sampler_applied": true,
    "class_balance": {
      "n_pos": 643,
      "n_neg": 24931
    },
    "pos_weight_value": 1.0,
    "focal_gamma": 1.5
  },
  "optimizer": {
    "epochs": 6,
    "patience": 3,
    "batch_size": 256,
    "learning_rate": 0.001,
    "weight_decay": 0.0001
  },
  "labeling": {
    "gray_ms": 30.0,
    "fallback_fls_ms": 25.0,
    "fallback_dt_ms": 1.0
  },
  "method_audit": {
    "strict_method_checks": true,
    "model_selection_validation_split": "val_calib",
    "calibration_split": "val_calib",
    "threshold_selection_split": "val_thresh",
    "val_partition_expected": [
      "val_calib",
      "val_thresh"
    ]
  },
  "calibration": {
    "method": "isotonic_cv",
    "calibration_shot_fraction": 0.5
  },
  "threshold_policy": {
    "objective": "shot_fpr_constrained_stable",
    "max_shot_fpr": 0.02,
    "theta": 0.9785475792988313,
    "sustain_ms": 3.0,
    "selection_diag": {
      "mode": "fallback_min_fpr",
      "shot_tpr": 0.9473684210526315,
      "shot_fpr": 0.029411764705882353,
      "shot_accuracy": 0.9655172413793104,
      "lead_time_ms_median": 3.025353358158071,
      "objective": "shot_fpr_constrained_stable",
      "base_theta": 0.9801672240802676,
      "base_shot_tpr": 0.9473684210526315,
      "base_shot_fpr": 0.029411764705882353
    }
  },
  "threshold_stability": {
    "num_steps": 600,
    "robust_delta": 0.02,
    "tpr_tolerance": 0.01
  },
  "split_counts": {
    "train_windows": 25574,
    "val_calib_windows": 23803,
    "val_thresh_windows": 23992,
    "test_windows": 46309
  },
  "data_loading_meta": {
    "train": {
      "split_name": "train",
      "requested_shots": 1386,
      "loaded_shots": 1386,
      "missing_shots": [],
      "label_missing_shots": [],
      "feature_errors": [],
      "raw_points_total": 474461,
      "used_points_total": 465493,
      "label_stats": {
        "total": 1386,
        "n_pos": 302,
        "n_neg": 1084
      }
    },
    "val_calib": {
      "split_name": "val_calib",
      "requested_shots": 87,
      "loaded_shots": 87,
      "missing_shots": [],
      "label_missing_shots": [],
      "feature_errors": [],
      "raw_points_total": 29854,
      "used_points_total": 29284,
      "label_stats": {
        "total": 87,
        "n_pos": 19,
        "n_neg": 68
      },
      "rebalance_moves": {
        "to_calib": 0,
        "to_thresh": 0
      }
    },
    "val_thresh": {
      "split_name": "val_thresh",
      "requested_shots": 87,
      "loaded_shots": 87,
      "missing_shots": [],
      "label_missing_shots": [],
      "feature_errors": [],
      "raw_points_total": 29899,
      "used_points_total": 29347,
      "label_stats": {
        "total": 87,
        "n_pos": 19,
        "n_neg": 68
      }
    },
    "test": {
      "split_name": "test",
      "requested_shots": 173,
      "loaded_shots": 173,
      "missing_shots": [],
      "label_missing_shots": [],
      "feature_errors": [],
      "raw_points_total": 57961,
      "used_points_total": 56830
    },
    "train_short_shots_for_window": [
      1051627,
      1052267,
      1052575,
      1052579,
      1052590,
      1053004,
      1053119,
      1053554,
      1053972,
      1054837,
      1054966,
      1055070,
      1055241,
      1055289,
      1055957,
      1056014,
      1056016,
      1056581,
      1056764,
      1057159,
      1057161,
      1057538,
      1057649,
      1057651,
      1057834,
      1057936,
      1057940,
      1058098
    ],
    "val_calib_short_shots_for_window": [],
    "val_thresh_short_shots_for_window": [
      1053639,
      1055787
    ],
    "test_short_shots_for_window": [
      1051684,
      1051701,
      1054153,
      1054161,
      1057472,
      1057650
    ]
  },
  "normalization": {
    "feature_mean": [
      1.7895373106002808,
      1.172227382659912,
      1.3309358358383179,
      0.49961355328559875,
      16.81570053100586,
      2143.237548828125,
      1.0979873877658974e-05,
      0.5963768362998962,
      0.49334681034088135,
      161.3021697998047,
      0.422000914812088,
      5.4921064376831055,
      0.002388644963502884,
      4.2413380469952244e-06,
      -1.3010205030441284,
      0.22631096839904785,
      0.49382930994033813,
      0.05995854362845421,
      1.7131891250610352,
      -0.20864176750183105,
      0.3363473117351532,
      -0.08049467951059341,
      0.0335095040500164,
      -9.321862535216496e-07,
      0.0006361620035022497,
      -0.0005217097932472825,
      0.0005613613175228238,
      -0.005454714410007,
      -0.15591509640216827,
      1.4279600613065213e-08,
      -0.0024040075950324535,
      0.0004191409971099347,
      0.010537294670939445,
      0.0008768640691414475,
      -0.0025821661110967398,
      1.2206943722503638e-07,
      -1.9918261484619393e-10,
      0.0002850277232937515,
      -7.900440323282965e-06,
      -6.089770977268927e-05,
      2.001141729124356e-05,
      0.001134293619543314,
      -0.0003457463753875345,
      -4.137990288199944e-07,
      6.750490138074383e-05,
      0.00013310495705809444,
      -4.315549801958696e-07,
      0.0005039992392994463,
      53426.33203125,
      1.0659480094909668,
      160909.515625,
      89252616.0,
      0.027281103655695915,
      0.08235277235507965,
      0.4184590280056,
      6.09943745075725e-05,
      509.8916931152344,
      0.04970032349228859,
      -9.614602731744526e-07,
      -4.507969424594194e-05,
      -0.01593942753970623,
      -5.736627281294204e-05,
      0.04265887290239334,
      0.0011644179467111826,
      0.04280022531747818,
      0.27696704864501953,
      0.0033259461633861065,
      -0.007770173251628876,
      0.04674262925982475
    ],
    "feature_std": [
      0.23004700243473053,
      0.7105628252029419,
      1.399421215057373,
      0.8400073051452637,
      29.51399040222168,
      3651.439208984375,
      6.577566637133714e-06,
      1.7136704921722412,
      0.5103817582130432,
      26.368175506591797,
      2.217794895172119,
      6.878298759460449,
      0.000927994551602751,
      1.0,
      0.5403382182121277,
      0.14261367917060852,
      0.2898661196231842,
      0.1172579973936081,
      0.5879682898521423,
      0.8506714701652527,
      0.8126489520072937,
      0.37540316581726074,
      0.04360722005367279,
      0.0006478445720858872,
      0.08745118230581284,
      0.6659724116325378,
      0.36409464478492737,
      2.7440106868743896,
      1598.1044921875,
      4.2806459532584995e-06,
      0.2374466210603714,
      0.12354281544685364,
      0.3073888123035431,
      0.40265145897865295,
      0.922336757183075,
      2.4390386897721328e-05,
      1.0,
      0.08636698871850967,
      0.0038956799544394016,
      0.04519794136285782,
      0.013637647032737732,
      0.6089726090431213,
      0.14766983687877655,
      1.1169406175613403,
      0.06827225536108017,
      0.017041491344571114,
      0.0003594513691496104,
      0.2966388165950775,
      370304.59375,
      47.30001449584961,
      1231223.75,
      879580288.0,
      0.45917099714279175,
      112.23513793945312,
      110.24658203125,
      0.001821301644667983,
      50957.91796875,
      0.4833718538284302,
      0.04599178209900856,
      0.0015996263828128576,
      10.67777156829834,
      0.014106705784797668,
      7.788099765777588,
      0.07822181284427643,
      0.9447725415229797,
      117.88604736328125,
      1.7722710371017456,
      18.619718551635742,
      1.9815895557403564
    ]
  },
  "training_history": [
    {
      "epoch": 1,
      "train_loss": 0.04382572938873315,
      "val_roc_auc": 0.984700253630908,
      "val_loss": 0.037877917037596874,
      "sampler": "balanced"
    },
    {
      "epoch": 2,
      "train_loss": 0.01090839626143007,
      "val_roc_auc": 0.9872983945334199,
      "val_loss": 0.02384987185361155,
      "sampler": "balanced"
    },
    {
      "epoch": 3,
      "train_loss": 0.006925852922529689,
      "val_roc_auc": 0.9939170835583641,
      "val_loss": 0.0166459004873663,
      "sampler": "balanced"
    },
    {
      "epoch": 4,
      "train_loss": 0.004811837863748859,
      "val_roc_auc": 0.9952513021499996,
      "val_loss": 0.015548046481283582,
      "sampler": "balanced"
    },
    {
      "epoch": 5,
      "train_loss": 0.002934094718177051,
      "val_roc_auc": 0.9940153538363119,
      "val_loss": 0.016016934406706557,
      "sampler": "balanced"
    },
    {
      "epoch": 6,
      "train_loss": 0.0027266379127217307,
      "val_roc_auc": 0.9886854987753375,
      "val_loss": 0.045537298652103944,
      "sampler": "balanced"
    }
  ],
  "best_epoch": 4,
  "best_val_roc_auc_raw": 0.9952513021499996,
  "plotting": {
    "plot_all_test_shots": false,
    "plot_shot_limit": 0,
    "test_shot_count": 173,
    "generated_timeline_png": 0
  }
}