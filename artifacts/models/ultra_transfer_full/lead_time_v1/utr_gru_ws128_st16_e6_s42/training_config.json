{
  "generated_at_utc": "2026-02-20T13:07:15.339092+00:00",
  "run_name": "utr_gru_ws128_st16_e6_s42",
  "model_name": "gru",
  "device": "cuda",
  "data_root": "G:\\\u6211\u7684\u4e91\u7aef\u786c\u76d8\\Fuison\\data",
  "hdf5_root": "G:\\\u6211\u7684\u4e91\u7aef\u786c\u76d8\\Fuison\\data\\J-TEXT\\unified_hdf5",
  "features": [
    "Bt",
    "CIII",
    "MNM",
    "Mir_VV",
    "Mir_avg_amp",
    "Mir_avg_fre",
    "Z_proxy",
    "dx_a",
    "dy_a",
    "ip",
    "mode_number_n",
    "n=1 amplitude",
    "ne_nG",
    "qa_proxy",
    "sxr_kurt",
    "sxr_mean",
    "sxr_skew",
    "sxr_var",
    "v_loop",
    "xuv_kurt",
    "xuv_ratio",
    "xuv_skew",
    "xuv_var",
    "d1__Bt",
    "d1__CIII",
    "d1__MNM",
    "d1__Mir_VV",
    "d1__Mir_avg_amp",
    "d1__Mir_avg_fre",
    "d1__Z_proxy",
    "d1__dx_a",
    "d1__dy_a",
    "d1__ip",
    "d1__mode_number_n",
    "d1__n=1 amplitude",
    "d1__ne_nG",
    "d1__qa_proxy",
    "d1__sxr_kurt",
    "d1__sxr_mean",
    "d1__sxr_skew",
    "d1__sxr_var",
    "d1__v_loop",
    "d1__xuv_kurt",
    "d1__xuv_ratio",
    "d1__xuv_skew",
    "d1__xuv_var",
    "dr__Bt",
    "dr__CIII",
    "dr__MNM",
    "dr__Mir_VV",
    "dr__Mir_avg_amp",
    "dr__Mir_avg_fre",
    "dr__Z_proxy",
    "dr__dx_a",
    "dr__dy_a",
    "dr__ip",
    "dr__mode_number_n",
    "dr__n=1 amplitude",
    "dr__ne_nG",
    "dr__qa_proxy",
    "dr__sxr_kurt",
    "dr__sxr_mean",
    "dr__sxr_skew",
    "dr__sxr_var",
    "dr__v_loop",
    "dr__xuv_kurt",
    "dr__xuv_ratio",
    "dr__xuv_skew",
    "dr__xuv_var"
  ],
  "feature_count": 69,
  "window": {
    "window_size": 128,
    "stride": 16,
    "eval_stride": 1,
    "strict_method_checks": true
  },
  "feature_engineering": {
    "augment_dynamics": true,
    "dynamics_eps": 1e-06,
    "feature_count_after_augmentation": 69
  },
  "imbalance": {
    "balanced_sampler": true,
    "sampler_applied": true,
    "class_balance": {
      "n_pos": 637,
      "n_neg": 19589
    },
    "pos_weight_value": 1.0,
    "focal_gamma": 1.5
  },
  "optimizer": {
    "epochs": 6,
    "patience": 3,
    "batch_size": 256,
    "learning_rate": 0.001,
    "weight_decay": 0.0001
  },
  "labeling": {
    "gray_ms": 50.0,
    "fallback_fls_ms": 100.0,
    "fallback_dt_ms": 1.0
  },
  "method_audit": {
    "strict_method_checks": true,
    "model_selection_validation_split": "val_calib",
    "calibration_split": "val_calib",
    "threshold_selection_split": "val_thresh",
    "val_partition_expected": [
      "val_calib",
      "val_thresh"
    ]
  },
  "calibration": {
    "method": "isotonic_cv",
    "calibration_shot_fraction": 0.5
  },
  "threshold_policy": {
    "objective": "shot_fpr_constrained_stable",
    "max_shot_fpr": 0.05,
    "theta": 0.5311371237458193,
    "sustain_ms": 3.0,
    "selection_diag": {
      "mode": "robust_stable_region",
      "shot_tpr": 1.0,
      "shot_fpr": 0.029411764705882353,
      "shot_accuracy": 0.9770114942528736,
      "lead_time_ms_median": 6.06430427940785,
      "robust_fpr": 0.029411764705882353,
      "robust_tpr": 1.0,
      "robust_accuracy": 0.9770114942528736,
      "stable_span": 0.058996655518394725,
      "max_shot_fpr": 0.05,
      "tpr_floor": 0.98,
      "robust_delta": 0.03,
      "objective": "shot_fpr_constrained_stable",
      "base_theta": 0.4918060200668896,
      "base_shot_tpr": 1.0,
      "base_shot_fpr": 0.029411764705882353
    }
  },
  "threshold_stability": {
    "num_steps": 300,
    "robust_delta": 0.03,
    "tpr_tolerance": 0.02
  },
  "split_counts": {
    "train_windows": 20226,
    "val_calib_windows": 18495,
    "val_thresh_windows": 18722,
    "test_windows": 35889
  },
  "data_loading_meta": {
    "train": {
      "split_name": "train",
      "requested_shots": 1386,
      "loaded_shots": 1386,
      "missing_shots": [],
      "label_missing_shots": [],
      "feature_errors": [],
      "raw_points_total": 474461,
      "used_points_total": 459641,
      "label_stats": {
        "total": 1386,
        "n_pos": 302,
        "n_neg": 1084
      }
    },
    "val_calib": {
      "split_name": "val_calib",
      "requested_shots": 87,
      "loaded_shots": 87,
      "missing_shots": [],
      "label_missing_shots": [],
      "feature_errors": [],
      "raw_points_total": 29854,
      "used_points_total": 28909,
      "label_stats": {
        "total": 87,
        "n_pos": 19,
        "n_neg": 68
      },
      "rebalance_moves": {
        "to_calib": 0,
        "to_thresh": 0
      }
    },
    "val_thresh": {
      "split_name": "val_thresh",
      "requested_shots": 87,
      "loaded_shots": 87,
      "missing_shots": [],
      "label_missing_shots": [],
      "feature_errors": [],
      "raw_points_total": 29899,
      "used_points_total": 29009,
      "label_stats": {
        "total": 87,
        "n_pos": 19,
        "n_neg": 68
      }
    },
    "test": {
      "split_name": "test",
      "requested_shots": 173,
      "loaded_shots": 173,
      "missing_shots": [],
      "label_missing_shots": [],
      "feature_errors": [],
      "raw_points_total": 57961,
      "used_points_total": 56082
    },
    "train_short_shots_for_window": [
      1051627,
      1052261,
      1052267,
      1052575,
      1052576,
      1052579,
      1052580,
      1052582,
      1052583,
      1052584,
      1052590,
      1052594,
      1052880,
      1052902,
      1052903,
      1053004,
      1053119,
      1053231,
      1053554,
      1053761,
      1053826,
      1053827,
      1053828,
      1053972,
      1054229,
      1054258,
      1054259,
      1054837,
      1054966,
      1055068,
      1055070,
      1055239,
      1055240,
      1055241,
      1055278,
      1055289,
      1055734,
      1055735,
      1055957,
      1056014,
      1056015,
      1056016,
      1056175,
      1056203,
      1056284,
      1056324,
      1056478,
      1056581,
      1056764,
      1056830,
      1056961,
      1057148,
      1057159,
      1057161,
      1057170,
      1057172,
      1057480,
      1057496,
      1057515,
      1057517,
      1057518,
      1057519,
      1057524,
      1057538,
      1057588,
      1057595,
      1057596,
      1057649,
      1057651,
      1057822,
      1057830,
      1057833,
      1057834,
      1057835,
      1057866,
      1057936,
      1057940,
      1058040,
      1058042,
      1058043,
      1058053,
      1058072,
      1058073,
      1058098
    ],
    "val_calib_short_shots_for_window": [
      1052901,
      1055238,
      1055480,
      1057539,
      1057908
    ],
    "val_thresh_short_shots_for_window": [
      1052953,
      1053639,
      1055282,
      1055371,
      1055787,
      1057157
    ],
    "test_short_shots_for_window": [
      1051684,
      1051701,
      1052062,
      1052127,
      1052954,
      1054153,
      1054154,
      1054161,
      1054838,
      1056828,
      1057200,
      1057472,
      1057504,
      1057650
    ]
  },
  "normalization": {
    "feature_mean": [
      1.7903192043304443,
      1.1693872213363647,
      1.312790036201477,
      0.4732442796230316,
      15.947446823120117,
      2094.626708984375,
      1.0963357453874778e-05,
      0.6169978976249695,
      0.49213334918022156,
      160.9006805419922,
      0.3954017460346222,
      5.540883541107178,
      0.0023937958758324385,
      4.250622623658273e-06,
      -1.2975192070007324,
      0.22612671554088593,
      0.4977301359176636,
      0.05951815843582153,
      1.7072691917419434,
      -0.21753187477588654,
      0.3352263569831848,
      -0.08483265340328217,
      0.03318799287080765,
      -7.483232593585853e-07,
      0.0003803732106462121,
      -0.0003237807541154325,
      0.00037225568667054176,
      -0.0033295233733952045,
      0.28518232703208923,
      9.026109637488844e-09,
      -0.0011617267737165093,
      0.00042713942821137607,
      0.011010383255779743,
      0.0006427890621125698,
      -0.002334945136681199,
      2.6537790631664393e-07,
      -2.2644562613916008e-10,
      0.00016485997184645385,
      2.3499083908973262e-05,
      -6.423409649869427e-05,
      2.869699710572604e-05,
      0.0007192405755631626,
      -0.00022924348013475537,
      -1.562533543619793e-05,
      9.480456355959177e-05,
      9.04809421626851e-05,
      -3.498844876048679e-07,
      0.00019209524907637388,
      54277.94140625,
      1.0280710458755493,
      162073.25,
      89735568.0,
      0.024443354457616806,
      0.08524518460035324,
      0.4571036696434021,
      6.524494529003277e-05,
      404.7752380371094,
      0.050757382065057755,
      6.893154932186007e-05,
      -4.928739508613944e-05,
      -0.009692060761153698,
      8.891857578419149e-05,
      0.04407668858766556,
      0.00130548479501158,
      0.04144970327615738,
      0.20142561197280884,
      0.004089011810719967,
      0.0020068117883056402,
      0.04646015539765358
    ],
    "feature_std": [
      0.22985461354255676,
      0.7065621018409729,
      1.4031968116760254,
      0.8059821724891663,
      28.631980895996094,
      3646.1396484375,
      5.634263743559131e-06,
      1.712537407875061,
      0.49141573905944824,
      26.07237434387207,
      2.152754783630371,
      7.739928245544434,
      0.0009237577905878425,
      1.0,
      0.5361316204071045,
      0.141140878200531,
      0.2873757481575012,
      0.1094067171216011,
      0.5352376699447632,
      0.847399115562439,
      0.8519029021263123,
      0.37174347043037415,
      0.041262149810791016,
      0.0006408185581676662,
      0.07902901619672775,
      0.6743905544281006,
      0.3472730219364166,
      2.70821213722229,
      1610.325927734375,
      3.6611304494726937e-06,
      0.2317400723695755,
      0.12281390279531479,
      0.26429352164268494,
      0.38602396845817566,
      0.9174428582191467,
      2.262153611809481e-05,
      1.0,
      0.07617609202861786,
      0.003493913449347019,
      0.04397229105234146,
      0.009705472737550735,
      0.5589417815208435,
      0.1425158828496933,
      1.1731189489364624,
      0.06433679908514023,
      0.013764839619398117,
      0.00035674372338689864,
      0.26941776275634766,
      373848.90625,
      41.3559684753418,
      1229090.5,
      885205120.0,
      0.3835517466068268,
      118.10199737548828,
      112.31991577148438,
      0.0015713986940681934,
      43800.37890625,
      0.49065935611724854,
      0.03693721815943718,
      0.0013670781627297401,
      8.640548706054688,
      0.013330850750207901,
      7.823456764221191,
      0.07157346606254578,
      0.9152433276176453,
      94.06466674804688,
      1.515599012374878,
      17.690649032592773,
      1.937746524810791
    ]
  },
  "training_history": [
    {
      "epoch": 1,
      "train_loss": 0.0522600727990031,
      "val_roc_auc": 0.994883421512876,
      "val_loss": 0.02193213264752083,
      "sampler": "balanced"
    },
    {
      "epoch": 2,
      "train_loss": 0.015268575781350352,
      "val_roc_auc": 0.9878898633023538,
      "val_loss": 0.02051977562544698,
      "sampler": "balanced"
    },
    {
      "epoch": 3,
      "train_loss": 0.008759924432917182,
      "val_roc_auc": 0.9920512005209174,
      "val_loss": 0.022976395946889806,
      "sampler": "balanced"
    },
    {
      "epoch": 4,
      "train_loss": 0.0075053320381052386,
      "val_roc_auc": 0.9983075940601772,
      "val_loss": 0.009526615794895318,
      "sampler": "balanced"
    },
    {
      "epoch": 5,
      "train_loss": 0.0038271320360133117,
      "val_roc_auc": 0.9926911453707641,
      "val_loss": 0.023953138375881356,
      "sampler": "balanced"
    },
    {
      "epoch": 6,
      "train_loss": 0.0021411417755660698,
      "val_roc_auc": 0.9967129217886063,
      "val_loss": 0.019211860601367755,
      "sampler": "balanced"
    }
  ],
  "best_epoch": 4,
  "best_val_roc_auc_raw": 0.9983075940601772,
  "plotting": {
    "plot_all_test_shots": false,
    "plot_shot_limit": 1,
    "test_shot_count": 173,
    "generated_timeline_png": 1
  }
}