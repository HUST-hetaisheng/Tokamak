{
  "generated_at_utc": "2026-02-20T11:19:38.608889+00:00",
  "run_name": "utr_gru_ws64_st16_e2_s42",
  "model_name": "gru",
  "device": "cuda",
  "data_root": "G:\\\u6211\u7684\u4e91\u7aef\u786c\u76d8\\Fuison\\data",
  "hdf5_root": "G:\\\u6211\u7684\u4e91\u7aef\u786c\u76d8\\Fuison\\data\\J-TEXT\\unified_hdf5",
  "features": [
    "Bt",
    "CIII",
    "MNM",
    "Mir_VV",
    "Mir_avg_amp",
    "Mir_avg_fre",
    "Z_proxy",
    "dx_a",
    "dy_a",
    "ip",
    "mode_number_n",
    "n=1 amplitude",
    "ne_nG",
    "qa_proxy",
    "sxr_kurt",
    "sxr_mean",
    "sxr_skew",
    "sxr_var",
    "v_loop",
    "xuv_kurt",
    "xuv_ratio",
    "xuv_skew",
    "xuv_var",
    "d1__Bt",
    "d1__CIII",
    "d1__MNM",
    "d1__Mir_VV",
    "d1__Mir_avg_amp",
    "d1__Mir_avg_fre",
    "d1__Z_proxy",
    "d1__dx_a",
    "d1__dy_a",
    "d1__ip",
    "d1__mode_number_n",
    "d1__n=1 amplitude",
    "d1__ne_nG",
    "d1__qa_proxy",
    "d1__sxr_kurt",
    "d1__sxr_mean",
    "d1__sxr_skew",
    "d1__sxr_var",
    "d1__v_loop",
    "d1__xuv_kurt",
    "d1__xuv_ratio",
    "d1__xuv_skew",
    "d1__xuv_var",
    "dr__Bt",
    "dr__CIII",
    "dr__MNM",
    "dr__Mir_VV",
    "dr__Mir_avg_amp",
    "dr__Mir_avg_fre",
    "dr__Z_proxy",
    "dr__dx_a",
    "dr__dy_a",
    "dr__ip",
    "dr__mode_number_n",
    "dr__n=1 amplitude",
    "dr__ne_nG",
    "dr__qa_proxy",
    "dr__sxr_kurt",
    "dr__sxr_mean",
    "dr__sxr_skew",
    "dr__sxr_var",
    "dr__v_loop",
    "dr__xuv_kurt",
    "dr__xuv_ratio",
    "dr__xuv_skew",
    "dr__xuv_var"
  ],
  "feature_count": 69,
  "window": {
    "window_size": 64,
    "stride": 16,
    "eval_stride": 4
  },
  "feature_engineering": {
    "augment_dynamics": true,
    "dynamics_eps": 1e-06,
    "feature_count_after_augmentation": 69
  },
  "imbalance": {
    "balanced_sampler": true,
    "sampler_applied": true,
    "class_balance": {
      "n_pos": 54,
      "n_neg": 2101
    },
    "pos_weight_value": 1.0,
    "focal_gamma": 1.5
  },
  "optimizer": {
    "epochs": 2,
    "patience": 2,
    "batch_size": 256,
    "learning_rate": 0.001,
    "weight_decay": 0.0001
  },
  "labeling": {
    "gray_ms": 30.0,
    "fallback_fls_ms": 25.0,
    "fallback_dt_ms": 1.0
  },
  "calibration": {
    "method": "isotonic_cv",
    "calibration_shot_fraction": 0.5
  },
  "threshold_policy": {
    "objective": "shot_fpr_constrained_stable",
    "max_shot_fpr": 0.02,
    "theta": 0.6982943143812709,
    "sustain_ms": 3.0,
    "selection_diag": {
      "mode": "robust_stable_region",
      "shot_tpr": 1.0,
      "shot_fpr": 0.0,
      "shot_accuracy": 1.0,
      "lead_time_ms_median": 1.010935365022732,
      "robust_fpr": 0.0,
      "robust_tpr": 1.0,
      "robust_accuracy": 1.0,
      "stable_span": 0.058996655518394725,
      "max_shot_fpr": 0.02,
      "tpr_floor": 0.98,
      "robust_delta": 0.03,
      "objective": "shot_fpr_constrained_stable",
      "base_theta": 0.6687959866220735,
      "base_shot_tpr": 1.0,
      "base_shot_fpr": 0.0
    }
  },
  "threshold_stability": {
    "num_steps": 300,
    "robust_delta": 0.03,
    "tpr_tolerance": 0.02
  },
  "split_counts": {
    "train_windows": 2155,
    "val_calib_windows": 2138,
    "val_thresh_windows": 2017,
    "test_windows": 4113
  },
  "data_loading_meta": {
    "train": {
      "split_name": "train",
      "requested_shots": 120,
      "loaded_shots": 120,
      "missing_shots": [],
      "label_missing_shots": [],
      "feature_errors": [],
      "raw_points_total": 40120,
      "used_points_total": 39374
    },
    "val_calib": {
      "split_name": "val_calib",
      "requested_shots": 30,
      "loaded_shots": 30,
      "missing_shots": [],
      "label_missing_shots": [],
      "feature_errors": [],
      "raw_points_total": 10436,
      "used_points_total": 10257
    },
    "val_thresh": {
      "split_name": "val_thresh",
      "requested_shots": 30,
      "loaded_shots": 30,
      "missing_shots": [],
      "label_missing_shots": [],
      "feature_errors": [],
      "raw_points_total": 10003,
      "used_points_total": 9823
    },
    "test": {
      "split_name": "test",
      "requested_shots": 60,
      "loaded_shots": 60,
      "missing_shots": [],
      "label_missing_shots": [],
      "feature_errors": [],
      "raw_points_total": 20111,
      "used_points_total": 19753
    },
    "train_short_shots_for_window": [
      1055957,
      1057649
    ],
    "val_calib_short_shots_for_window": [
      1055787
    ],
    "val_thresh_short_shots_for_window": [],
    "test_short_shots_for_window": [
      1051684,
      1054161,
      1057650
    ]
  },
  "normalization": {
    "feature_mean": [
      1.7755935192108154,
      1.1972037553787231,
      1.211969017982483,
      0.5206035375595093,
      16.975971221923828,
      1986.879150390625,
      1.0488394764252007e-05,
      0.7211257815361023,
      0.5515732765197754,
      166.0303497314453,
      0.5644899010658264,
      6.169674396514893,
      0.002414518967270851,
      4.052017175126821e-06,
      -1.358169436454773,
      0.23304523527622223,
      0.45555824041366577,
      0.05872909724712372,
      1.7055085897445679,
      -0.1674540638923645,
      0.3685917854309082,
      -0.09436746686697006,
      0.035136133432388306,
      -8.206243933273072e-07,
      0.0004854111757595092,
      -0.000558905303478241,
      0.0010015340521931648,
      0.0029229100327938795,
      0.6527296900749207,
      -6.502052229961919e-09,
      -0.0023393649607896805,
      0.0003527417138684541,
      0.009995239786803722,
      0.0009413721854798496,
      -0.004034663550555706,
      -2.030310071177155e-07,
      -2.01899524876481e-10,
      0.00022322557924780995,
      -4.7849105612840503e-05,
      -6.580740591743961e-05,
      -1.849695217970293e-05,
      -0.0012809612089768052,
      -0.00020742983906529844,
      2.756907997536473e-05,
      7.82213028287515e-05,
      7.992700557224452e-05,
      -3.8097866195130337e-07,
      0.0012354451464489102,
      58391.53515625,
      0.9387849569320679,
      162064.71875,
      103746064.0,
      0.026413656771183014,
      0.6607560515403748,
      0.14398862421512604,
      5.955231245025061e-05,
      249.25485229492188,
      0.0548030361533165,
      -6.474822293967009e-05,
      -4.462521246750839e-05,
      -0.002394688781350851,
      -0.00013527667033486068,
      0.1241314634680748,
      0.001039484515786171,
      0.043529607355594635,
      0.14258413016796112,
      0.002049808157607913,
      -0.03246866911649704,
      0.1788615584373474
    ],
    "feature_std": [
      0.2138841152191162,
      0.6976750493049622,
      1.3929922580718994,
      0.8678887486457825,
      31.398521423339844,
      3267.14794921875,
      5.760080057370942e-06,
      1.6141384840011597,
      0.5319833755493164,
      21.395265579223633,
      2.600713014602661,
      7.779289245605469,
      0.000903259206097573,
      1.0,
      0.4608115255832672,
      0.13677732646465302,
      0.2530827820301056,
      0.07075394690036774,
      0.5583933591842651,
      0.7931090593338013,
      0.21160928905010223,
      0.3565351366996765,
      0.038474779576063156,
      0.0006852999795228243,
      0.08160015940666199,
      0.6768471598625183,
      0.408387690782547,
      2.672354221343994,
      1620.43896484375,
      3.869938154821284e-06,
      0.28404203057289124,
      0.12842248380184174,
      0.29656070470809937,
      0.42254146933555603,
      1.0570485591888428,
      2.5450808607274666e-05,
      1.0,
      0.07224719226360321,
      0.003576745977625251,
      0.0448874831199646,
      0.004346910864114761,
      0.5939007997512817,
      0.16120941936969757,
      0.06924345344305038,
      0.07252351194620132,
      0.010629966855049133,
      0.0003733316552825272,
      0.06295797228813171,
      390450.40625,
      21.387155532836914,
      1241924.5,
      900670272.0,
      0.4855244755744934,
      104.92727661132812,
      6.907845973968506,
      0.0017127644969150424,
      18492.931640625,
      0.5531487464904785,
      0.011996722780168056,
      0.0014661503955721855,
      0.5354671478271484,
      0.015979792922735214,
      15.683037757873535,
      0.07231873273849487,
      0.35974249243736267,
      10.650691032409668,
      0.12589381635189056,
      9.422728538513184,
      3.920140027999878
    ]
  },
  "training_history": [
    {
      "epoch": 1,
      "train_loss": 0.12658598997269319,
      "val_roc_auc": 0.8709607082115912,
      "val_loss": 0.03142712695960899,
      "sampler": "balanced"
    },
    {
      "epoch": 2,
      "train_loss": 0.01884576882561993,
      "val_roc_auc": 0.8947494657886703,
      "val_loss": 0.016805835579829932,
      "sampler": "balanced"
    }
  ],
  "best_epoch": 2,
  "best_val_roc_auc_raw": 0.8947494657886703,
  "plotting": {
    "plot_all_test_shots": false,
    "plot_shot_limit": 0,
    "test_shot_count": 60,
    "generated_timeline_png": 0
  }
}